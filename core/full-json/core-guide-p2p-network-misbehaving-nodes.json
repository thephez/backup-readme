{
 "metadata": {
  "image": [],
  "title": "Misbehaving Nodes",
  "description": "Mechanisms are in place to punish misbehaving peers who take up bandwidth and computing resources by sending false information.",
  "keywords": "",
  "robots": "index"
 },
 "api": {
  "method": "get",
  "url": "",
  "auth": "required",
  "results": {
   "codes": [
    {
     "status": 200,
     "language": "json",
     "code": "{}",
     "name": ""
    },
    {
     "status": 400,
     "language": "json",
     "code": "{}",
     "name": ""
    }
   ]
  },
  "params": []
 },
 "next": {
  "description": "",
  "pages": [
   {
    "type": "doc",
    "icon": "file-text-o",
    "name": "Mining",
    "slug": "core-guide-mining",
    "category": "Core Guides"
   }
  ]
 },
 "algolia": {
  "recordCount": 1,
  "publishPending": false,
  "translationFailure": false,
  "updatedAt": "2023-02-21T19:16:01.617Z"
 },
 "title": "Misbehaving Nodes",
 "icon": "",
 "updates": [],
 "type": "basic",
 "slug": "core-guide-p2p-network-misbehaving-nodes",
 "excerpt": "",
 "body": "> \ud83d\udcd8 Changes regarding misbehaving peers\n>\n> Dash Core 18.1.0 introduced changes to how misbehaving peers are treated.\n\nTake note that for both types of broadcasting, mechanisms are in place to punish misbehaving <<glossary:peers>> who take up bandwidth and computing resources by sending false information. Since Dash Core 18.1.0, peers that misbehave (e.g. send us invalid blocks) are referred to as discouraged nodes in log output. They are not strictly banned: incoming connections are still allowed from them, but they're preferred for eviction.\n\nFurthermore, a few additional changes are introduced to how discouraged addresses are treated:\n\n- Discouraging an address does not time out automatically after 24 hours (or the `-bantime` setting). Depending on traffic from other peers, discouragement may time out at an indeterminate time.\n\n- Discouragement is not persisted over restarts.\n\n- There is no method to list discouraged addresses. They are not returned by the [`listbanned` RPC](core-api-ref-remote-procedure-calls-network#listbanned).\n\n- Discouragement cannot be removed with the [`setban remove` RPC](core-api-ref-remote-procedure-calls-network#setban) command. If you need to remove a discouragement, you can remove all discouragements by stopping and restarting your node.\n\n If a peer gets a banscore above the `-banscore=<n>` threshold (100 by default), they will be disconnected and discouraged.\n\n| Type | Misbehavior | Ban Score | Description |\n| ---- | ----------- | --------- | ----------- |\n| Net | GetBlockTxn Index Error | **100** | Peer relayed a [`getblocktxn` message](core-ref-p2p-network-data-messages#getblocktxn) with out-of-bound indices\n| Net | Bloom Filter Service | **100** | Bloom filter message received from peer that has bloom filter commands disabled by default (protocol version > 70201) (`filterload` message, [`filteradd` message](core-ref-p2p-network-control-messages#filteradd), or [`filterclear` message](core-ref-p2p-network-control-messages#filterclear))\n| Net | Block Rejected | 1 | Peer rejected the block it requested from us\n| Net | Duplicate Version | 1 | Duplicate [`version` message](core-ref-p2p-network-control-messages#version) received\n| Net | Wrong Devnet | **100** | Peer responded with the wrong devnet version (`version` message)\n| Net | Wrong Devnet | 1 | Peer connected using the wrong devnet version (`version` message)\n| Net | No Version | 1 | Received a message prior to receiving a [`version` message](core-ref-p2p-network-control-messages#version)\n| Net | No Verack | 1 | After sending [`version` message](core-ref-p2p-network-control-messages#version), received a message other than a [`verack` message](core-ref-p2p-network-control-messages#verack) back first\n| Net | Address List Size | 20 | More than 1000 addresses received (`addr` message)\n| Net | Inventory List | 20 | More than `MAX_INV_SZ` (50000) inventories received (`inv` message)\n| Net | Get Data Size | 20 | More than `MAX_INV_SZ` (50000) inventories requested (`getdata` message)\n| Net | Orphan Transaction | **Varies** | Peer relayed an invalid orphan transaction. Ban score varies from 0-100 based on the specific reason (values set by `AcceptToMemoryPoolWorker()`)\n| Net | Bad Transaction | **Varies** | Transaction rejected from the mempool\n| Net | Invalid Header | **Varies** | Invalid block header received from peer (`cmpctblock` message)\n| Net | Invalid CompactBlock | **100** | Invalid compact block /non-matching block transactions received from peer (`cmpctblock` message)\n| Net | Header List Size | 20 | More than `MAX_HEADERS_RESULTS` (2000) headers received (`headers` message)\n| Net | Header List Sequence | 20 | Non-continous headers sequence received (`headers` message)\n| Net | Invalid Block | **Varies** | Invalid block header received from peer\n| Net | Bloom Filter Size | **100** | Maximum script element size (520) exceeded (`filterload` message or [`filteradd` message](core-ref-p2p-network-control-messages#filteradd))\n| Net | MN List Diff | 1 | Failed to get masternode list diff (`getmnlistd` message)\n| Net | Unrequested MN List Diff | **100** | Peer provided an unrequested masternode list diff (`mnlistdiff` message)\n| InstantSend | Invalid Lock Message | **100** | Invalid TXID or inputs in lock message (`islock` message)\n| InstantSend | Verify Error | 20 | Peer relayed a message that failed to verify\n| LLMQ ChainLock | Invalid | 10 | Invalid ChainLock message (`clsig` message)\n| LLMQ Commitment | Null QcTx | **100** | Peer relayed a block with a null commitment\n| LLMQ Commitment | Invalid LLMQ Type | **100** | Peer relayed a block containing an invalid LLMQ Type\n| LLMQ Commitment | Invalid Height | **100** | Peer relayed a block that is not the first block in the DKG interval\n| LLMQ Commitment | Invalid Commitment | **100** | Peer relayed a block with an invalid quorum commitment\n| LLMQ DKG | Empty Message | **100** | Peer relayed a message with no payload\n| LLMQ DKG | Invalid LLMQ Type | **100** | Peer relayed a message for an incorrect LLMQ Type\n| LLMQ DKG | Invalid Message | **100** | Peer relayed a message that could not be deserialized\n| LLMQ DKG | Preverify Failed | **100** | Peer relayed a message that could not be pre-verified\n| LLMQ DKG | Signature  | **100** | Peer relayed a message with an invalid signature\n| LLMQ DKG | Full Verify Failed | **100** | Peer relayed a message that failed full verification\n| LLMQ Signing | Too Many Messages | **100** | Maximum message count exceed in [`qsigsesann` message](core-ref-p2p-network-quorum-messages#qsigsesann), [`qsigsinv` message](core-ref-p2p-network-quorum-messages#qsigsinv), [`qgetsigs` message](core-ref-p2p-network-quorum-messages#qgetsigs), or [`qbsigs` message](core-ref-p2p-network-quorum-messages#qbsigs)\n| LLMQ Signing | Signature  | **100** | Peer relayed a message with an invalid recovered signature or signature share\n| Masternode Authentication | Duplicate Message | **100** | Only 1 message allowed (`mnauth` message)\n| Masternode Authentication | Invalid Services | **100** | Peer not advertising `NODE_NETWORK` or `NODE_BLOOM` services (`mnauth` message)\n| Masternode Authentication | Empty Hash | **100** | Peer relayed a message with a null ProRegTx hash (`mnauth` message)\n| Masternode Authentication | Signature | **100** | Peer relayed a message with an invalid signature (`mnauth` message)\n| Masternode Authentication | Invalid MN | 10 | Peer not in the valid masternode list (`mnauth` message)\n| Masternode Authentication | Invalid Signature | 10 | Signature verification failed (`mnauth` message)\n| Governance | Sync | 20 | Requesting a governance sync too frequently (`govsync` message with empty hash)\n| Governance | Invalid Object | 20 | Peer relayed an invalid governance object (`govobj` message)\n| Governance | Invalid Vote | 20 | Peer relayed an invalid/invalid old vote(`govobjvote` message)\n| Governance | Unsupported Vote Signal | 20 | Vote signal outside the accepted range (see [`govobjvote` message](core-ref-p2p-network-governance-messages#govobjvote))\n| CoinJoin | Signature  | 10 | Peer relayed a message with an invalid signature (`dsq` message)\n| Spork | Invalid Time | **100** | Peer relayed a spork with a timestamp too far in the future (`spork` message)\n| Spork | Signature  | **100** | Peer relayed a spork with an invalid signature (`spork` message)",
 "order": 5,
 "isReference": false,
 "deprecated": false,
 "hidden": false,
 "sync_unique": "",
 "link_url": "",
 "link_external": false,
 "reusableContent": [],
 "previousSlug": "",
 "slugUpdatedAt": "2021-03-24T15:50:50.997Z",
 "revision": 8,
 "_id": "63f5176df91c7700118e77ec",
 "version": "63f5176df91c7700118e7825",
 "updatedAt": "2022-10-19T14:42:08.013Z",
 "createdAt": "2019-10-25T19:15:03.242Z",
 "project": "5daf2e65f4109c0040fd51e1",
 "user": "5b8400d7185d5e00036dcc3b",
 "parentDoc": "63f5176df91c7700118e77cc",
 "category": "63f5176df91c7700118e779e",
 "__v": 1,
 "pendingAlgoliaPublish": false,
 "isApi": false,
 "id": "63f5176df91c7700118e77ec",
 "body_html": "> \ud83d\udcd8 Changes regarding misbehaving peers\n>\n> Dash Core 18.1.0 introduced changes to how misbehaving peers are treated.\n\nTake note that for both types of broadcasting, mechanisms are in place to punish misbehaving <<glossary:peers>> who take up bandwidth and computing resources by sending false information. Since Dash Core 18.1.0, peers that misbehave (e.g. send us invalid blocks) are referred to as discouraged nodes in log output. They are not strictly banned: incoming connections are still allowed from them, but they're preferred for eviction.\n\nFurthermore, a few additional changes are introduced to how discouraged addresses are treated:\n\n- Discouraging an address does not time out automatically after 24 hours (or the `-bantime` setting). Depending on traffic from other peers, discouragement may time out at an indeterminate time.\n\n- Discouragement is not persisted over restarts.\n\n- There is no method to list discouraged addresses. They are not returned by the [`listbanned` RPC](core-api-ref-remote-procedure-calls-network#listbanned).\n\n- Discouragement cannot be removed with the [`setban remove` RPC](core-api-ref-remote-procedure-calls-network#setban) command. If you need to remove a discouragement, you can remove all discouragements by stopping and restarting your node.\n\n If a peer gets a banscore above the `-banscore=<n>` threshold (100 by default), they will be disconnected and discouraged.\n\n| Type | Misbehavior | Ban Score | Description |\n| ---- | ----------- | --------- | ----------- |\n| Net | GetBlockTxn Index Error | **100** | Peer relayed a [`getblocktxn` message](core-ref-p2p-network-data-messages#getblocktxn) with out-of-bound indices\n| Net | Bloom Filter Service | **100** | Bloom filter message received from peer that has bloom filter commands disabled by default (protocol version > 70201) (`filterload` message, [`filteradd` message](core-ref-p2p-network-control-messages#filteradd), or [`filterclear` message](core-ref-p2p-network-control-messages#filterclear))\n| Net | Block Rejected | 1 | Peer rejected the block it requested from us\n| Net | Duplicate Version | 1 | Duplicate [`version` message](core-ref-p2p-network-control-messages#version) received\n| Net | Wrong Devnet | **100** | Peer responded with the wrong devnet version (`version` message)\n| Net | Wrong Devnet | 1 | Peer connected using the wrong devnet version (`version` message)\n| Net | No Version | 1 | Received a message prior to receiving a [`version` message](core-ref-p2p-network-control-messages#version)\n| Net | No Verack | 1 | After sending [`version` message](core-ref-p2p-network-control-messages#version), received a message other than a [`verack` message](core-ref-p2p-network-control-messages#verack) back first\n| Net | Address List Size | 20 | More than 1000 addresses received (`addr` message)\n| Net | Inventory List | 20 | More than `MAX_INV_SZ` (50000) inventories received (`inv` message)\n| Net | Get Data Size | 20 | More than `MAX_INV_SZ` (50000) inventories requested (`getdata` message)\n| Net | Orphan Transaction | **Varies** | Peer relayed an invalid orphan transaction. Ban score varies from 0-100 based on the specific reason (values set by `AcceptToMemoryPoolWorker()`)\n| Net | Bad Transaction | **Varies** | Transaction rejected from the mempool\n| Net | Invalid Header | **Varies** | Invalid block header received from peer (`cmpctblock` message)\n| Net | Invalid CompactBlock | **100** | Invalid compact block /non-matching block transactions received from peer (`cmpctblock` message)\n| Net | Header List Size | 20 | More than `MAX_HEADERS_RESULTS` (2000) headers received (`headers` message)\n| Net | Header List Sequence | 20 | Non-continous headers sequence received (`headers` message)\n| Net | Invalid Block | **Varies** | Invalid block header received from peer\n| Net | Bloom Filter Size | **100** | Maximum script element size (520) exceeded (`filterload` message or [`filteradd` message](core-ref-p2p-network-control-messages#filteradd))\n| Net | MN List Diff | 1 | Failed to get masternode list diff (`getmnlistd` message)\n| Net | Unrequested MN List Diff | **100** | Peer provided an unrequested masternode list diff (`mnlistdiff` message)\n| InstantSend | Invalid Lock Message | **100** | Invalid TXID or inputs in lock message (`islock` message)\n| InstantSend | Verify Error | 20 | Peer relayed a message that failed to verify\n| LLMQ ChainLock | Invalid | 10 | Invalid ChainLock message (`clsig` message)\n| LLMQ Commitment | Null QcTx | **100** | Peer relayed a block with a null commitment\n| LLMQ Commitment | Invalid LLMQ Type | **100** | Peer relayed a block containing an invalid LLMQ Type\n| LLMQ Commitment | Invalid Height | **100** | Peer relayed a block that is not the first block in the DKG interval\n| LLMQ Commitment | Invalid Commitment | **100** | Peer relayed a block with an invalid quorum commitment\n| LLMQ DKG | Empty Message | **100** | Peer relayed a message with no payload\n| LLMQ DKG | Invalid LLMQ Type | **100** | Peer relayed a message for an incorrect LLMQ Type\n| LLMQ DKG | Invalid Message | **100** | Peer relayed a message that could not be deserialized\n| LLMQ DKG | Preverify Failed | **100** | Peer relayed a message that could not be pre-verified\n| LLMQ DKG | Signature  | **100** | Peer relayed a message with an invalid signature\n| LLMQ DKG | Full Verify Failed | **100** | Peer relayed a message that failed full verification\n| LLMQ Signing | Too Many Messages | **100** | Maximum message count exceed in [`qsigsesann` message](core-ref-p2p-network-quorum-messages#qsigsesann), [`qsigsinv` message](core-ref-p2p-network-quorum-messages#qsigsinv), [`qgetsigs` message](core-ref-p2p-network-quorum-messages#qgetsigs), or [`qbsigs` message](core-ref-p2p-network-quorum-messages#qbsigs)\n| LLMQ Signing | Signature  | **100** | Peer relayed a message with an invalid recovered signature or signature share\n| Masternode Authentication | Duplicate Message | **100** | Only 1 message allowed (`mnauth` message)\n| Masternode Authentication | Invalid Services | **100** | Peer not advertising `NODE_NETWORK` or `NODE_BLOOM` services (`mnauth` message)\n| Masternode Authentication | Empty Hash | **100** | Peer relayed a message with a null ProRegTx hash (`mnauth` message)\n| Masternode Authentication | Signature | **100** | Peer relayed a message with an invalid signature (`mnauth` message)\n| Masternode Authentication | Invalid MN | 10 | Peer not in the valid masternode list (`mnauth` message)\n| Masternode Authentication | Invalid Signature | 10 | Signature verification failed (`mnauth` message)\n| Governance | Sync | 20 | Requesting a governance sync too frequently (`govsync` message with empty hash)\n| Governance | Invalid Object | 20 | Peer relayed an invalid governance object (`govobj` message)\n| Governance | Invalid Vote | 20 | Peer relayed an invalid/invalid old vote(`govobjvote` message)\n| Governance | Unsupported Vote Signal | 20 | Vote signal outside the accepted range (see [`govobjvote` message](core-ref-p2p-network-governance-messages#govobjvote))\n| CoinJoin | Signature  | 10 | Peer relayed a message with an invalid signature (`dsq` message)\n| Spork | Invalid Time | **100** | Peer relayed a spork with a timestamp too far in the future (`spork` message)\n| Spork | Signature  | **100** | Peer relayed a spork with an invalid signature (`spork` message)"
}