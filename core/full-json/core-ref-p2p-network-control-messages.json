{
 "metadata": {
  "image": [],
  "title": "Dash Control Messages",
  "description": "Dash control messages helps control the connection between two peers or allows them to advise each other about the rest of the network.",
  "keywords": "",
  "robots": "index"
 },
 "mdx": {
  "altBody": "",
  "status": "rdmd"
 },
 "api": {
  "method": "get",
  "url": "",
  "auth": "required",
  "results": {
   "codes": [
    {
     "status": 200,
     "language": "json",
     "code": "{}",
     "name": ""
    },
    {
     "status": 400,
     "language": "json",
     "code": "{}",
     "name": ""
    }
   ]
  },
  "params": []
 },
 "next": {
  "description": "",
  "pages": [
   {
    "type": "doc",
    "icon": "file-text-o",
    "name": "Data Messages",
    "slug": "core-ref-p2p-network-data-messages",
    "category": "Core Reference"
   }
  ]
 },
 "algolia": {
  "recordCount": 22,
  "publishPending": false,
  "translationFailure": false,
  "updatedAt": "2023-02-21T21:23:11.503Z"
 },
 "title": "Control Messages",
 "icon": "",
 "updates": [],
 "type": "basic",
 "slug": "core-ref-p2p-network-control-messages",
 "excerpt": "",
 "body": "The following <<glossary:network>> messages all help control the connection between two <<glossary:peers>> or allow them to advise each other about the rest of the network.\n\n![Overview Of P2P Protocol Control And Advisory Messages](https://dash-docs.github.io/img/dev/en-p2p-control-messages.svg)\n\nNote that almost none of the control messages are authenticated in any way, meaning they can contain incorrect or intentionally harmful information.\n\n# addr\n\nThe `addr` (IP address) message relays connection information for peers on the network. Each peer which wants to accept incoming connections creates an [`addr` message](core-ref-p2p-network-control-messages#addr) providing its connection information and then sends that message to its peers unsolicited. Some of its peers send that information to their peers (also unsolicited), some of which further distribute it, allowing decentralized peer discovery for any program already on the network.\n\nAn [`addr` message](core-ref-p2p-network-control-messages#addr) may also be sent in response to a [`getaddr` message](core-ref-p2p-network-control-messages#getaddr).\n\n| Bytes      | Name             | Data Type          | Description\n|------------|------------------|--------------------|----------------\n| *Varies*   | IP address count | compactSize uint   | The number of IP address entries up to a maximum of 1,000.\n| *Varies*   | IP addresses     | network IP address | IP address entries.  See the table below for the format of a Dash network IP address.\n\nEach encapsulated network IP address currently uses the following structure:\n\n| Bytes | Name       | Data Type | Description\n|-------|------------|-----------|---------------\n| 4     | time       | uint32    | *Added in protocol version 31402.* <br><br>A time in Unix epoch time format.  Nodes advertising their own IP address set this to the current time.  Nodes advertising IP addresses they've connected to set this to the last time they connected to that node.  Other nodes just relaying the IP address should not change the time.  Nodes can use the time field to avoid relaying old [`addr` messages](core-ref-p2p-network-control-messages#addr).  <br><br>Malicious nodes may change times or even set them in the future.\n| 8     | services   | uint64_t  | The services the node advertised in its [`version` message](core-ref-p2p-network-control-messages#version).\n| 16    | IP address | char      | IPv6 address in **big endian byte order**. IPv4 addresses can be provided as [IPv4-mapped IPv6 addresses](http://en.wikipedia.org/wiki/IPv6#IPv4-mapped_IPv6_addresses)\n| 2     | port       | uint16_t  | Port number in **big endian byte order**.  Note that Dash Core will only connect to nodes with non-standard port numbers as a last resort for finding peers.  This is to prevent anyone from trying to use the network to disrupt non-Dash services that run on other ports.\n\nThe following annotated hexdump shows part of an [`addr` message](core-ref-p2p-network-control-messages#addr). (The <<glossary:message header>> has been omitted and the actual IP address has been replaced with a [RFC5737](http://tools.ietf.org/html/rfc5737) reserved IP address.)\n\n``` text\nfde803 ............................. Address count: 1000\n\nd91f4854 ........................... Epoch time: 1414012889\n0100000000000000 ................... Service bits: 01 (network node)\n00000000000000000000ffffc0000233 ... IP Address: ::ffff:192.0.2.51\n208d ............................... Port: 8333\n\n[...] .............................. (999 more addresses omitted)\n```\n\n# addrv2\n\n*Added in protocol version 70220 of Dash Core*\n\nThe `addrv2` message relays connection information for peers on the network just like the [`addr` message](#addr), but is extended to allow gossiping of longer node addresses as described in [BIP155](https://github.com/bitcoin/bips/blob/master/bip-0155.mediawiki).\n\nEach encapsulated network IP address currently uses the following structure:\n\n| Bytes | Name       | Data Type | Description\n|-------|------------|-----------|---------------\n| 4     | time       | uint32_t    | A time in Unix epoch time format.  Nodes advertising their own IP address set this to the current time.  Nodes advertising IP addresses they've connected to set this to the last time they connected to that node.  Other nodes just relaying the IP address should not change the time.\n| Varies     | services   | compactSize uint  | The services the node advertised in its [`version` message](core-ref-p2p-network-control-messages#version).\n| 1    | networkID | uint8_t      | Network identifier. An 8-bit value that specifies which network is addressed. Network ID types may be found in [BIP155](https://github.com/bitcoin/bips/blob/master/bip-0155.mediawiki#specification).\n| Varies | addr | Vector<uint8_t> | Network address. The interpretation depends on networkID.\n| 2     | port       | uint16_t  | Port number in **big endian byte order**.  Note that Dash Core will only connect to nodes with non-standard port numbers as a last resort for finding peers.  This is to prevent anyone from trying to use the network to disrupt non-Dash services that run on other ports.\n\n\nThe following annotated hexdump shows part of an `addrv2` message. (The <<glossary:message header>> has been omitted.)\n\n``` text\n01 ................................. Address count: 1\n\n1a2a8961 ........................... Epoch time: 1636379162\n\nServices information\n| fd ............................... Number of service bytes (2)\n| 0504 ............................. Service bits: 10000000101 (network, bloom, network_limited)\n\nPeer address details\n| 01 ............................... Network ID (1 - IPv4)\n| 04 ............................... Address length\n| 2d20ed4c ......................... IP Address: 45.32.237.76\n| 4a37 ............................. Port: 18999\n```\n\n# filteradd\n\n*Added in protocol version 70001 as described by BIP37.*\n\nThe [`filteradd` message](core-ref-p2p-network-control-messages#filteradd) tells the receiving <<glossary:peer>> to add a single element to a previously-set <<glossary:bloom filter>>, such as a new <<glossary:public key>>. The element is sent directly to the receiving peer; the peer then uses the parameters set in the [`filterload` message](core-ref-p2p-network-control-messages#filterload) to add the element to the bloom filter.\n\nBecause the element is sent directly to the receiving peer, there is no obfuscation of the element and none of the plausible-deniability privacy provided by the bloom filter. Clients that want to maintain greater privacy should recalculate the bloom filter themselves and send a new [`filterload` message](core-ref-p2p-network-control-messages#filterload) with the recalculated bloom filter.\n\n| Bytes    | Name          | Data Type        | Description\n|----------|---------------|------------------|-----------------\n| *Varies* | element bytes | compactSize uint | The number of bytes in the following element field.\n| *Varies* | element       | uint8_t[]        | The element to add to the current filter.  Maximum of 520 bytes, which is the maximum size of an element which can be pushed onto the stack in a pubkey or signature script.  Elements must be sent in the byte order they would use when appearing in a raw transaction; for example, hashes should be sent in internal byte order.\n\nNote: a [`filteradd` message](core-ref-p2p-network-control-messages#filteradd) will not be accepted unless a filter was previously set with the [`filterload` message](core-ref-p2p-network-control-messages#filterload).\n\nThe annotated hexdump below shows a [`filteradd` message](core-ref-p2p-network-control-messages#filteradd) adding a <<glossary:TXID>>. (The message header has been omitted.) This TXID appears in the same block used for the example hexdump in the [`merkleblock` message](core-ref-p2p-network-data-messages#merkleblock); if that [`merkleblock` message](core-ref-p2p-network-data-messages#merkleblock) is re-sent after sending this [`filteradd` message](core-ref-p2p-network-control-messages#filteradd), six hashes are returned instead of four.\n\n``` text\n20 ................................. Element bytes: 32\nfdacf9b3eb077412e7a968d2e4f11b9a\n9dee312d666187ed77ee7d26af16cb0b ... Element (A TXID)\n```\n\n# filterclear\n\n*Added in protocol version 70001 as described by BIP37.*\n\nThe [`filterclear` message](core-ref-p2p-network-control-messages#filterclear) tells the receiving <<glossary:peer>> to remove a previously-set <<glossary:bloom filter>>.  This also undoes the effect of setting the relay field in the [`version` message](core-ref-p2p-network-control-messages#version) to 0, allowing unfiltered access to [`inv` messages](core-ref-p2p-network-data-messages#inv) announcing new transactions.\n\nDash Core does not require a [`filterclear` message](core-ref-p2p-network-control-messages#filterclear) before a replacement filter is loaded with `filterload`.  It also doesn't require a [`filterload` message](core-ref-p2p-network-control-messages#filterload) before a [`filterclear` message](core-ref-p2p-network-control-messages#filterclear).\n\nThere is no payload in a [`filterclear` message](core-ref-p2p-network-control-messages#filterclear).  See the [message header section](core-ref-p2p-network-message-headers) for an example of a message without a payload.\n\n# filterload\n\n*Added in protocol version 70001 as described by BIP37.*\n\nThe [`filterload` message](core-ref-p2p-network-control-messages#filterload) tells the receiving <<glossary:peer>> to filter all relayed transactions and requested <<glossary:merkle blocks>> through the provided filter. This allows clients to receive transactions relevant to their <<glossary:wallet>> plus a configurable rate of false positive transactions which can provide plausible-deniability privacy.\n\n| Bytes    | Name         | Data Type | Description\n|----------|--------------|-----------|---------------\n| *Varies* | nFilterBytes | compactSize uint | Number of bytes in the following filter bit field.\n| *Varies* | filter       | uint8_t[] | A bit field of arbitrary byte-aligned size. The maximum size is 36,000 bytes.\n| 4        | nHashFuncs   | uint32_t  | The number of hash functions to use in this filter. The maximum value allowed in this field is 50.\n| 4        | nTweak       | uint32_t  | An arbitrary value to add to the seed value in the hash function used by the bloom filter.\n| 1        | nFlags       | uint8_t   | A set of flags that control how outpoints corresponding to a matched pubkey script are added to the filter. See the table in the Updating A Bloom Filter subsection below.\n\nThe annotated hexdump below shows a [`filterload` message](core-ref-p2p-network-control-messages#filterload). (The message header has been omitted.)  For an example of how this payload was created, see the [filterload example](core-examples-p2p-network-creating-a-bloom-filter).\n\n``` text\n02 ......... Filter bytes: 2\nb50f ....... Filter: 1010 1101 1111 0000\n0b000000 ... nHashFuncs: 11\n00000000 ... nTweak: 0/none\n00 ......... nFlags: BLOOM_UPDATE_NONE\n```\n\n## Initializing A Bloom Filter\n\nFilters have two core parameters: the size of the bit field and the number of hash functions to run against each data element. The following formulas from BIP37 will allow you to automatically select appropriate values based on the number of elements you plan to insert into the filter (*n*) and the false positive rate (*p*) you desire to maintain plausible deniability.\n\n* Size of the bit field in bytes (*nFilterBytes*), up to a maximum of 36,000: `(-1 / log(2)**2 * n * log(p)) / 8`\n\n* Hash functions to use (*nHashFuncs*), up to a maximum of 50:\n  `nFilterBytes * 8 / n * log(2)`\n\nNote that the filter matches parts of transactions (transaction elements), so the false positive rate is relative to the number of elements checked---not the number of transactions checked. Each normal transaction has a minimum of four matchable elements (described in the comparison subsection below), so a filter with a false-positive rate of 1 percent will match about 4 percent of all transactions at a minimum.\n\nAccording to BIP37, the formulas and limits described above provide support for bloom filters containing 20,000 items with a false positive rate of less than 0.1 percent or 10,000 items with a false positive rate of less than 0.0001 percent.\n\nOnce the size of the bit field is known, the bit field should be initialized as all zeroes.\n\n## Populating A Bloom Filter\n\nThe bloom filter is populated using between 1 and 50 unique hash functions (the number specified per filter by the *nHashFuncs* field). Instead of using up to 50 different hash function implementations, a single implementation is used with a unique seed value for each function.\n\nThe seed is `nHashNum * 0xfba4c795 + nTweak` as a *uint32\\_t*, where the values are:\n\n* **nHashNum** is the sequence number for this hash function, starting at 0 for the first hash iteration and increasing up to the value of the *nHashFuncs* field (minus one) for the last hash iteration.\n\n* **0xfba4c795** is a constant optimized to create large differences in the seed for different values of *nHashNum*.\n\n* **nTweak** is a per-filter constant set by the client to require the use of an arbitrary set of hash functions.\n\nIf the seed resulting from the formula above is larger than four bytes, it must be truncated to its four most significant bytes (for example, `0x8967452301 & 0xffffffff \u2192 0x67452301`).\n\nThe actual hash function implementation used is the [32-bit Murmur3 hash function](https://en.wikipedia.org/wiki/MurmurHash).\n\n> \ud83d\udea7 Murmer3 Version\n>\n> **Warning:** the Murmur3 hash function has separate 32-bit and 64-bit versions that produce different results for the same <<glossary:input>>.  Only the 32-bit Murmur3 version is used with Dash bloom filters.\n\nThe data to be hashed can be any transaction element which the bloom filter can match. See the next subsection for the list of transaction elements checked against the filter. The largest element which can be matched is a script data push of 520 bytes, so the data should never exceed 520 bytes.\n\nThe example below from Dash Core [bloom.cpp](https://github.com/dashpay/dash/blob/v0.15.x/src/bloom.cpp#L59) combines all the steps above to create the hash function template. The seed is the first parameter; the data to be hashed is the second parameter. The result is a uint32\\_t modulo the size of the bit field in bits.\n\n``` c++\nMurmurHash3(nHashNum * 0xFBA4C795 + nTweak, vDataToHash) % (vData.size() * 8)\n```\n\nEach data element to be added to the filter is hashed by *nHashFuncs* number of hash functions. Each time a hash function is run, the result will be the index number (*nIndex*) of a bit in the bit field. That bit must be set to 1. For example if the filter bit field was `00000000` and the result is 5, the revised filter bit field is `00000100` (the first bit is bit 0).\n\nIt is expected that sometimes the same index number will be returned more than once when populating the bit field; this does not affect the algorithm---after a bit is set to 1, it is never changed back to 0.\n\nAfter all data elements have been added to the filter, each set of eight bits is converted into a little-endian byte. These bytes are the value of the *filter* field.\n\n## Comparing Transaction Elements To A Bloom Filter\n\nTo compare an arbitrary data element against the bloom filter, it is hashed using the same parameters used to create the bloom filter. Specifically, it is hashed *nHashFuncs* times, each time using the same\n*nTweak* provided in the filter, and the resulting <<glossary:output>> is modulo the size of the bit field provided in the *filter* field.  After each hash is performed, the filter is checked to see if the bit at that indexed location is set.  For example if the result of a hash is `5` and the filter is `01001110`, the bit is considered set.\n\nIf the result of every hash points to a set bit, the filter matches. If any of the results points to an unset bit, the filter does not match.\n\nThe following transaction elements are compared against bloom filters. All elements will be hashed in the byte order used in <<glossary:blocks>> (for example, <<glossary:TXIDs>> will be in <<glossary:internal byte order>>).\n\n* **TXIDs:** the transaction's SHA256(SHA256()) hash.\n\n* **Outpoints:** each 36-byte <<glossary:outpoint>> used this transaction's input section is individually compared to the filter.\n\n* **Signature Script Data:** each element pushed onto the stack by a <<glossary:data-pushing opcode>> in a <<glossary:signature script>> from this transaction is individually compared to the filter.  This includes data elements present in P2SH <<glossary:redeem script>> when they are being spent.\n\n* **PubKey Script Data:** each element pushed onto the the stack by a data-pushing opcode in any <<glossary:pubkey script>> from this transaction is individually compared to the filter. (If a pubkey script element matches the filter, the filter will be immediately updated if the `BLOOM_UPDATE_ALL` flag was set; if the pubkey script is in the P2PKH format and matches the filter, the filter will be immediately updated if the `BLOOM_UPDATE_P2PUBKEY_ONLY` flag was set. See the subsection below for details.)\n\nAs of  Dash Core 0.14.0, elements in the extra payload section of [DIP2](https://github.com/dashpay/dips/blob/master/dip-0002.md)-based <<glossary:special transactions>> are also compared against bloom filters.\n\nThe following annotated hexdump of a transaction is from the [raw transaction format section](core-ref-transactions-raw-transaction-format); the elements which would be checked by the filter are emphasized in bold. Note that this transaction's TXID (**`01000000017b1eab[...]`**) would also be checked, and that the outpoint TXID and index number below would be checked as a single 36-byte element.\n\n<pre><code>01000000 ................................... Version\n\n01 ......................................... Number of inputs\n|\n| <b>7b1eabe0209b1fe794124575ef807057</b>\n| <b>c77ada2138ae4fa8d6c4de0398a14f3f</b> ......... Outpoint TXID\n| <b>00000000</b> ................................. Outpoint index number\n|\n| 49 ....................................... Bytes in sig. script: 73\n| | 48 ..................................... Push 72 bytes as data\n| | | <b>30450221008949f0cb400094ad2b5eb3</b>\n| | | <b>99d59d01c14d73d8fe6e96df1a7150de</b>\n| | | <b>b388ab8935022079656090d7f6bac4c9</b>\n| | | <b>a94e0aad311a4268e082a725f8aeae05</b>\n| | | <b>73fb12ff866a5f01</b> ..................... Secp256k1 signature\n|\n| ffffffff ................................. Sequence number: UINT32_MAX\n\n01 ......................................... Number of outputs\n| f0ca052a01000000 ......................... Satoshis (49.99990000 BTC)\n|\n| 19 ....................................... Bytes in pubkey script: 25\n| | 76 ..................................... OP_DUP\n| | a9 ..................................... OP_HASH160\n| | 14 ..................................... Push 20 bytes as data\n| | | <b>cbc20a7664f2f69e5355aa427045bc15</b>\n| | | <b>e7c6c772</b> ............................. PubKey hash\n| | 88 ..................................... OP_EQUALVERIFY\n| | ac ..................................... OP_CHECKSIG\n\n00000000 ................................... locktime: 0 (a block height)\n</code></pre>\n\n## Updating A Bloom Filter\n\nClients will often want to track <<glossary:inputs>> that spend <<glossary:outputs>> (outpoints) relevant to their wallet, so the filterload field *nFlags* can be set to allow the filtering <<glossary:node>> to update the filter when a match is found. When the filtering node sees a <<glossary:pubkey script>> that pays a pubkey, <<glossary:address>>, or other data element matching the filter, the filtering node immediately updates the filter with the <<glossary:outpoint>> corresponding to that pubkey script.\n\n![Automatically Updating Bloom Filters](https://dash-docs.github.io/img/dev/en-bloom-update.svg)\n\nIf an input later spends that outpoint, the filter will match it, allowing the filtering node to tell the client that one of its transaction outputs has been spent.\n\nThe *nFlags* field has three allowed values:\n\n| Value | Name                       | Description\n|-------|----------------------------|---------------\n| 0     | `BLOOM_UPDATE_NONE`          | The filtering node should not update the filter.\n| 1     | `BLOOM_UPDATE_ALL`           | If the filter matches any data element in a pubkey script, the corresponding outpoint is added to the filter.\n| 2     | `BLOOM_UPDATE_P2PUBKEY_ONLY` | If the filter matches any data element in a pubkey script and that script is either a P2PKH or non-P2SH pay-to-multisig script, the corresponding outpoint is added to the filter.\n\nIn addition, because the filter size stays the same even though additional elements are being added to it, the false positive rate increases. Each false positive can result in another element being added to the filter, creating a feedback loop that can (after a certain point) make the filter useless. For this reason, clients using automatic filter updates need to monitor the actual false positive rate and send a new filter when the rate gets too high.\n\n# getaddr\n\nThe [`getaddr` message](core-ref-p2p-network-control-messages#getaddr) requests an [`addr` message](core-ref-p2p-network-control-messages#addr) from the receiving <<glossary:node>>, preferably one with lots of IP addresses of other receiving nodes. The transmitting node can use those IP addresses to quickly update its database of available nodes rather than waiting for unsolicited [`addr` messages](core-ref-p2p-network-control-messages#addr) to arrive over time.\n\nThere is no payload in a [`getaddr` message](core-ref-p2p-network-control-messages#getaddr).  See the [message header section](core-ref-p2p-network-message-headers) for an example of a message without a payload.\n\n# getsporks\n\nThe [`getsporks` message](core-ref-p2p-network-control-messages#getsporks) requests [`spork` messages](core-ref-p2p-network-control-messages#spork) from the receiving node.\n\nThere is no payload in a [`getsporks` message](core-ref-p2p-network-control-messages#getsporks).  See the [message header section](core-ref-p2p-network-message-headers) for an example of a message without a payload.\n\n# ping\n\nThe [`ping` message](core-ref-p2p-network-control-messages#ping) helps confirm that the receiving <<glossary:peer>> is still connected. If a TCP/IP error is encountered when sending the [`ping` message](core-ref-p2p-network-control-messages#ping) (such as a connection timeout), the transmitting node can assume that the receiving node is disconnected. The response to a [`ping` message](core-ref-p2p-network-control-messages#ping) is the [`pong` message](core-ref-p2p-network-control-messages#pong).\n\nBefore protocol version 60000, the [`ping` message](core-ref-p2p-network-control-messages#ping) had no payload. As of protocol version 60001 and all later versions, the message includes a single field, the nonce.\n\n| Bytes | Name  | Data Type | Description\n|-------|-------|-----------|---------------\n| 8     | nonce | uint64_t  | *Added in protocol version 60001 as described by BIP31.* <br><br>Random nonce assigned to this [`ping` message](core-ref-p2p-network-control-messages#ping).  The responding [`pong` message](core-ref-p2p-network-control-messages#pong) will include this nonce to identify the [`ping` message](core-ref-p2p-network-control-messages#ping) to which it is replying.\n\nThe annotated hexdump below shows a [`ping` message](core-ref-p2p-network-control-messages#ping). (The message header has been omitted.)\n\n``` text\n0094102111e2af4d ... Nonce\n```\n\n# pong\n\n*Added in protocol version 60001 as described by BIP31.*\n\nThe [`pong` message](core-ref-p2p-network-control-messages#pong) replies to a [`ping` message](core-ref-p2p-network-control-messages#ping), proving to the pinging <<glossary:node>> that the ponging node is still alive. Dash Core will, by default, disconnect from any clients which have not responded to a [`ping` message](core-ref-p2p-network-control-messages#ping) within 20 minutes.\n\nTo allow nodes to keep track of latency, the [`pong` message](core-ref-p2p-network-control-messages#pong) sends back the same nonce received in the [`ping` message](core-ref-p2p-network-control-messages#ping) it is replying to.\n\nThe format of the [`pong` message](core-ref-p2p-network-control-messages#pong) is identical to the [`ping` message](core-ref-p2p-network-control-messages#ping); only the message header differs.\n\n# sendaddrv2\n\n*Added in protocol version 70220 of Dash Core*\n\nThe `sendaddrv2` message signals support for receiving [`addrv2` messages](#addrv2) (defined in [BIP155](https://github.com/bitcoin/bips/blob/master/bip-0155.mediawiki)). It also implies that its sender can encode as `addrv2` and would send `addrv2` messages instead of [`addr` messages](#addr) to a peer that has signaled `addrv2` support by sending a `sendaddrv2` message.\n\nThere is no payload in a `sendaddrv2` message. See the [message header section](core-ref-p2p-network-message-headers) for an example of a message without a payload.\n\n# sendcmpct\n\n*Added in protocol version 70209 of Dash Core as described by BIP152*\n\nThe [`sendcmpct` message](core-ref-p2p-network-control-messages#sendcmpct) tells the receiving <<glossary:peer>> whether or not to announce new <<glossary:blocks>> using a [`cmpctblock` message](core-ref-p2p-network-data-messages#cmpctblock). It also sends the compact block protocol version it supports. The [`sendcmpct` message](core-ref-p2p-network-control-messages#sendcmpct) is defined as a message containing a 1-byte integer followed by a 8-byte integer. The first integer is interpreted as a boolean and should have a value of either 1 or 0. The second integer is be interpreted as a little-endian version number.\n\nUpon receipt of a [`sendcmpct` message](core-ref-p2p-network-control-messages#sendcmpct) with the first and second integers set to 1, the <<glossary:node>> should announce new blocks by sending a [`cmpctblock` message](core-ref-p2p-network-data-messages#cmpctblock).\n\nUpon receipt of a [`sendcmpct` message](core-ref-p2p-network-control-messages#sendcmpct) with the first integer set to 0, the node shouldn't announce new blocks by sending a [`cmpctblock` message](core-ref-p2p-network-data-messages#cmpctblock), but instead announce new blocks by sending invs or <<glossary:headers>>, as defined by [BIP130](https://github.com/bitcoin/bips/blob/master/bip-0130.mediawiki).\n\nUpon receipt of a [`sendcmpct` message](core-ref-p2p-network-control-messages#sendcmpct) with the second integer set to something other than 1, nodes should treat the peer as if they had not received the message (as it indicates the peer will provide an unexpected encoding in [`cmpctblock` messages](core-ref-p2p-network-data-messages#cmpctblock), and/or other, messages). This allows future versions to send duplicate [`sendcmpct` messages](core-ref-p2p-network-control-messages#sendcmpct) with different versions as a part of a version handshake.\n\nNodes should check for a protocol version of >= 70209 before sending [`sendcmpct` messages](core-ref-p2p-network-control-messages#sendcmpct). Nodes shouldn't send a request for a `MSG_CMPCT_BLOCK` object to a peer before having received a [`sendcmpct` message](core-ref-p2p-network-control-messages#sendcmpct) from that peer. Nodes shouldn't request a `MSG_CMPCT_BLOCK` object before having sent all [`sendcmpct` messages](core-ref-p2p-network-control-messages#sendcmpct) to that peer which they intend to send, as the peer cannot know what protocol version to use in the response.\n\nThe structure of a [`sendcmpct` message](core-ref-p2p-network-control-messages#sendcmpct) is defined below.\n\n| Bytes    | Name          | Data Type        | Description\n|----------|---------------|------------------|--------------\n| 1        | announce      | bool             | 0 - Announce blocks via [`headers` message](core-ref-p2p-network-data-messages#headers) or [`inv` message](core-ref-p2p-network-data-messages#inv)<br>1 - Announce blocks via [`cmpctblock` message](core-ref-p2p-network-data-messages#cmpctblock)\n| 8        | version       | uint64_t         | The compact block protocol version number\n\nThe annotated hexdump below shows a [`sendcmpct` message](core-ref-p2p-network-control-messages#sendcmpct). (The message header has been omitted.)\n\n``` text\n01 ................................. Block announce type: Compact Blocks\n0100000000000000 ................... Compact block version: 1\n```\n\n# senddsq\n\n*Added in protocol version 70214 of Dash Core*\n\nThe [`senddsq` message](core-ref-p2p-network-control-messages#senddsq) is used to notify a <<glossary:peer>> whether or not to send [`dsq` messages](core-ref-p2p-network-privatesend-messages#dsq). This allows clients that are not interested in participating in CoinJoin processing (e.g. mobile <<glossary:wallet>>) to minimize data usage.\n\n| Bytes | Name | Data type | Description |\n| --- | --- | --- | --- |\n| 1 | fSendDSQueue | bool | 0 - Notify peer to not send any [`dsq` messages](core-ref-p2p-network-privatesend-messages#dsq)<br>1 - Notify peer to send all [`dsq` messages](core-ref-p2p-network-privatesend-messages#dsq)\n\nThe following annotated hexdump shows a [`senddsq` message](core-ref-p2p-network-control-messages#senddsq). (The message header has been omitted.)\n\n``` text\n01 ................................. CoinJoin participation: Enabled (1)\n```\n\n# sendheaders\n\nThe [`sendheaders` message](core-ref-p2p-network-control-messages#sendheaders) tells the receiving <<glossary:peer>> to send new <<glossary:block>> announcements using a [`headers` message](core-ref-p2p-network-data-messages#headers) rather than an [`inv` message](core-ref-p2p-network-data-messages#inv).\n\nThere is no payload in a [`sendheaders` message](core-ref-p2p-network-control-messages#sendheaders).  See the [message header section](core-ref-p2p-network-message-headers) for an example of a message without a payload.\n\n# sendheaders2\n\n*Added in protocol version 70223 of Dash Core.*\n\nThe [`sendheaders2` message](core-ref-p2p-network-control-messages#sendheaders2) tells the receiving <<glossary:peer>> to send new <<glossary:block>> announcements using a [`headers2` message](core-ref-p2p-network-data-messages#headers2) rather than an [`inv` message](core-ref-p2p-network-data-messages#inv).\n\nThere is no payload in a [`sendheaders2` message](core-ref-p2p-network-control-messages#sendheaders2).  See the [message header section](core-ref-p2p-network-message-headers) for an example of a message without a payload.\n\n# spork\n\nSporks are a mechanism by which updated code is released to the network, but not immediately made active (or \u201cenforced\u201d). Enforcement of the updated code can be activated remotely. Should problems arise, the code can be deactivated in the same manner, without the need for a network-wide rollback or client update.\n\nA [`spork` message](core-ref-p2p-network-control-messages#spork) may be sent in response to a [`getsporks` message](core-ref-p2p-network-control-messages#getsporks).\n\nThe [`spork` message](core-ref-p2p-network-control-messages#spork) tells the receiving peer the status of the spork defined by the SporkID field. Upon receiving a <<glossary:spork>> message, the client must verify the <<glossary:signature>> before accepting the spork message as valid.\n\n| Bytes | Name | Data type | Required | Description |\n| ---------- | ----------- | --------- | -------- | -------- |\n| 4 | nSporkID | int | Required | ID assigned in spork.h\n| 8 | nValue | int64_t | Required | Value assigned to spork<br>Default (disabled): `4000000000`\n| 8 | nTimeSigned | int64_t | Required | Time the spork value was signed\n| 66 | vchSig | char[] | Required | Length (1 byte) + Signature (65 bytes)\n\n**Active Sporks (per [`src/spork.h`](https://github.com/dashpay/dash/blob/v0.17.x/src/spork.h#L24))**\n\n| Spork ID | Num. | Name | Description |\n| :----------: | :----------: | ----------- | ----------- |\n| 10001 | 2 | `INSTANTSEND_ENABLED` | **_Updated in Dash Core 0.17.0_**<br>Turns InstantSend on and off network wide. Also determines if new mempool transactions should be locked or not.\n| 10002 | 3 | `INSTANTSEND_BLOCK_`<br>`FILTERING` | Turns on and off InstantSend block filtering\n| 10008 | 9 | `SUPERBLOCKS_ENABLED` | Superblocks are enabled (10% of the block reward allocated to fund the dash treasury for funding approved proposals)\n| 10016 | 17 | `SPORK_17_QUORUM_DKG_`<br>`ENABLED` | Enable long-living masternode quorum (LLMQ) distributed key generation (DKG). When enabled, simple PoSe  scoring and banning is active as well.\n| 10018 | 19 | `SPORK_19_CHAINLOCKS_`<br>`ENABLED` | Enable LLMQ-based ChainLocks.\n| 10020 | 21 | `SPORK_21_QUORUM_ALL_`<br>`CONNECTED` | **_Added in Dash Core 0.16.0_**<br>Enable connections between all masternodes in a quorum to optimize the signature recovery process.<br>Note: Prior to Dash Core 0.17.0 this spork also enforced [PoSe requirements](core-guide-dash-features-proof-of-service#distributed-key-generation-participation-requirements) for masternodes to support a minimum protocol version and maintain open ports.\n| 10022 | 23 | `SPORK_23_QUORUM_POSE`<br>`CONNECTED` | **Added in Dash Core 0.17.0**<br>Enforce [PoSe requirements](core-guide-dash-features-proof-of-service#distributed-key-generation-participation-requirements) for masternodes to support a minimum protocol version and maintain open ports.\n\n> \ud83d\udcd8 Spork 2 Values\n>\n> As of Dash Core 0.17.0, spork 2 supports two different enabled values:\n> - `0` - Masternodes create locks for all transactions\n> - `1` - Masternodes only create locks for transactions included in a block. Transactions in the mempool are not locked.\n>\n>Mode 1 is only for use in the event of a sustained overload of InstantSend to ensure that ChainLocks can remain operational. See [PR 4024](https://github.com/dashpay/dash/pull/4024) for details.\n\n> \ud83d\udcd8 Spork 21 and 23 Values\n>\n> Spork 21 and 23 support two different enabled values:\n> - `0` - The spork is active for all quorums regardless of quorum size.\n> - `1` - The spork is active only for quorums which have a member size less than 100.\n>\n> Mode 1 is only for use in the event of a sustained overload of InstantSend to ensure that ChainLocks can remain operational. See [PR 4024](https://github.com/dashpay/dash/pull/4024) for details.\n\n**Removed Sporks**\nThe following sporks were used in the past but are no longer necessary and have been removed recently. To see sporks removed longer ago, please see the [previous version of documentation](https://dashcore.readme.io/v0.16.0/docs/core-ref-p2p-network-control-messages#spork).\n\n> \ud83d\udcd8 Spork 6\n>\n> Since spork 6 was never enabled on mainnet, it was removed in Dash Core 0.16.0. The associated logic was hardened in [PR  3662](https://github.com/dashpay/dash/pull/3662) to support testnet (where it is enabled). If testnet is reset at some point in the future, the remaining logic will be removed.\n\n| Spork ID | Num. | Name | Description |\n| :----------: | :----------: | ----------- | ----------- |\n| _10004_ | _5_ | `INSTANTSEND_MAX_VALUE` | _Removed in Dash Core 0.15.0.<br>Controls the max value for an InstantSend transaction (currently 2000 DASH)_\n| _10005_ | _6_ | `NEW_SIGS` | _Removed in Dash Core 0.16.0.<br>Turns on and off new signature format for Dash-specific messages_\n| _10011_ | _12_ | `RECONSIDER_BLOCKS` | _Removed in Dash Core 0.15.0.<br>Forces reindex of a specified number of blocks to recover from unintentional network forks_\n| _10014_ | _15_ | `DETERMINISTIC_MNS_`<br>`ENABLED` | _Removed in Dash Core 0.16.0.<br>Deterministic masternode lists are enabled_\n| _10015_ | _16_ | `INSTANTSEND_AUTOLOCKS` | _Removed in Dash Core 0.16.0.<br>Automatic InstantSend for transactions with <=4 inputs (also eliminates the special InstantSend fee requirement for these transactions)_\n| _10019_ | _20_ | `SPORK_20_INSTANTSEND_`<br>`LLMQ_BASED` | _Removed in Dash Core 0.16.0.<br>Enable LLMQ-based InstantSend._\n| _10021_ | _22_ | `SPORK_22_PS_MORE_`<br>`PARTICIPANTS` | _Removed in Dash Core 0.17.0_<br>_Increase the maximum number of participants in CoinJoin sessions._\n\nTo verify `vchSig`, compare the hard-coded spork public key (`strSporkPubKey` from [`src/chainparams.cpp`](https://github.com/dashpay/dash/blob/eaf90b77177efbaf9cbed46e822f0d794f1a0ee5/src/chainparams.cpp#L158)) with the public key recovered from the [`spork` message](core-ref-p2p-network-control-messages#spork)'s hash and `vchSig` value (implementation details for Dash Core can be found in `CPubKey::RecoverCompact`). The hash is a double SHA-256 hash of:\n\n* The spork magic message (`\"DarkCoin Signed Message:\\n\"`)\n* nSporkID + nValue + nTimeSigned\n\n| Network | Spork Pubkey (wrapped) |\n| ---------- | ---------- |\n| Mainnet | 04549ac134f694c0243f503e8c8a9a986f5de6610049c40b07816809b0d1<br>d06a21b07be27b9bb555931773f62ba6cf35a25fd52f694d4e1106ccd237<br>a7bb899fdd |\n| Testnet3 | 046f78dcf911fbd61910136f7f0f8d90578f68d0b3ac973b5040fb7afb50<br>1b5939f39b108b0569dca71488f5bbf498d92e4d1194f6f941307ffd95f7<br>5e76869f0e |\n| RegTest | Undefined |\n| Devnets | 046f78dcf911fbd61910136f7f0f8d90578f68d0b3ac973b5040fb7afb50<br>1b5939f39b108b0569dca71488f5bbf498d92e4d1194f6f941307ffd95f7<br>5e76869f0e |\n\nThe following annotated hexdump shows a [`spork` message](core-ref-p2p-network-control-messages#spork).\n\n``` text\n11270000 .................................... Spork ID: Spork 2 InstantSend enabled (10001)\n0000000000000000 ............................ Value (0)\n2478da5900000000 ............................ Epoch time: 2017-10-08 19:10:28 UTC (1507489828)\n\n41 .......................................... Signature length: 65\n\n1b6762d3e70890b5cfaed5d1fd72121c\nd32020c827a89f8128a00acd210f4ea4\n1b36c26c3767f8a24f48663e189865ed\n403ed1e850cdb4207cdd466419d9d183\n45 .......................................... Masternode Signature\n```\n\n# verack\n\nThe [`verack` message](core-ref-p2p-network-control-messages#verack) acknowledges a previously-received [`version` message](core-ref-p2p-network-control-messages#version), informing the connecting <<glossary:node>> that it can begin to send other messages. The [`verack` message](core-ref-p2p-network-control-messages#verack) has no payload; for an example of a message with no payload, see the [message headers section](core-ref-p2p-network-message-headers).\n\n# version\n\nThe [`version` message](core-ref-p2p-network-control-messages#version) provides information about the transmitting <<glossary:node>> to the receiving node at the beginning of a connection. Until both <<glossary:peers>> have exchanged [`version` messages](core-ref-p2p-network-control-messages#version), no other messages will be accepted.\n\nIf a [`version` message](core-ref-p2p-network-control-messages#version) is accepted, the receiving node should send a [`verack` message](core-ref-p2p-network-control-messages#verack)---but no node should send a [`verack` message](core-ref-p2p-network-control-messages#verack) before initializing its half of the connection by first sending a [`version` message](core-ref-p2p-network-control-messages#version).\n\nProtocol version 70214 added a <<glossary:masternode>> authentication (challenge/response) system. Following the [`verack` message](core-ref-p2p-network-control-messages#verack), masternodes should send a [`mnauth` message](core-ref-p2p-network-masternode-messages#mnauth) that signs the `mnauth_challenge` with their BLS operator key.\n\n| Bytes    | Name                  | Data<br>Type        | Required/<br>Optional                        | Description\n|----------|-----------------------|------------------|------------------------------------------|-------------\n| 4        | version               | int32_t          | Required                                 | The highest protocol version understood by the transmitting node.  See the [protocol version section](core-ref-p2p-network-protocol-versions).\n| 8        | services              | uint64_t         | Required                                 | The services supported by the transmitting node encoded as a bitfield.  See the list of service codes below.\n| 8        | timestamp             | int64_t          | Required                                 | The current Unix epoch time according to the transmitting node's clock.  Because nodes will reject blocks with timestamps more than two hours in the future, this field can help other nodes to determine that their clock is wrong.\n| 8        | addr_recv services    | uint64_t         | Required                                 | *Added in protocol version 106.* <br><br>The services supported by the receiving node as perceived by the transmitting node.  Same format as the 'services' field above. Dash Core will attempt to provide accurate information.\n| 16       | addr_recv IP address  | char             | Required                                 | *Added in protocol version 106.* <br><br>The IPv6 address of the receiving node as perceived by the transmitting node in **big endian byte order**. IPv4 addresses can be provided as [IPv4-mapped IPv6 addresses](http://en.wikipedia.org/wiki/IPv6#IPv4-mapped_IPv6_addresses). Dash Core will attempt to provide accurate information.\n| 2        | addr_recv port        | uint16_t         | Required                                 | *Added in protocol version 106.* <br><br>The port number of the receiving node as perceived by the transmitting node in **big endian byte order**.\n| 8        | addr_trans services   | uint64_t         | Required                                 | The services supported by the transmitting node.  Should be identical to the 'services' field above.\n| 16       | addr_trans IP address | char             | Required                                 | The IPv6 address of the transmitting node in **big endian byte order**. IPv4 addresses can be provided as [IPv4-mapped IPv6 addresses](http://en.wikipedia.org/wiki/IPv6#IPv4-mapped_IPv6_addresses).  Set to ::ffff:127.0.0.1 if unknown.\n| 2        | addr_trans port       | uint16_t         | Required                                 | The port number of the transmitting node in **big endian byte order**.\n| 8        | nonce                 | uint64_t         | Required                                 | A random nonce which can help a node detect a connection to itself.  If the nonce is 0, the nonce field is ignored.  If the nonce is anything else, a node should terminate the connection on receipt of a [`version` message](core-ref-p2p-network-control-messages#version) with a nonce it previously sent.\n| *Varies* | user_agent bytes      | compactSize uint | Required                                 | Number of bytes in following user\\_agent field.  If 0x00, no user agent field is sent.\n| *Varies* | user_agent            | string           | Required if user_agent bytes > 0         | *Renamed in protocol version 60000.* <br><br>User agent as defined by BIP14. Previously called subVer.<br><br>Dash Core limits the length to 256 characters.\n| 4        | start_height          | int32_t          | Required                                 | The height of the transmitting node's best block chain or, in the case of an SPV client, best block header chain.\n| 1        | relay                 | bool             | Optional                                 | *Added in protocol version 70001 as described by BIP37.* <br><br>Transaction relay flag.  If 0x00, no [`inv` messages](core-ref-p2p-network-data-messages#inv) or [`tx` messages](core-ref-p2p-network-data-messages#tx) announcing new transactions should be sent to this client until it sends a [`filterload` message](core-ref-p2p-network-control-messages#filterload) or [`filterclear` message](core-ref-p2p-network-control-messages#filterclear).  If the relay field is not present or is set to 0x01, this node wants [`inv` messages](core-ref-p2p-network-data-messages#inv) and [`tx` messages](core-ref-p2p-network-data-messages#tx) announcing new transactions.\n| 32       | mnauth_<br>challenge  | uint256          | Optional                                 | *Added in protocol version 70214* <br><br>A challenge to be signed by the receiving masternode. The response is returned via a [`mnauth` message](core-ref-p2p-network-masternode-messages#mnauth) following the [`verack` message](core-ref-p2p-network-control-messages#verack).\n\nThe following service identifiers have been assigned.\n\n| Value | Name         | Description\n|-------|--------------|---------------\n| 0x00  | *Unnamed*    | This node is not a full node.  It may not be able to provide any data except for the transactions it originates.\n| 0x01  | `NODE_NETWORK` | This is a full node and can be asked for full blocks.  It should implement all protocol features available in its self-reported protocol version.\n| 0x02  | `NODE_GETUTXO` | This node is capable of responding to the getutxo protocol request. *Dash Core does not support this service.*\n| 0x04  | `NODE_BLOOM` | This node is capable and willing to handle bloom-filtered connections.  Dash Core nodes used to support this by default, without advertising this bit, but no longer do as of protocol version 70201 (= NO_BLOOM_VERSION)\n| 0x08 | `NODE_XTHIN` | This node supports Xtreme Thinblocks. *Dash Core does not support this service.*\n| 0x400 | `NODE_NETWORK_LIMITED` | This is the same as `NODE_NETWORK` with the limitation of only serving the last 288 blocks. *Not supported prior to Dash Core 0.16.0*\n\nThe following annotated hexdump shows a [`version` message](core-ref-p2p-network-control-messages#version). (The message header has been omitted and the actual IP addresses have been replaced with [RFC5737](http://tools.ietf.org/html/rfc5737) reserved IP addresses.)\n\n``` text\n46120100 .................................... Protocol version: 70214\n0500000000000000 ............................ Services: NODE_NETWORK (1) + NODE_BLOOM (4)\n9c10ad5c00000000 ............................ Epoch time: 1554845852\n\n0100000000000000 ............................ Receiving node's services\n00000000000000000000ffffc61b6409 ............ Receiving node's IPv6 address\n270f ........................................ Receiving node's port number\n\n0500000000000000 ............................ Transmitting node's services\n00000000000000000000ffffcb0071c0 ............ Transmitting node's IPv6 address\n270f ........................................ Transmitting node's port number\n\n128035cbc97953f8 ............................ Nonce\n\n12 .......................................... Bytes in user agent string: 18\n2f4461736820436f72653a302e31322e312e352f..... User agent: /Dash Core:0.14.0/\n\n851f0b00 .................................... Start height: 76944\n01 .......................................... Relay flag: true\n\n5dbb5d1baade6a9afa34db708f72c0dd\nb5bd82b3656493484556689640a91357 ............ Masternode Auth. Challenge\n```",
 "order": 3,
 "isReference": false,
 "deprecated": false,
 "hidden": false,
 "sync_unique": "",
 "link_url": "",
 "link_external": false,
 "reusableContent": [],
 "previousSlug": "",
 "slugUpdatedAt": "2020-07-08T13:59:08.034Z",
 "revision": 8,
 "_id": "63f5176df91c7700118e77aa",
 "version": "63f5176df91c7700118e7825",
 "updatedAt": "2023-02-21T21:23:10.841Z",
 "createdAt": "2019-10-23T16:02:39.802Z",
 "project": "5daf2e65f4109c0040fd51e1",
 "user": "5b8400d7185d5e00036dcc3b",
 "parentDoc": "63f5176df91c7700118e77a5",
 "category": "63f5176df91c7700118e779d",
 "__v": 2,
 "pendingAlgoliaPublish": false,
 "isApi": false,
 "id": "63f5176df91c7700118e77aa",
 "body_html": "<p>The following <span class=\"GlossaryItem-trigger\">network</span> messages all help control the connection between two <span class=\"GlossaryItem-trigger\">peers</span> or allow them to advise each other about the rest of the network.</p>\n<p><span aria-label=\"Overview Of P2P Protocol Control And Advisory Messages\" class=\"img lightbox closed\" role=\"button\" tabindex=\"0\"><span class=\"lightbox-inner\"><img alt=\"Overview Of P2P Protocol Control And Advisory Messages\" loading=\"lazy\" src=\"https://dash-docs.github.io/img/dev/en-p2p-control-messages.svg\" align=\"\" caption=\"\" height=\"auto\" title=\"\" width=\"auto\"/></span></span></p>\n<p>Note that almost none of the control messages are authenticated in any way, meaning they can contain incorrect or intentionally harmful information.</p>\n<h1 class=\"heading heading-1 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"addr\"></div><div class=\"heading-text\"><div id=\"section-addr\" class=\"heading-anchor_backwardsCompatibility\"></div>addr</div><a aria-label=\"Skip link to addr\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#addr\"></a></h1>\n<p>The <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">addr</code> (IP address) message relays connection information for peers on the network. Each peer which wants to accept incoming connections creates an <a href=\"core-ref-p2p-network-control-messages#addr\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">addr</code> message</a> providing its connection information and then sends that message to its peers unsolicited. Some of its peers send that information to their peers (also unsolicited), some of which further distribute it, allowing decentralized peer discovery for any program already on the network.</p>\n<p>An <a href=\"core-ref-p2p-network-control-messages#addr\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">addr</code> message</a> may also be sent in response to a <a href=\"core-ref-p2p-network-control-messages#getaddr\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">getaddr</code> message</a>.</p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<div class=\"rdmd-table\"><div class=\"rdmd-table-inner\"><table><thead><tr><th>Bytes</th><th>Name</th><th>Data Type</th><th>Description</th></tr></thead><tbody><tr><td><em>Varies</em></td><td>IP address count</td><td>compactSize uint</td><td>The number of IP address entries up to a maximum of 1,000.</td></tr><tr><td><em>Varies</em></td><td>IP addresses</td><td>network IP address</td><td>IP address entries.  See the table below for the format of a Dash network IP address.</td></tr></tbody></table></div></div>\n<p>Each encapsulated network IP address currently uses the following structure:</p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<div class=\"rdmd-table\"><div class=\"rdmd-table-inner\"><table><thead><tr><th>Bytes</th><th>Name</th><th>Data Type</th><th>Description</th></tr></thead><tbody><tr><td>4</td><td>time</td><td>uint32</td><td><em>Added in protocol version 31402.</em> <br/><br/>A time in Unix epoch time format.  Nodes advertising their own IP address set this to the current time.  Nodes advertising IP addresses they&#x27;ve connected to set this to the last time they connected to that node.  Other nodes just relaying the IP address should not change the time.  Nodes can use the time field to avoid relaying old <a href=\"core-ref-p2p-network-control-messages#addr\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">addr</code> messages</a>.  <br/><br/>Malicious nodes may change times or even set them in the future.</td></tr><tr><td>8</td><td>services</td><td>uint64_t</td><td>The services the node advertised in its <a href=\"core-ref-p2p-network-control-messages#version\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">version</code> message</a>.</td></tr><tr><td>16</td><td>IP address</td><td>char</td><td>IPv6 address in <strong>big endian byte order</strong>. IPv4 addresses can be provided as <a href=\"http://en.wikipedia.org/wiki/IPv6#IPv4-mapped_IPv6_addresses\" target=\"\" title=\"\">IPv4-mapped IPv6 addresses</a></td></tr><tr><td>2</td><td>port</td><td>uint16_t</td><td>Port number in <strong>big endian byte order</strong>.  Note that Dash Core will only connect to nodes with non-standard port numbers as a last resort for finding peers.  This is to prevent anyone from trying to use the network to disrupt non-Dash services that run on other ports.</td></tr></tbody></table></div></div>\n<p>The following annotated hexdump shows part of an <a href=\"core-ref-p2p-network-control-messages#addr\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">addr</code> message</a>. (The <span class=\"GlossaryItem-trigger\">message header</span> has been omitted and the actual IP address has been replaced with a <a href=\"http://tools.ietf.org/html/rfc5737\" target=\"\" title=\"\">RFC5737</a> reserved IP address.)</p>\n<div class=\"CodeTabs CodeTabs_initial theme-light\"><div class=\"CodeTabs-toolbar\" role=\"tablist\"><button aria-selected=\"true\" class=\"CodeTabs_active\" role=\"tab\" type=\"button\">Text</button></div><div class=\"CodeTabs-inner\" role=\"tabpanel\"><pre><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang-text theme-light\" data-lang=\"text\" name=\"\" tabindex=\"0\">fde803 ............................. Address count: 1000\n\nd91f4854 ........................... Epoch time: 1414012889\n0100000000000000 ................... Service bits: 01 (network node)\n00000000000000000000ffffc0000233 ... IP Address: ::ffff:192.0.2.51\n208d ............................... Port: 8333\n\n[...] .............................. (999 more addresses omitted)\n</code></pre></div></div>\n<h1 class=\"heading heading-1 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"addrv2\"></div><div class=\"heading-text\"><div id=\"section-addrv-2\" class=\"heading-anchor_backwardsCompatibility\"></div>addrv2</div><a aria-label=\"Skip link to addrv2\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#addrv2\"></a></h1>\n<p><em>Added in protocol version 70220 of Dash Core</em></p>\n<p>The <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">addrv2</code> message relays connection information for peers on the network just like the <a href=\"#addr\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">addr</code> message</a>, but is extended to allow gossiping of longer node addresses as described in <a href=\"https://github.com/bitcoin/bips/blob/master/bip-0155.mediawiki\" target=\"\" title=\"\">BIP155</a>.</p>\n<p>Each encapsulated network IP address currently uses the following structure:</p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<div class=\"rdmd-table\"><div class=\"rdmd-table-inner\"><table><thead><tr><th>Bytes</th><th>Name</th><th>Data Type</th><th>Description</th></tr></thead><tbody><tr><td>4</td><td>time</td><td>uint32_t</td><td>A time in Unix epoch time format.  Nodes advertising their own IP address set this to the current time.  Nodes advertising IP addresses they&#x27;ve connected to set this to the last time they connected to that node.  Other nodes just relaying the IP address should not change the time.</td></tr><tr><td>Varies</td><td>services</td><td>compactSize uint</td><td>The services the node advertised in its <a href=\"core-ref-p2p-network-control-messages#version\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">version</code> message</a>.</td></tr><tr><td>1</td><td>networkID</td><td>uint8_t</td><td>Network identifier. An 8-bit value that specifies which network is addressed. Network ID types may be found in <a href=\"https://github.com/bitcoin/bips/blob/master/bip-0155.mediawiki#specification\" target=\"\" title=\"\">BIP155</a>.</td></tr><tr><td>Varies</td><td>addr</td><td>Vector&lt;uint8_t&gt;</td><td>Network address. The interpretation depends on networkID.</td></tr><tr><td>2</td><td>port</td><td>uint16_t</td><td>Port number in <strong>big endian byte order</strong>.  Note that Dash Core will only connect to nodes with non-standard port numbers as a last resort for finding peers.  This is to prevent anyone from trying to use the network to disrupt non-Dash services that run on other ports.</td></tr></tbody></table></div></div>\n<p>The following annotated hexdump shows part of an <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">addrv2</code> message. (The <span class=\"GlossaryItem-trigger\">message header</span> has been omitted.)</p>\n<div class=\"CodeTabs CodeTabs_initial theme-light\"><div class=\"CodeTabs-toolbar\" role=\"tablist\"><button aria-selected=\"true\" class=\"CodeTabs_active\" role=\"tab\" type=\"button\">Text</button></div><div class=\"CodeTabs-inner\" role=\"tabpanel\"><pre><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang-text theme-light\" data-lang=\"text\" name=\"\" tabindex=\"0\">01 ................................. Address count: 1\n\n1a2a8961 ........................... Epoch time: 1636379162\n\nServices information\n| fd ............................... Number of service bytes (2)\n| 0504 ............................. Service bits: 10000000101 (network, bloom, network_limited)\n\nPeer address details\n| 01 ............................... Network ID (1 - IPv4)\n| 04 ............................... Address length\n| 2d20ed4c ......................... IP Address: 45.32.237.76\n| 4a37 ............................. Port: 18999\n</code></pre></div></div>\n<h1 class=\"heading heading-1 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"filteradd\"></div><div class=\"heading-text\"><div id=\"section-filteradd\" class=\"heading-anchor_backwardsCompatibility\"></div>filteradd</div><a aria-label=\"Skip link to filteradd\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#filteradd\"></a></h1>\n<p><em>Added in protocol version 70001 as described by BIP37.</em></p>\n<p>The <a href=\"core-ref-p2p-network-control-messages#filteradd\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">filteradd</code> message</a> tells the receiving <span class=\"GlossaryItem-trigger\">peer</span> to add a single element to a previously-set <span class=\"GlossaryItem-trigger\">bloom filter</span>, such as a new <span class=\"GlossaryItem-trigger\">public key</span>. The element is sent directly to the receiving peer; the peer then uses the parameters set in the <a href=\"core-ref-p2p-network-control-messages#filterload\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">filterload</code> message</a> to add the element to the bloom filter.</p>\n<p>Because the element is sent directly to the receiving peer, there is no obfuscation of the element and none of the plausible-deniability privacy provided by the bloom filter. Clients that want to maintain greater privacy should recalculate the bloom filter themselves and send a new <a href=\"core-ref-p2p-network-control-messages#filterload\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">filterload</code> message</a> with the recalculated bloom filter.</p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<div class=\"rdmd-table\"><div class=\"rdmd-table-inner\"><table><thead><tr><th>Bytes</th><th>Name</th><th>Data Type</th><th>Description</th></tr></thead><tbody><tr><td><em>Varies</em></td><td>element bytes</td><td>compactSize uint</td><td>The number of bytes in the following element field.</td></tr><tr><td><em>Varies</em></td><td>element</td><td>uint8_t[]</td><td>The element to add to the current filter.  Maximum of 520 bytes, which is the maximum size of an element which can be pushed onto the stack in a pubkey or signature script.  Elements must be sent in the byte order they would use when appearing in a raw transaction; for example, hashes should be sent in internal byte order.</td></tr></tbody></table></div></div>\n<p>Note: a <a href=\"core-ref-p2p-network-control-messages#filteradd\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">filteradd</code> message</a> will not be accepted unless a filter was previously set with the <a href=\"core-ref-p2p-network-control-messages#filterload\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">filterload</code> message</a>.</p>\n<p>The annotated hexdump below shows a <a href=\"core-ref-p2p-network-control-messages#filteradd\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">filteradd</code> message</a> adding a <span class=\"GlossaryItem-trigger\">TXID</span>. (The message header has been omitted.) This TXID appears in the same block used for the example hexdump in the <a href=\"core-ref-p2p-network-data-messages#merkleblock\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">merkleblock</code> message</a>; if that <a href=\"core-ref-p2p-network-data-messages#merkleblock\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">merkleblock</code> message</a> is re-sent after sending this <a href=\"core-ref-p2p-network-control-messages#filteradd\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">filteradd</code> message</a>, six hashes are returned instead of four.</p>\n<div class=\"CodeTabs CodeTabs_initial theme-light\"><div class=\"CodeTabs-toolbar\" role=\"tablist\"><button aria-selected=\"true\" class=\"CodeTabs_active\" role=\"tab\" type=\"button\">Text</button></div><div class=\"CodeTabs-inner\" role=\"tabpanel\"><pre><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang-text theme-light\" data-lang=\"text\" name=\"\" tabindex=\"0\">20 ................................. Element bytes: 32\nfdacf9b3eb077412e7a968d2e4f11b9a\n9dee312d666187ed77ee7d26af16cb0b ... Element (A TXID)\n</code></pre></div></div>\n<h1 class=\"heading heading-1 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"filterclear\"></div><div class=\"heading-text\"><div id=\"section-filterclear\" class=\"heading-anchor_backwardsCompatibility\"></div>filterclear</div><a aria-label=\"Skip link to filterclear\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#filterclear\"></a></h1>\n<p><em>Added in protocol version 70001 as described by BIP37.</em></p>\n<p>The <a href=\"core-ref-p2p-network-control-messages#filterclear\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">filterclear</code> message</a> tells the receiving <span class=\"GlossaryItem-trigger\">peer</span> to remove a previously-set <span class=\"GlossaryItem-trigger\">bloom filter</span>.  This also undoes the effect of setting the relay field in the <a href=\"core-ref-p2p-network-control-messages#version\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">version</code> message</a> to 0, allowing unfiltered access to <a href=\"core-ref-p2p-network-data-messages#inv\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">inv</code> messages</a> announcing new transactions.</p>\n<p>Dash Core does not require a <a href=\"core-ref-p2p-network-control-messages#filterclear\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">filterclear</code> message</a> before a replacement filter is loaded with <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">filterload</code>.  It also doesn&#x27;t require a <a href=\"core-ref-p2p-network-control-messages#filterload\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">filterload</code> message</a> before a <a href=\"core-ref-p2p-network-control-messages#filterclear\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">filterclear</code> message</a>.</p>\n<p>There is no payload in a <a href=\"core-ref-p2p-network-control-messages#filterclear\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">filterclear</code> message</a>.  See the <a href=\"core-ref-p2p-network-message-headers\" target=\"\" title=\"\">message header section</a> for an example of a message without a payload.</p>\n<h1 class=\"heading heading-1 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"filterload\"></div><div class=\"heading-text\"><div id=\"section-filterload\" class=\"heading-anchor_backwardsCompatibility\"></div>filterload</div><a aria-label=\"Skip link to filterload\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#filterload\"></a></h1>\n<p><em>Added in protocol version 70001 as described by BIP37.</em></p>\n<p>The <a href=\"core-ref-p2p-network-control-messages#filterload\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">filterload</code> message</a> tells the receiving <span class=\"GlossaryItem-trigger\">peer</span> to filter all relayed transactions and requested <span class=\"GlossaryItem-trigger\">merkle blocks</span> through the provided filter. This allows clients to receive transactions relevant to their <span class=\"GlossaryItem-trigger\">wallet</span> plus a configurable rate of false positive transactions which can provide plausible-deniability privacy.</p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<div class=\"rdmd-table\"><div class=\"rdmd-table-inner\"><table><thead><tr><th>Bytes</th><th>Name</th><th>Data Type</th><th>Description</th></tr></thead><tbody><tr><td><em>Varies</em></td><td>nFilterBytes</td><td>compactSize uint</td><td>Number of bytes in the following filter bit field.</td></tr><tr><td><em>Varies</em></td><td>filter</td><td>uint8_t[]</td><td>A bit field of arbitrary byte-aligned size. The maximum size is 36,000 bytes.</td></tr><tr><td>4</td><td>nHashFuncs</td><td>uint32_t</td><td>The number of hash functions to use in this filter. The maximum value allowed in this field is 50.</td></tr><tr><td>4</td><td>nTweak</td><td>uint32_t</td><td>An arbitrary value to add to the seed value in the hash function used by the bloom filter.</td></tr><tr><td>1</td><td>nFlags</td><td>uint8_t</td><td>A set of flags that control how outpoints corresponding to a matched pubkey script are added to the filter. See the table in the Updating A Bloom Filter subsection below.</td></tr></tbody></table></div></div>\n<p>The annotated hexdump below shows a <a href=\"core-ref-p2p-network-control-messages#filterload\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">filterload</code> message</a>. (The message header has been omitted.)  For an example of how this payload was created, see the <a href=\"core-examples-p2p-network-creating-a-bloom-filter\" target=\"\" title=\"\">filterload example</a>.</p>\n<div class=\"CodeTabs CodeTabs_initial theme-light\"><div class=\"CodeTabs-toolbar\" role=\"tablist\"><button aria-selected=\"true\" class=\"CodeTabs_active\" role=\"tab\" type=\"button\">Text</button></div><div class=\"CodeTabs-inner\" role=\"tabpanel\"><pre><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang-text theme-light\" data-lang=\"text\" name=\"\" tabindex=\"0\">02 ......... Filter bytes: 2\nb50f ....... Filter: 1010 1101 1111 0000\n0b000000 ... nHashFuncs: 11\n00000000 ... nTweak: 0/none\n00 ......... nFlags: BLOOM_UPDATE_NONE\n</code></pre></div></div>\n<h2 class=\"heading heading-2 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"initializing-a-bloom-filter\"></div><div class=\"heading-text\"><div id=\"section-initializing-a-bloom-filter\" class=\"heading-anchor_backwardsCompatibility\"></div>Initializing A Bloom Filter</div><a aria-label=\"Skip link to Initializing A Bloom Filter\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#initializing-a-bloom-filter\"></a></h2>\n<p>Filters have two core parameters: the size of the bit field and the number of hash functions to run against each data element. The following formulas from BIP37 will allow you to automatically select appropriate values based on the number of elements you plan to insert into the filter (<em>n</em>) and the false positive rate (<em>p</em>) you desire to maintain plausible deniability.</p>\n<ul>\n<li>\n<p>Size of the bit field in bytes (<em>nFilterBytes</em>), up to a maximum of 36,000: <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">(-1 / log(2)**2 * n * log(p)) / 8</code></p>\n</li>\n<li>\n<p>Hash functions to use (<em>nHashFuncs</em>), up to a maximum of 50:<br/>\n<button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">nFilterBytes * 8 / n * log(2)</code></p>\n</li>\n</ul>\n<p>Note that the filter matches parts of transactions (transaction elements), so the false positive rate is relative to the number of elements checked---not the number of transactions checked. Each normal transaction has a minimum of four matchable elements (described in the comparison subsection below), so a filter with a false-positive rate of 1 percent will match about 4 percent of all transactions at a minimum.</p>\n<p>According to BIP37, the formulas and limits described above provide support for bloom filters containing 20,000 items with a false positive rate of less than 0.1 percent or 10,000 items with a false positive rate of less than 0.0001 percent.</p>\n<p>Once the size of the bit field is known, the bit field should be initialized as all zeroes.</p>\n<h2 class=\"heading heading-2 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"populating-a-bloom-filter\"></div><div class=\"heading-text\"><div id=\"section-populating-a-bloom-filter\" class=\"heading-anchor_backwardsCompatibility\"></div>Populating A Bloom Filter</div><a aria-label=\"Skip link to Populating A Bloom Filter\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#populating-a-bloom-filter\"></a></h2>\n<p>The bloom filter is populated using between 1 and 50 unique hash functions (the number specified per filter by the <em>nHashFuncs</em> field). Instead of using up to 50 different hash function implementations, a single implementation is used with a unique seed value for each function.</p>\n<p>The seed is <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">nHashNum * 0xfba4c795 + nTweak</code> as a <em>uint32_t</em>, where the values are:</p>\n<ul>\n<li>\n<p><strong>nHashNum</strong> is the sequence number for this hash function, starting at 0 for the first hash iteration and increasing up to the value of the <em>nHashFuncs</em> field (minus one) for the last hash iteration.</p>\n</li>\n<li>\n<p><strong>0xfba4c795</strong> is a constant optimized to create large differences in the seed for different values of <em>nHashNum</em>.</p>\n</li>\n<li>\n<p><strong>nTweak</strong> is a per-filter constant set by the client to require the use of an arbitrary set of hash functions.</p>\n</li>\n</ul>\n<p>If the seed resulting from the formula above is larger than four bytes, it must be truncated to its four most significant bytes (for example, <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">0x8967452301 &amp; 0xffffffff \u2192 0x67452301</code>).</p>\n<p>The actual hash function implementation used is the <a href=\"https://en.wikipedia.org/wiki/MurmurHash\" target=\"\" title=\"\">32-bit Murmur3 hash function</a>.</p>\n<blockquote class=\"callout callout_warn\" theme=\"\ud83d\udea7\"><h2 class=\"callout-heading\"><span class=\"callout-icon\">\ud83d\udea7</span><p>Murmer3 Version</p></h2><p><strong>Warning:</strong> the Murmur3 hash function has separate 32-bit and 64-bit versions that produce different results for the same <span class=\"GlossaryItem-trigger\">input</span>.  Only the 32-bit Murmur3 version is used with Dash bloom filters.</p></blockquote>\n<p>The data to be hashed can be any transaction element which the bloom filter can match. See the next subsection for the list of transaction elements checked against the filter. The largest element which can be matched is a script data push of 520 bytes, so the data should never exceed 520 bytes.</p>\n<p>The example below from Dash Core <a href=\"https://github.com/dashpay/dash/blob/v0.15.x/src/bloom.cpp#L59\" target=\"\" title=\"\">bloom.cpp</a> combines all the steps above to create the hash function template. The seed is the first parameter; the data to be hashed is the second parameter. The result is a uint32_t modulo the size of the bit field in bits.</p>\n<div class=\"CodeTabs CodeTabs_initial theme-light\"><div class=\"CodeTabs-toolbar\" role=\"tablist\"><button aria-selected=\"true\" class=\"CodeTabs_active\" role=\"tab\" type=\"button\">C++</button></div><div class=\"CodeTabs-inner\" role=\"tabpanel\"><pre><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang-c theme-light\" data-lang=\"c\" name=\"\" tabindex=\"0\">MurmurHash3(nHashNum * 0xFBA4C795 + nTweak, vDataToHash) % (vData.size() * 8)\n</code></pre></div></div>\n<p>Each data element to be added to the filter is hashed by <em>nHashFuncs</em> number of hash functions. Each time a hash function is run, the result will be the index number (<em>nIndex</em>) of a bit in the bit field. That bit must be set to 1. For example if the filter bit field was <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">00000000</code> and the result is 5, the revised filter bit field is <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">00000100</code> (the first bit is bit 0).</p>\n<p>It is expected that sometimes the same index number will be returned more than once when populating the bit field; this does not affect the algorithm---after a bit is set to 1, it is never changed back to 0.</p>\n<p>After all data elements have been added to the filter, each set of eight bits is converted into a little-endian byte. These bytes are the value of the <em>filter</em> field.</p>\n<h2 class=\"heading heading-2 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"comparing-transaction-elements-to-a-bloom-filter\"></div><div class=\"heading-text\"><div id=\"section-comparing-transaction-elements-to-a-bloom-filter\" class=\"heading-anchor_backwardsCompatibility\"></div>Comparing Transaction Elements To A Bloom Filter</div><a aria-label=\"Skip link to Comparing Transaction Elements To A Bloom Filter\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#comparing-transaction-elements-to-a-bloom-filter\"></a></h2>\n<p>To compare an arbitrary data element against the bloom filter, it is hashed using the same parameters used to create the bloom filter. Specifically, it is hashed <em>nHashFuncs</em> times, each time using the same<br/>\n<em>nTweak</em> provided in the filter, and the resulting <span class=\"GlossaryItem-trigger\">output</span> is modulo the size of the bit field provided in the <em>filter</em> field.  After each hash is performed, the filter is checked to see if the bit at that indexed location is set.  For example if the result of a hash is <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">5</code> and the filter is <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">01001110</code>, the bit is considered set.</p>\n<p>If the result of every hash points to a set bit, the filter matches. If any of the results points to an unset bit, the filter does not match.</p>\n<p>The following transaction elements are compared against bloom filters. All elements will be hashed in the byte order used in <span class=\"GlossaryItem-trigger\">blocks</span> (for example, <span class=\"GlossaryItem-trigger\">TXIDs</span> will be in <span class=\"GlossaryItem-trigger\">internal byte order</span>).</p>\n<ul>\n<li>\n<p><strong>TXIDs:</strong> the transaction&#x27;s SHA256(SHA256()) hash.</p>\n</li>\n<li>\n<p><strong>Outpoints:</strong> each 36-byte <span class=\"GlossaryItem-trigger\">outpoint</span> used this transaction&#x27;s input section is individually compared to the filter.</p>\n</li>\n<li>\n<p><strong>Signature Script Data:</strong> each element pushed onto the stack by a <span class=\"GlossaryItem-trigger\">data-pushing opcode</span> in a <span class=\"GlossaryItem-trigger\">signature script</span> from this transaction is individually compared to the filter.  This includes data elements present in P2SH <span class=\"GlossaryItem-trigger\">redeem script</span> when they are being spent.</p>\n</li>\n<li>\n<p><strong>PubKey Script Data:</strong> each element pushed onto the the stack by a data-pushing opcode in any <span class=\"GlossaryItem-trigger\">pubkey script</span> from this transaction is individually compared to the filter. (If a pubkey script element matches the filter, the filter will be immediately updated if the <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">BLOOM_UPDATE_ALL</code> flag was set; if the pubkey script is in the P2PKH format and matches the filter, the filter will be immediately updated if the <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">BLOOM_UPDATE_P2PUBKEY_ONLY</code> flag was set. See the subsection below for details.)</p>\n</li>\n</ul>\n<p>As of  Dash Core 0.14.0, elements in the extra payload section of <a href=\"https://github.com/dashpay/dips/blob/master/dip-0002.md\" target=\"\" title=\"\">DIP2</a>-based <span class=\"GlossaryItem-trigger\">special transactions</span> are also compared against bloom filters.</p>\n<p>The following annotated hexdump of a transaction is from the <a href=\"core-ref-transactions-raw-transaction-format\" target=\"\" title=\"\">raw transaction format section</a>; the elements which would be checked by the filter are emphasized in bold. Note that this transaction&#x27;s TXID (<strong><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">01000000017b1eab[...]</code></strong>) would also be checked, and that the outpoint TXID and index number below would be checked as a single 36-byte element.</p>\n<pre><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">01000000 ................................... Version\n\n01 ......................................... Number of inputs\n|\n| </code></pre>\n<h2 class=\"heading heading-2 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"updating-a-bloom-filter\"></div><div class=\"heading-text\"><div id=\"section-updating-a-bloom-filter\" class=\"heading-anchor_backwardsCompatibility\"></div>Updating A Bloom Filter</div><a aria-label=\"Skip link to Updating A Bloom Filter\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#updating-a-bloom-filter\"></a></h2>\n<p>Clients will often want to track <span class=\"GlossaryItem-trigger\">inputs</span> that spend <span class=\"GlossaryItem-trigger\">outputs</span> (outpoints) relevant to their wallet, so the filterload field <em>nFlags</em> can be set to allow the filtering <span class=\"GlossaryItem-trigger\">node</span> to update the filter when a match is found. When the filtering node sees a <span class=\"GlossaryItem-trigger\">pubkey script</span> that pays a pubkey, <span class=\"GlossaryItem-trigger\">address</span>, or other data element matching the filter, the filtering node immediately updates the filter with the <span class=\"GlossaryItem-trigger\">outpoint</span> corresponding to that pubkey script.</p>\n<p><span aria-label=\"Automatically Updating Bloom Filters\" class=\"img lightbox closed\" role=\"button\" tabindex=\"0\"><span class=\"lightbox-inner\"><img alt=\"Automatically Updating Bloom Filters\" loading=\"lazy\" src=\"https://dash-docs.github.io/img/dev/en-bloom-update.svg\" align=\"\" caption=\"\" height=\"auto\" title=\"\" width=\"auto\"/></span></span></p>\n<p>If an input later spends that outpoint, the filter will match it, allowing the filtering node to tell the client that one of its transaction outputs has been spent.</p>\n<p>The <em>nFlags</em> field has three allowed values:</p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<div class=\"rdmd-table\"><div class=\"rdmd-table-inner\"><table><thead><tr><th>Value</th><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>0</td><td><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">BLOOM_UPDATE_NONE</code></td><td>The filtering node should not update the filter.</td></tr><tr><td>1</td><td><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">BLOOM_UPDATE_ALL</code></td><td>If the filter matches any data element in a pubkey script, the corresponding outpoint is added to the filter.</td></tr><tr><td>2</td><td><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">BLOOM_UPDATE_P2PUBKEY_ONLY</code></td><td>If the filter matches any data element in a pubkey script and that script is either a P2PKH or non-P2SH pay-to-multisig script, the corresponding outpoint is added to the filter.</td></tr></tbody></table></div></div>\n<p>In addition, because the filter size stays the same even though additional elements are being added to it, the false positive rate increases. Each false positive can result in another element being added to the filter, creating a feedback loop that can (after a certain point) make the filter useless. For this reason, clients using automatic filter updates need to monitor the actual false positive rate and send a new filter when the rate gets too high.</p>\n<h1 class=\"heading heading-1 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"getaddr\"></div><div class=\"heading-text\"><div id=\"section-getaddr\" class=\"heading-anchor_backwardsCompatibility\"></div>getaddr</div><a aria-label=\"Skip link to getaddr\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#getaddr\"></a></h1>\n<p>The <a href=\"core-ref-p2p-network-control-messages#getaddr\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">getaddr</code> message</a> requests an <a href=\"core-ref-p2p-network-control-messages#addr\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">addr</code> message</a> from the receiving <span class=\"GlossaryItem-trigger\">node</span>, preferably one with lots of IP addresses of other receiving nodes. The transmitting node can use those IP addresses to quickly update its database of available nodes rather than waiting for unsolicited <a href=\"core-ref-p2p-network-control-messages#addr\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">addr</code> messages</a> to arrive over time.</p>\n<p>There is no payload in a <a href=\"core-ref-p2p-network-control-messages#getaddr\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">getaddr</code> message</a>.  See the <a href=\"core-ref-p2p-network-message-headers\" target=\"\" title=\"\">message header section</a> for an example of a message without a payload.</p>\n<h1 class=\"heading heading-1 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"getsporks\"></div><div class=\"heading-text\"><div id=\"section-getsporks\" class=\"heading-anchor_backwardsCompatibility\"></div>getsporks</div><a aria-label=\"Skip link to getsporks\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#getsporks\"></a></h1>\n<p>The <a href=\"core-ref-p2p-network-control-messages#getsporks\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">getsporks</code> message</a> requests <a href=\"core-ref-p2p-network-control-messages#spork\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">spork</code> messages</a> from the receiving node.</p>\n<p>There is no payload in a <a href=\"core-ref-p2p-network-control-messages#getsporks\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">getsporks</code> message</a>.  See the <a href=\"core-ref-p2p-network-message-headers\" target=\"\" title=\"\">message header section</a> for an example of a message without a payload.</p>\n<h1 class=\"heading heading-1 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"ping\"></div><div class=\"heading-text\"><div id=\"section-ping\" class=\"heading-anchor_backwardsCompatibility\"></div>ping</div><a aria-label=\"Skip link to ping\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#ping\"></a></h1>\n<p>The <a href=\"core-ref-p2p-network-control-messages#ping\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">ping</code> message</a> helps confirm that the receiving <span class=\"GlossaryItem-trigger\">peer</span> is still connected. If a TCP/IP error is encountered when sending the <a href=\"core-ref-p2p-network-control-messages#ping\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">ping</code> message</a> (such as a connection timeout), the transmitting node can assume that the receiving node is disconnected. The response to a <a href=\"core-ref-p2p-network-control-messages#ping\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">ping</code> message</a> is the <a href=\"core-ref-p2p-network-control-messages#pong\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">pong</code> message</a>.</p>\n<p>Before protocol version 60000, the <a href=\"core-ref-p2p-network-control-messages#ping\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">ping</code> message</a> had no payload. As of protocol version 60001 and all later versions, the message includes a single field, the nonce.</p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<div class=\"rdmd-table\"><div class=\"rdmd-table-inner\"><table><thead><tr><th>Bytes</th><th>Name</th><th>Data Type</th><th>Description</th></tr></thead><tbody><tr><td>8</td><td>nonce</td><td>uint64_t</td><td><em>Added in protocol version 60001 as described by BIP31.</em> <br/><br/>Random nonce assigned to this <a href=\"core-ref-p2p-network-control-messages#ping\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">ping</code> message</a>.  The responding <a href=\"core-ref-p2p-network-control-messages#pong\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">pong</code> message</a> will include this nonce to identify the <a href=\"core-ref-p2p-network-control-messages#ping\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">ping</code> message</a> to which it is replying.</td></tr></tbody></table></div></div>\n<p>The annotated hexdump below shows a <a href=\"core-ref-p2p-network-control-messages#ping\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">ping</code> message</a>. (The message header has been omitted.)</p>\n<div class=\"CodeTabs CodeTabs_initial theme-light\"><div class=\"CodeTabs-toolbar\" role=\"tablist\"><button aria-selected=\"true\" class=\"CodeTabs_active\" role=\"tab\" type=\"button\">Text</button></div><div class=\"CodeTabs-inner\" role=\"tabpanel\"><pre><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang-text theme-light\" data-lang=\"text\" name=\"\" tabindex=\"0\">0094102111e2af4d ... Nonce\n</code></pre></div></div>\n<h1 class=\"heading heading-1 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"pong\"></div><div class=\"heading-text\"><div id=\"section-pong\" class=\"heading-anchor_backwardsCompatibility\"></div>pong</div><a aria-label=\"Skip link to pong\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#pong\"></a></h1>\n<p><em>Added in protocol version 60001 as described by BIP31.</em></p>\n<p>The <a href=\"core-ref-p2p-network-control-messages#pong\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">pong</code> message</a> replies to a <a href=\"core-ref-p2p-network-control-messages#ping\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">ping</code> message</a>, proving to the pinging <span class=\"GlossaryItem-trigger\">node</span> that the ponging node is still alive. Dash Core will, by default, disconnect from any clients which have not responded to a <a href=\"core-ref-p2p-network-control-messages#ping\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">ping</code> message</a> within 20 minutes.</p>\n<p>To allow nodes to keep track of latency, the <a href=\"core-ref-p2p-network-control-messages#pong\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">pong</code> message</a> sends back the same nonce received in the <a href=\"core-ref-p2p-network-control-messages#ping\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">ping</code> message</a> it is replying to.</p>\n<p>The format of the <a href=\"core-ref-p2p-network-control-messages#pong\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">pong</code> message</a> is identical to the <a href=\"core-ref-p2p-network-control-messages#ping\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">ping</code> message</a>; only the message header differs.</p>\n<h1 class=\"heading heading-1 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"sendaddrv2\"></div><div class=\"heading-text\"><div id=\"section-sendaddrv-2\" class=\"heading-anchor_backwardsCompatibility\"></div>sendaddrv2</div><a aria-label=\"Skip link to sendaddrv2\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#sendaddrv2\"></a></h1>\n<p><em>Added in protocol version 70220 of Dash Core</em></p>\n<p>The <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">sendaddrv2</code> message signals support for receiving <a href=\"#addrv2\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">addrv2</code> messages</a> (defined in <a href=\"https://github.com/bitcoin/bips/blob/master/bip-0155.mediawiki\" target=\"\" title=\"\">BIP155</a>). It also implies that its sender can encode as <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">addrv2</code> and would send <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">addrv2</code> messages instead of <a href=\"#addr\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">addr</code> messages</a> to a peer that has signaled <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">addrv2</code> support by sending a <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">sendaddrv2</code> message.</p>\n<p>There is no payload in a <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">sendaddrv2</code> message. See the <a href=\"core-ref-p2p-network-message-headers\" target=\"\" title=\"\">message header section</a> for an example of a message without a payload.</p>\n<h1 class=\"heading heading-1 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"sendcmpct\"></div><div class=\"heading-text\"><div id=\"section-sendcmpct\" class=\"heading-anchor_backwardsCompatibility\"></div>sendcmpct</div><a aria-label=\"Skip link to sendcmpct\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#sendcmpct\"></a></h1>\n<p><em>Added in protocol version 70209 of Dash Core as described by BIP152</em></p>\n<p>The <a href=\"core-ref-p2p-network-control-messages#sendcmpct\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">sendcmpct</code> message</a> tells the receiving <span class=\"GlossaryItem-trigger\">peer</span> whether or not to announce new <span class=\"GlossaryItem-trigger\">blocks</span> using a <a href=\"core-ref-p2p-network-data-messages#cmpctblock\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">cmpctblock</code> message</a>. It also sends the compact block protocol version it supports. The <a href=\"core-ref-p2p-network-control-messages#sendcmpct\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">sendcmpct</code> message</a> is defined as a message containing a 1-byte integer followed by a 8-byte integer. The first integer is interpreted as a boolean and should have a value of either 1 or 0. The second integer is be interpreted as a little-endian version number.</p>\n<p>Upon receipt of a <a href=\"core-ref-p2p-network-control-messages#sendcmpct\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">sendcmpct</code> message</a> with the first and second integers set to 1, the <span class=\"GlossaryItem-trigger\">node</span> should announce new blocks by sending a <a href=\"core-ref-p2p-network-data-messages#cmpctblock\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">cmpctblock</code> message</a>.</p>\n<p>Upon receipt of a <a href=\"core-ref-p2p-network-control-messages#sendcmpct\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">sendcmpct</code> message</a> with the first integer set to 0, the node shouldn&#x27;t announce new blocks by sending a <a href=\"core-ref-p2p-network-data-messages#cmpctblock\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">cmpctblock</code> message</a>, but instead announce new blocks by sending invs or <span class=\"GlossaryItem-trigger\">headers</span>, as defined by <a href=\"https://github.com/bitcoin/bips/blob/master/bip-0130.mediawiki\" target=\"\" title=\"\">BIP130</a>.</p>\n<p>Upon receipt of a <a href=\"core-ref-p2p-network-control-messages#sendcmpct\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">sendcmpct</code> message</a> with the second integer set to something other than 1, nodes should treat the peer as if they had not received the message (as it indicates the peer will provide an unexpected encoding in <a href=\"core-ref-p2p-network-data-messages#cmpctblock\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">cmpctblock</code> messages</a>, and/or other, messages). This allows future versions to send duplicate <a href=\"core-ref-p2p-network-control-messages#sendcmpct\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">sendcmpct</code> messages</a> with different versions as a part of a version handshake.</p>\n<p>Nodes should check for a protocol version of &gt;= 70209 before sending <a href=\"core-ref-p2p-network-control-messages#sendcmpct\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">sendcmpct</code> messages</a>. Nodes shouldn&#x27;t send a request for a <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">MSG_CMPCT_BLOCK</code> object to a peer before having received a <a href=\"core-ref-p2p-network-control-messages#sendcmpct\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">sendcmpct</code> message</a> from that peer. Nodes shouldn&#x27;t request a <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">MSG_CMPCT_BLOCK</code> object before having sent all <a href=\"core-ref-p2p-network-control-messages#sendcmpct\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">sendcmpct</code> messages</a> to that peer which they intend to send, as the peer cannot know what protocol version to use in the response.</p>\n<p>The structure of a <a href=\"core-ref-p2p-network-control-messages#sendcmpct\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">sendcmpct</code> message</a> is defined below.</p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<div class=\"rdmd-table\"><div class=\"rdmd-table-inner\"><table><thead><tr><th>Bytes</th><th>Name</th><th>Data Type</th><th>Description</th></tr></thead><tbody><tr><td>1</td><td>announce</td><td>bool</td><td>0 - Announce blocks via <a href=\"core-ref-p2p-network-data-messages#headers\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">headers</code> message</a> or <a href=\"core-ref-p2p-network-data-messages#inv\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">inv</code> message</a><br/>1 - Announce blocks via <a href=\"core-ref-p2p-network-data-messages#cmpctblock\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">cmpctblock</code> message</a></td></tr><tr><td>8</td><td>version</td><td>uint64_t</td><td>The compact block protocol version number</td></tr></tbody></table></div></div>\n<p>The annotated hexdump below shows a <a href=\"core-ref-p2p-network-control-messages#sendcmpct\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">sendcmpct</code> message</a>. (The message header has been omitted.)</p>\n<div class=\"CodeTabs CodeTabs_initial theme-light\"><div class=\"CodeTabs-toolbar\" role=\"tablist\"><button aria-selected=\"true\" class=\"CodeTabs_active\" role=\"tab\" type=\"button\">Text</button></div><div class=\"CodeTabs-inner\" role=\"tabpanel\"><pre><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang-text theme-light\" data-lang=\"text\" name=\"\" tabindex=\"0\">01 ................................. Block announce type: Compact Blocks\n0100000000000000 ................... Compact block version: 1\n</code></pre></div></div>\n<h1 class=\"heading heading-1 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"senddsq\"></div><div class=\"heading-text\"><div id=\"section-senddsq\" class=\"heading-anchor_backwardsCompatibility\"></div>senddsq</div><a aria-label=\"Skip link to senddsq\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#senddsq\"></a></h1>\n<p><em>Added in protocol version 70214 of Dash Core</em></p>\n<p>The <a href=\"core-ref-p2p-network-control-messages#senddsq\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">senddsq</code> message</a> is used to notify a <span class=\"GlossaryItem-trigger\">peer</span> whether or not to send <a href=\"core-ref-p2p-network-privatesend-messages#dsq\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">dsq</code> messages</a>. This allows clients that are not interested in participating in CoinJoin processing (e.g. mobile <span class=\"GlossaryItem-trigger\">wallet</span>) to minimize data usage.</p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<div class=\"rdmd-table\"><div class=\"rdmd-table-inner\"><table><thead><tr><th>Bytes</th><th>Name</th><th>Data type</th><th>Description</th></tr></thead><tbody><tr><td>1</td><td>fSendDSQueue</td><td>bool</td><td>0 - Notify peer to not send any <a href=\"core-ref-p2p-network-privatesend-messages#dsq\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">dsq</code> messages</a><br/>1 - Notify peer to send all <a href=\"core-ref-p2p-network-privatesend-messages#dsq\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">dsq</code> messages</a></td></tr></tbody></table></div></div>\n<p>The following annotated hexdump shows a <a href=\"core-ref-p2p-network-control-messages#senddsq\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">senddsq</code> message</a>. (The message header has been omitted.)</p>\n<div class=\"CodeTabs CodeTabs_initial theme-light\"><div class=\"CodeTabs-toolbar\" role=\"tablist\"><button aria-selected=\"true\" class=\"CodeTabs_active\" role=\"tab\" type=\"button\">Text</button></div><div class=\"CodeTabs-inner\" role=\"tabpanel\"><pre><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang-text theme-light\" data-lang=\"text\" name=\"\" tabindex=\"0\">01 ................................. CoinJoin participation: Enabled (1)\n</code></pre></div></div>\n<h1 class=\"heading heading-1 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"sendheaders\"></div><div class=\"heading-text\"><div id=\"section-sendheaders\" class=\"heading-anchor_backwardsCompatibility\"></div>sendheaders</div><a aria-label=\"Skip link to sendheaders\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#sendheaders\"></a></h1>\n<p>The <a href=\"core-ref-p2p-network-control-messages#sendheaders\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">sendheaders</code> message</a> tells the receiving <span class=\"GlossaryItem-trigger\">peer</span> to send new <span class=\"GlossaryItem-trigger\">block</span> announcements using a <a href=\"core-ref-p2p-network-data-messages#headers\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">headers</code> message</a> rather than an <a href=\"core-ref-p2p-network-data-messages#inv\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">inv</code> message</a>.</p>\n<p>There is no payload in a <a href=\"core-ref-p2p-network-control-messages#sendheaders\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">sendheaders</code> message</a>.  See the <a href=\"core-ref-p2p-network-message-headers\" target=\"\" title=\"\">message header section</a> for an example of a message without a payload.</p>\n<h1 class=\"heading heading-1 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"sendheaders2\"></div><div class=\"heading-text\"><div id=\"section-sendheaders-2\" class=\"heading-anchor_backwardsCompatibility\"></div>sendheaders2</div><a aria-label=\"Skip link to sendheaders2\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#sendheaders2\"></a></h1>\n<p><em>Added in protocol version 70223 of Dash Core.</em></p>\n<p>The <a href=\"core-ref-p2p-network-control-messages#sendheaders2\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">sendheaders2</code> message</a> tells the receiving <span class=\"GlossaryItem-trigger\">peer</span> to send new <span class=\"GlossaryItem-trigger\">block</span> announcements using a <a href=\"core-ref-p2p-network-data-messages#headers2\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">headers2</code> message</a> rather than an <a href=\"core-ref-p2p-network-data-messages#inv\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">inv</code> message</a>.</p>\n<p>There is no payload in a <a href=\"core-ref-p2p-network-control-messages#sendheaders2\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">sendheaders2</code> message</a>.  See the <a href=\"core-ref-p2p-network-message-headers\" target=\"\" title=\"\">message header section</a> for an example of a message without a payload.</p>\n<h1 class=\"heading heading-1 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"spork\"></div><div class=\"heading-text\"><div id=\"section-spork\" class=\"heading-anchor_backwardsCompatibility\"></div>spork</div><a aria-label=\"Skip link to spork\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#spork\"></a></h1>\n<p>Sporks are a mechanism by which updated code is released to the network, but not immediately made active (or \u201cenforced\u201d). Enforcement of the updated code can be activated remotely. Should problems arise, the code can be deactivated in the same manner, without the need for a network-wide rollback or client update.</p>\n<p>A <a href=\"core-ref-p2p-network-control-messages#spork\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">spork</code> message</a> may be sent in response to a <a href=\"core-ref-p2p-network-control-messages#getsporks\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">getsporks</code> message</a>.</p>\n<p>The <a href=\"core-ref-p2p-network-control-messages#spork\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">spork</code> message</a> tells the receiving peer the status of the spork defined by the SporkID field. Upon receiving a <span class=\"GlossaryItem-trigger\">spork</span> message, the client must verify the <span class=\"GlossaryItem-trigger\">signature</span> before accepting the spork message as valid.</p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<div class=\"rdmd-table\"><div class=\"rdmd-table-inner\"><table><thead><tr><th>Bytes</th><th>Name</th><th>Data type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>4</td><td>nSporkID</td><td>int</td><td>Required</td><td>ID assigned in spork.h</td></tr><tr><td>8</td><td>nValue</td><td>int64_t</td><td>Required</td><td>Value assigned to spork<br/>Default (disabled): <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">4000000000</code></td></tr><tr><td>8</td><td>nTimeSigned</td><td>int64_t</td><td>Required</td><td>Time the spork value was signed</td></tr><tr><td>66</td><td>vchSig</td><td>char[]</td><td>Required</td><td>Length (1 byte) + Signature (65 bytes)</td></tr></tbody></table></div></div>\n<p><strong>Active Sporks (per <a href=\"https://github.com/dashpay/dash/blob/v0.17.x/src/spork.h#L24\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">src/spork.h</code></a>)</strong></p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<div class=\"rdmd-table\"><div class=\"rdmd-table-inner\"><table><thead><tr><th style=\"text-align:center\">Spork ID</th><th style=\"text-align:center\">Num.</th><th>Name</th><th>Description</th></tr></thead><tbody><tr><td style=\"text-align:center\">10001</td><td style=\"text-align:center\">2</td><td><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">INSTANTSEND_ENABLED</code></td><td><strong><em>Updated in Dash Core 0.17.0</em></strong><br/>Turns InstantSend on and off network wide. Also determines if new mempool transactions should be locked or not.</td></tr><tr><td style=\"text-align:center\">10002</td><td style=\"text-align:center\">3</td><td><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">INSTANTSEND_BLOCK_</code><br/><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">FILTERING</code></td><td>Turns on and off InstantSend block filtering</td></tr><tr><td style=\"text-align:center\">10008</td><td style=\"text-align:center\">9</td><td><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">SUPERBLOCKS_ENABLED</code></td><td>Superblocks are enabled (10% of the block reward allocated to fund the dash treasury for funding approved proposals)</td></tr><tr><td style=\"text-align:center\">10016</td><td style=\"text-align:center\">17</td><td><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">SPORK_17_QUORUM_DKG_</code><br/><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">ENABLED</code></td><td>Enable long-living masternode quorum (LLMQ) distributed key generation (DKG). When enabled, simple PoSe  scoring and banning is active as well.</td></tr><tr><td style=\"text-align:center\">10018</td><td style=\"text-align:center\">19</td><td><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">SPORK_19_CHAINLOCKS_</code><br/><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">ENABLED</code></td><td>Enable LLMQ-based ChainLocks.</td></tr><tr><td style=\"text-align:center\">10020</td><td style=\"text-align:center\">21</td><td><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">SPORK_21_QUORUM_ALL_</code><br/><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">CONNECTED</code></td><td><strong><em>Added in Dash Core 0.16.0</em></strong><br/>Enable connections between all masternodes in a quorum to optimize the signature recovery process.<br/>Note: Prior to Dash Core 0.17.0 this spork also enforced <a href=\"core-guide-dash-features-proof-of-service#distributed-key-generation-participation-requirements\" target=\"\" title=\"\">PoSe requirements</a> for masternodes to support a minimum protocol version and maintain open ports.</td></tr><tr><td style=\"text-align:center\">10022</td><td style=\"text-align:center\">23</td><td><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">SPORK_23_QUORUM_POSE</code><br/><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">CONNECTED</code></td><td><strong>Added in Dash Core 0.17.0</strong><br/>Enforce <a href=\"core-guide-dash-features-proof-of-service#distributed-key-generation-participation-requirements\" target=\"\" title=\"\">PoSe requirements</a> for masternodes to support a minimum protocol version and maintain open ports.</td></tr></tbody></table></div></div>\n<blockquote class=\"callout callout_info\" theme=\"\ud83d\udcd8\"><h2 class=\"callout-heading\"><span class=\"callout-icon\">\ud83d\udcd8</span><p>Spork 2 Values</p></h2><p>As of Dash Core 0.17.0, spork 2 supports two different enabled values:</p><ul>\n<li><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">0</code> - Masternodes create locks for all transactions</li>\n<li><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">1</code> - Masternodes only create locks for transactions included in a block. Transactions in the mempool are not locked.</li>\n</ul><p>Mode 1 is only for use in the event of a sustained overload of InstantSend to ensure that ChainLocks can remain operational. See <a href=\"https://github.com/dashpay/dash/pull/4024\" target=\"\" title=\"\">PR 4024</a> for details.</p></blockquote>\n<blockquote class=\"callout callout_info\" theme=\"\ud83d\udcd8\"><h2 class=\"callout-heading\"><span class=\"callout-icon\">\ud83d\udcd8</span><p>Spork 21 and 23 Values</p></h2><p>Spork 21 and 23 support two different enabled values:</p><ul>\n<li><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">0</code> - The spork is active for all quorums regardless of quorum size.</li>\n<li><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">1</code> - The spork is active only for quorums which have a member size less than 100.</li>\n</ul><p>Mode 1 is only for use in the event of a sustained overload of InstantSend to ensure that ChainLocks can remain operational. See <a href=\"https://github.com/dashpay/dash/pull/4024\" target=\"\" title=\"\">PR 4024</a> for details.</p></blockquote>\n<p><strong>Removed Sporks</strong><br/>\nThe following sporks were used in the past but are no longer necessary and have been removed recently. To see sporks removed longer ago, please see the <a href=\"https://dashcore.readme.io/v0.16.0/docs/core-ref-p2p-network-control-messages#spork\" target=\"\" title=\"\">previous version of documentation</a>.</p>\n<blockquote class=\"callout callout_info\" theme=\"\ud83d\udcd8\"><h2 class=\"callout-heading\"><span class=\"callout-icon\">\ud83d\udcd8</span><p>Spork 6</p></h2><p>Since spork 6 was never enabled on mainnet, it was removed in Dash Core 0.16.0. The associated logic was hardened in <a href=\"https://github.com/dashpay/dash/pull/3662\" target=\"\" title=\"\">PR  3662</a> to support testnet (where it is enabled). If testnet is reset at some point in the future, the remaining logic will be removed.</p></blockquote>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<div class=\"rdmd-table\"><div class=\"rdmd-table-inner\"><table><thead><tr><th style=\"text-align:center\">Spork ID</th><th style=\"text-align:center\">Num.</th><th>Name</th><th>Description</th></tr></thead><tbody><tr><td style=\"text-align:center\"><em>10004</em></td><td style=\"text-align:center\"><em>5</em></td><td><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">INSTANTSEND_MAX_VALUE</code></td><td><em>Removed in Dash Core 0.15.0.<br/>Controls the max value for an InstantSend transaction (currently 2000 DASH)</em></td></tr><tr><td style=\"text-align:center\"><em>10005</em></td><td style=\"text-align:center\"><em>6</em></td><td><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">NEW_SIGS</code></td><td><em>Removed in Dash Core 0.16.0.<br/>Turns on and off new signature format for Dash-specific messages</em></td></tr><tr><td style=\"text-align:center\"><em>10011</em></td><td style=\"text-align:center\"><em>12</em></td><td><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">RECONSIDER_BLOCKS</code></td><td><em>Removed in Dash Core 0.15.0.<br/>Forces reindex of a specified number of blocks to recover from unintentional network forks</em></td></tr><tr><td style=\"text-align:center\"><em>10014</em></td><td style=\"text-align:center\"><em>15</em></td><td><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">DETERMINISTIC_MNS_</code><br/><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">ENABLED</code></td><td><em>Removed in Dash Core 0.16.0.<br/>Deterministic masternode lists are enabled</em></td></tr><tr><td style=\"text-align:center\"><em>10015</em></td><td style=\"text-align:center\"><em>16</em></td><td><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">INSTANTSEND_AUTOLOCKS</code></td><td><em>Removed in Dash Core 0.16.0.<br/>Automatic InstantSend for transactions with &lt;=4 inputs (also eliminates the special InstantSend fee requirement for these transactions)</em></td></tr><tr><td style=\"text-align:center\"><em>10019</em></td><td style=\"text-align:center\"><em>20</em></td><td><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">SPORK_20_INSTANTSEND_</code><br/><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">LLMQ_BASED</code></td><td><em>Removed in Dash Core 0.16.0.<br/>Enable LLMQ-based InstantSend.</em></td></tr><tr><td style=\"text-align:center\"><em>10021</em></td><td style=\"text-align:center\"><em>22</em></td><td><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">SPORK_22_PS_MORE_</code><br/><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">PARTICIPANTS</code></td><td><em>Removed in Dash Core 0.17.0</em><br/><em>Increase the maximum number of participants in CoinJoin sessions.</em></td></tr></tbody></table></div></div>\n<p>To verify <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">vchSig</code>, compare the hard-coded spork public key (<button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">strSporkPubKey</code> from <a href=\"https://github.com/dashpay/dash/blob/eaf90b77177efbaf9cbed46e822f0d794f1a0ee5/src/chainparams.cpp#L158\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">src/chainparams.cpp</code></a>) with the public key recovered from the <a href=\"core-ref-p2p-network-control-messages#spork\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">spork</code> message</a>&#x27;s hash and <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">vchSig</code> value (implementation details for Dash Core can be found in <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">CPubKey::RecoverCompact</code>). The hash is a double SHA-256 hash of:</p>\n<ul>\n<li>The spork magic message (<button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">&quot;DarkCoin Signed Message:\\n&quot;</code>)</li>\n<li>nSporkID + nValue + nTimeSigned</li>\n</ul>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<div class=\"rdmd-table\"><div class=\"rdmd-table-inner\"><table><thead><tr><th>Network</th><th>Spork Pubkey (wrapped)</th></tr></thead><tbody><tr><td>Mainnet</td><td>04549ac134f694c0243f503e8c8a9a986f5de6610049c40b07816809b0d1<br/>d06a21b07be27b9bb555931773f62ba6cf35a25fd52f694d4e1106ccd237<br/>a7bb899fdd</td></tr><tr><td>Testnet3</td><td>046f78dcf911fbd61910136f7f0f8d90578f68d0b3ac973b5040fb7afb50<br/>1b5939f39b108b0569dca71488f5bbf498d92e4d1194f6f941307ffd95f7<br/>5e76869f0e</td></tr><tr><td>RegTest</td><td>Undefined</td></tr><tr><td>Devnets</td><td>046f78dcf911fbd61910136f7f0f8d90578f68d0b3ac973b5040fb7afb50<br/>1b5939f39b108b0569dca71488f5bbf498d92e4d1194f6f941307ffd95f7<br/>5e76869f0e</td></tr></tbody></table></div></div>\n<p>The following annotated hexdump shows a <a href=\"core-ref-p2p-network-control-messages#spork\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">spork</code> message</a>.</p>\n<div class=\"CodeTabs CodeTabs_initial theme-light\"><div class=\"CodeTabs-toolbar\" role=\"tablist\"><button aria-selected=\"true\" class=\"CodeTabs_active\" role=\"tab\" type=\"button\">Text</button></div><div class=\"CodeTabs-inner\" role=\"tabpanel\"><pre><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang-text theme-light\" data-lang=\"text\" name=\"\" tabindex=\"0\">11270000 .................................... Spork ID: Spork 2 InstantSend enabled (10001)\n0000000000000000 ............................ Value (0)\n2478da5900000000 ............................ Epoch time: 2017-10-08 19:10:28 UTC (1507489828)\n\n41 .......................................... Signature length: 65\n\n1b6762d3e70890b5cfaed5d1fd72121c\nd32020c827a89f8128a00acd210f4ea4\n1b36c26c3767f8a24f48663e189865ed\n403ed1e850cdb4207cdd466419d9d183\n45 .......................................... Masternode Signature\n</code></pre></div></div>\n<h1 class=\"heading heading-1 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"verack\"></div><div class=\"heading-text\"><div id=\"section-verack\" class=\"heading-anchor_backwardsCompatibility\"></div>verack</div><a aria-label=\"Skip link to verack\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#verack\"></a></h1>\n<p>The <a href=\"core-ref-p2p-network-control-messages#verack\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">verack</code> message</a> acknowledges a previously-received <a href=\"core-ref-p2p-network-control-messages#version\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">version</code> message</a>, informing the connecting <span class=\"GlossaryItem-trigger\">node</span> that it can begin to send other messages. The <a href=\"core-ref-p2p-network-control-messages#verack\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">verack</code> message</a> has no payload; for an example of a message with no payload, see the <a href=\"core-ref-p2p-network-message-headers\" target=\"\" title=\"\">message headers section</a>.</p>\n<h1 class=\"heading heading-1 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"version\"></div><div class=\"heading-text\"><div id=\"section-version\" class=\"heading-anchor_backwardsCompatibility\"></div>version</div><a aria-label=\"Skip link to version\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#version\"></a></h1>\n<p>The <a href=\"core-ref-p2p-network-control-messages#version\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">version</code> message</a> provides information about the transmitting <span class=\"GlossaryItem-trigger\">node</span> to the receiving node at the beginning of a connection. Until both <span class=\"GlossaryItem-trigger\">peers</span> have exchanged <a href=\"core-ref-p2p-network-control-messages#version\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">version</code> messages</a>, no other messages will be accepted.</p>\n<p>If a <a href=\"core-ref-p2p-network-control-messages#version\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">version</code> message</a> is accepted, the receiving node should send a <a href=\"core-ref-p2p-network-control-messages#verack\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">verack</code> message</a>---but no node should send a <a href=\"core-ref-p2p-network-control-messages#verack\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">verack</code> message</a> before initializing its half of the connection by first sending a <a href=\"core-ref-p2p-network-control-messages#version\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">version</code> message</a>.</p>\n<p>Protocol version 70214 added a <span class=\"GlossaryItem-trigger\">masternode</span> authentication (challenge/response) system. Following the <a href=\"core-ref-p2p-network-control-messages#verack\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">verack</code> message</a>, masternodes should send a <a href=\"core-ref-p2p-network-masternode-messages#mnauth\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">mnauth</code> message</a> that signs the <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">mnauth_challenge</code> with their BLS operator key.</p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<div class=\"rdmd-table\"><div class=\"rdmd-table-inner\"><table><thead><tr><th>Bytes</th><th>Name</th><th>Data<br/>Type</th><th>Required/<br/>Optional</th><th>Description</th></tr></thead><tbody><tr><td>4</td><td>version</td><td>int32_t</td><td>Required</td><td>The highest protocol version understood by the transmitting node.  See the <a href=\"core-ref-p2p-network-protocol-versions\" target=\"\" title=\"\">protocol version section</a>.</td></tr><tr><td>8</td><td>services</td><td>uint64_t</td><td>Required</td><td>The services supported by the transmitting node encoded as a bitfield.  See the list of service codes below.</td></tr><tr><td>8</td><td>timestamp</td><td>int64_t</td><td>Required</td><td>The current Unix epoch time according to the transmitting node&#x27;s clock.  Because nodes will reject blocks with timestamps more than two hours in the future, this field can help other nodes to determine that their clock is wrong.</td></tr><tr><td>8</td><td>addr_recv services</td><td>uint64_t</td><td>Required</td><td><em>Added in protocol version 106.</em> <br/><br/>The services supported by the receiving node as perceived by the transmitting node.  Same format as the &#x27;services&#x27; field above. Dash Core will attempt to provide accurate information.</td></tr><tr><td>16</td><td>addr_recv IP address</td><td>char</td><td>Required</td><td><em>Added in protocol version 106.</em> <br/><br/>The IPv6 address of the receiving node as perceived by the transmitting node in <strong>big endian byte order</strong>. IPv4 addresses can be provided as <a href=\"http://en.wikipedia.org/wiki/IPv6#IPv4-mapped_IPv6_addresses\" target=\"\" title=\"\">IPv4-mapped IPv6 addresses</a>. Dash Core will attempt to provide accurate information.</td></tr><tr><td>2</td><td>addr_recv port</td><td>uint16_t</td><td>Required</td><td><em>Added in protocol version 106.</em> <br/><br/>The port number of the receiving node as perceived by the transmitting node in <strong>big endian byte order</strong>.</td></tr><tr><td>8</td><td>addr_trans services</td><td>uint64_t</td><td>Required</td><td>The services supported by the transmitting node.  Should be identical to the &#x27;services&#x27; field above.</td></tr><tr><td>16</td><td>addr_trans IP address</td><td>char</td><td>Required</td><td>The IPv6 address of the transmitting node in <strong>big endian byte order</strong>. IPv4 addresses can be provided as <a href=\"http://en.wikipedia.org/wiki/IPv6#IPv4-mapped_IPv6_addresses\" target=\"\" title=\"\">IPv4-mapped IPv6 addresses</a>.  Set to ::ffff:127.0.0.1 if unknown.</td></tr><tr><td>2</td><td>addr_trans port</td><td>uint16_t</td><td>Required</td><td>The port number of the transmitting node in <strong>big endian byte order</strong>.</td></tr><tr><td>8</td><td>nonce</td><td>uint64_t</td><td>Required</td><td>A random nonce which can help a node detect a connection to itself.  If the nonce is 0, the nonce field is ignored.  If the nonce is anything else, a node should terminate the connection on receipt of a <a href=\"core-ref-p2p-network-control-messages#version\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">version</code> message</a> with a nonce it previously sent.</td></tr><tr><td><em>Varies</em></td><td>user_agent bytes</td><td>compactSize uint</td><td>Required</td><td>Number of bytes in following user_agent field.  If 0x00, no user agent field is sent.</td></tr><tr><td><em>Varies</em></td><td>user_agent</td><td>string</td><td>Required if user_agent bytes &gt; 0</td><td><em>Renamed in protocol version 60000.</em> <br/><br/>User agent as defined by BIP14. Previously called subVer.<br/><br/>Dash Core limits the length to 256 characters.</td></tr><tr><td>4</td><td>start_height</td><td>int32_t</td><td>Required</td><td>The height of the transmitting node&#x27;s best block chain or, in the case of an SPV client, best block header chain.</td></tr><tr><td>1</td><td>relay</td><td>bool</td><td>Optional</td><td><em>Added in protocol version 70001 as described by BIP37.</em> <br/><br/>Transaction relay flag.  If 0x00, no <a href=\"core-ref-p2p-network-data-messages#inv\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">inv</code> messages</a> or <a href=\"core-ref-p2p-network-data-messages#tx\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">tx</code> messages</a> announcing new transactions should be sent to this client until it sends a <a href=\"core-ref-p2p-network-control-messages#filterload\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">filterload</code> message</a> or <a href=\"core-ref-p2p-network-control-messages#filterclear\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">filterclear</code> message</a>.  If the relay field is not present or is set to 0x01, this node wants <a href=\"core-ref-p2p-network-data-messages#inv\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">inv</code> messages</a> and <a href=\"core-ref-p2p-network-data-messages#tx\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">tx</code> messages</a> announcing new transactions.</td></tr><tr><td>32</td><td>mnauth_<br/>challenge</td><td>uint256</td><td>Optional</td><td><em>Added in protocol version 70214</em> <br/><br/>A challenge to be signed by the receiving masternode. The response is returned via a <a href=\"core-ref-p2p-network-masternode-messages#mnauth\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">mnauth</code> message</a> following the <a href=\"core-ref-p2p-network-control-messages#verack\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">verack</code> message</a>.</td></tr></tbody></table></div></div>\n<p>The following service identifiers have been assigned.</p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<div class=\"rdmd-table\"><div class=\"rdmd-table-inner\"><table><thead><tr><th>Value</th><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>0x00</td><td><em>Unnamed</em></td><td>This node is not a full node.  It may not be able to provide any data except for the transactions it originates.</td></tr><tr><td>0x01</td><td><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">NODE_NETWORK</code></td><td>This is a full node and can be asked for full blocks.  It should implement all protocol features available in its self-reported protocol version.</td></tr><tr><td>0x02</td><td><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">NODE_GETUTXO</code></td><td>This node is capable of responding to the getutxo protocol request. <em>Dash Core does not support this service.</em></td></tr><tr><td>0x04</td><td><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">NODE_BLOOM</code></td><td>This node is capable and willing to handle bloom-filtered connections.  Dash Core nodes used to support this by default, without advertising this bit, but no longer do as of protocol version 70201 (= NO_BLOOM_VERSION)</td></tr><tr><td>0x08</td><td><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">NODE_XTHIN</code></td><td>This node supports Xtreme Thinblocks. <em>Dash Core does not support this service.</em></td></tr><tr><td>0x400</td><td><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">NODE_NETWORK_LIMITED</code></td><td>This is the same as <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">NODE_NETWORK</code> with the limitation of only serving the last 288 blocks. <em>Not supported prior to Dash Core 0.16.0</em></td></tr></tbody></table></div></div>\n<p>The following annotated hexdump shows a <a href=\"core-ref-p2p-network-control-messages#version\" target=\"\" title=\"\"><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">version</code> message</a>. (The message header has been omitted and the actual IP addresses have been replaced with <a href=\"http://tools.ietf.org/html/rfc5737\" target=\"\" title=\"\">RFC5737</a> reserved IP addresses.)</p>\n<div class=\"CodeTabs CodeTabs_initial theme-light\"><div class=\"CodeTabs-toolbar\" role=\"tablist\"><button aria-selected=\"true\" class=\"CodeTabs_active\" role=\"tab\" type=\"button\">Text</button></div><div class=\"CodeTabs-inner\" role=\"tabpanel\"><pre><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang-text theme-light\" data-lang=\"text\" name=\"\" tabindex=\"0\">46120100 .................................... Protocol version: 70214\n0500000000000000 ............................ Services: NODE_NETWORK (1) + NODE_BLOOM (4)\n9c10ad5c00000000 ............................ Epoch time: 1554845852\n\n0100000000000000 ............................ Receiving node&#x27;s services\n00000000000000000000ffffc61b6409 ............ Receiving node&#x27;s IPv6 address\n270f ........................................ Receiving node&#x27;s port number\n\n0500000000000000 ............................ Transmitting node&#x27;s services\n00000000000000000000ffffcb0071c0 ............ Transmitting node&#x27;s IPv6 address\n270f ........................................ Transmitting node&#x27;s port number\n\n128035cbc97953f8 ............................ Nonce\n\n12 .......................................... Bytes in user agent string: 18\n2f4461736820436f72653a302e31322e312e352f..... User agent: /Dash Core:0.14.0/\n\n851f0b00 .................................... Start height: 76944\n01 .......................................... Relay flag: true\n\n5dbb5d1baade6a9afa34db708f72c0dd\nb5bd82b3656493484556689640a91357 ............ Masternode Auth. Challenge\n</code></pre></div></div>"
}