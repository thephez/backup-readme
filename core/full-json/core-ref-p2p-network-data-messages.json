{
 "metadata": {
  "image": [],
  "title": "Dash Data Messages",
  "description": "Data messages use inventories as unique identifiers for transactions and blocks. Inventories have a simple 36-byte structure."
 },
 "api": {
  "method": "get",
  "url": "",
  "auth": "required",
  "results": {
   "codes": [
    {
     "status": 200,
     "language": "json",
     "code": "{}",
     "name": ""
    },
    {
     "status": 400,
     "language": "json",
     "code": "{}",
     "name": ""
    }
   ]
  },
  "params": []
 },
 "next": {
  "description": "",
  "pages": [
   {
    "type": "doc",
    "icon": "file-text-o",
    "name": "Governance Messages",
    "slug": "core-ref-p2p-network-governance-messages",
    "category": "Core Reference"
   }
  ]
 },
 "title": "Data Messages",
 "icon": "",
 "updates": [],
 "type": "basic",
 "slug": "core-ref-p2p-network-data-messages",
 "excerpt": "",
 "body": "The following network messages all request or provide data related to transactions and blocks.\n\n![Overview Of P2P Protocol Data Request And Reply Messages](https://dash-docs.github.io/img/dev/en-p2p-data-messages.svg)\n\nMany of the data messages use <<glossary:inventories>> as unique identifiers for <<glossary:transactions>> and <<glossary:blocks>>.  Inventories have a simple 36-byte structure:\n\n| Bytes | Name            | Data Type | Description\n|-------|-----------------|-----------|-------------\n| 4     | type identifier | uint32_t  | The type of object which was hashed.  See list of type identifiers below.\n| 32    | hash            | char[32]  | SHA256(SHA256()) hash of the object in internal byte order.\n\nThe currently-available type identifiers are:\n\n| Type Identifier | Name                                                                          | Description\n|-----------------|-------------------------------------------------------------------------------|---------------\n| 1               | <<glossary:MSG_TX>>                                     | The hash is a TXID.\n| 2               | <<glossary:MSG_BLOCK>>                            | The hash is of a block header.\n| 3               | <<glossary:MSG_FILTERED_BLOCK>> | The hash is of a block header; identical to `MSG_BLOCK`. When used in a [`getdata` message](core-ref-p2p-network-data-messages#getdata), this indicates the response should be a [`merkleblock` message](core-ref-p2p-network-data-messages#merkleblock) rather than a [`block` message](core-ref-p2p-network-data-messages#block) (but this only works if a bloom filter was previously configured).  **Only for use in [`getdata` messages](core-ref-p2p-network-data-messages#getdata).**\n| 4               | <<glossary:MSG_LEGACY_TXLOCK_REQUEST>> | `MSG_TXLOCK_REQUEST` prior to Dash Core 0.15.0. The hash is an Instant Send transaction lock request. Transactions received this way are automatically converted to a standard [`tx` message](core-ref-p2p-network-data-messages#tx) as of Dash Core 0.15.0.\n| 6               | <<glossary:MSG_SPORK>>                            | The hash is Spork ID.\n| 16              | <<glossary:MSG_DSTX>>                              | The hash is CoinJoin Broadcast TX.\n| 17               | <<glossary:MSG_GOVERNANCE_OBJECT>>                                     | The hash is a Governance Object.\n| 18               | <<glossary:MSG_GOVERNANCE_OBJECT_VOTE>>                                     | The hash is a Governance Object Vote.\n| 20               | <<glossary:MSG_CMPCT_BLOCK>>                                     | The hash is of a block header; identical to `MSG_BLOCK`. When used in a [`getdata` message](core-ref-p2p-network-data-messages#getdata), this indicates the response should be a [`cmpctblock` message](core-ref-p2p-network-data-messages#cmpctblock). **Only for use in [`getdata` messages](core-ref-p2p-network-data-messages#getdata).**\n| 21               | <<glossary:MSG_QUORUM_FINAL_COMMITMENT>>                | The hash is a long-living masternode quorum final commitment.<br>_Added in 0.13.0_\n| 23               | <<glossary:MSG_QUORUM_CONTRIB>>                                     | The hash is a long-living masternode quorum contribution.<br>_Added in 0.14.0_\n| 24               | <<glossary:MSG_QUORUM_COMPLAINT>>                                     | The hash is a long-living masternode quorum complaint.<br>_Added in 0.14.0_\n| 25               | <<glossary:MSG_QUORUM_JUSTIFICATION>>                   | The hash is a long-living masternode quorum justification.<br>_Added in 0.14.0_\n| 26               | <<glossary:MSG_QUORUM_PREMATURE_COMMITMENT>>    | The hash is a long-living masternode quorum premature commitment.<br>_Added in 0.14.0_\n| 28               | <<glossary:MSG_QUORUM_RECOVERED_SIG>>                        | The hash is a long-living masternode quorum recovered signature. <br><br>**Note**: Only relayed to other masternodes in the same quorum and nodes that have sent a [`qwatch` message](core-ref-p2p-network-quorum-messages#qwatch) as of Dash Core 0.17.0<br>_Added in 0.14.0_\n| 29               | <<glossary:MSG_CLSIG>>                                     | The hash is a ChainLock signature.<br>_Added in 0.14.0_\n| 30               | <<glossary:MSG_ISLOCK>>                                   | The hash is an LLMQ-based InstantSend lock ([DIP10](https://github.com/dashpay/dips/blob/master/dip-0010.md)).<br>_Added in 0.14.0_\n| 31               | <<glossary:MSG_ISDLOCK>>                                   | The hash is an LLMQ-based deterministic InstantSend lock ([DIP22](https://github.com/dashpay/dips/blob/master/dip-0022.md)).<br>_Added in 18.0_\n\n\n**Deprecated Type Identifiers**\n\nThe following type identifiers have been deprecated recently. To see type identifiers removed longer ago, please see the [previous version of documentation](https://dashcore.readme.io/v0.16.0/docs/core-ref-p2p-network-data-messages).\n\n| Type Identifier | Name                                                                          | Description\n|-----------------|-------------------------------------------------------------------------------|---------------\n| 5               | <<glossary:MSG_TXLOCK_VOTE>>          | **Deprecated in 0.15.0**<br><br>The hash is an Instant Send transaction vote.\n\nType identifier zero and type identifiers greater than those shown in the table above are reserved for future implementations. Dash Core ignores all inventories with one of these unknown types.\n\n# block\n\nThe [`block` message](core-ref-p2p-network-data-messages#block) transmits a single <<glossary:serialized block>> in the format described in the [serialized blocks section](core-ref-block-chain-serialized-blocks). See that section for an example hexdump.  It can be sent for two different reasons:\n\n1. **GetData Response:** Nodes will always send it in response to a [`getdata` message](core-ref-p2p-network-data-messages#getdata) that requests the block with an <<glossary:inventory>> type of `MSG_BLOCK` (provided the node has that block available for relay).\n\n2. **Unsolicited:** Some miners will send unsolicited [`block` messages](core-ref-p2p-network-data-messages#block) broadcasting their newly-mined blocks to all of their <<glossary:peers>>. Many <<glossary:mining>> pools do the same thing, although some may be misconfigured to send the block from multiple nodes, possibly sending the same block to some peers more than once.\n\n# blocktxn\n\n*Added in protocol version 70209 of Dash Core as described by BIP152*\n\nThe [`blocktxn` message](core-ref-p2p-network-data-messages#blocktxn) sends requested <<glossary:block>> <<glossary:transactions>> to a node which previously requested them with a [`getblocktxn` message](core-ref-p2p-network-data-messages#getblocktxn). It is defined as a message containing a serialized `BlockTransactions` message.\n\nUpon receipt of a properly-formatted requested [`blocktxn` message](core-ref-p2p-network-data-messages#blocktxn), <<glossary:nodes>> should:\n\n1. Attempt to reconstruct the full block by taking the prefilledtxn transactions from the original [`cmpctblock` message](core-ref-p2p-network-data-messages#cmpctblock) and placing them in the marked positions\n2. For each short transaction ID from the original [`cmpctblock` message](core-ref-p2p-network-data-messages#cmpctblock), in order, find the corresponding transaction (from either the [`blocktxn` message](core-ref-p2p-network-data-messages#blocktxn) or from other sources)\n3. Place each short transaction ID in the first available position in the block\n4. Once the block has been reconstructed, it shall be processed as normal.\n\n**Short transaction IDs are expected to occasionally collide. Nodes must not be penalized for such collisions.**\n\nThe structure of `BlockTransactions` is defined below.\n\n| Bytes    | Name                 | Data Type            | Encoding | Description|\n|----------|----------------------|----------------------|----------|------------|\n| 32       | blockhash            | Binary blob          | The output from a double-SHA256 of the block header, as used elsewhere | The blockhash of the block which the transactions being provided are in\n| 1 or 3   | transactions<br>_length | CompactSize          | As used to encode array lengths elsewhere | The number of transactions provided\n| *Varies* | transactions         | List of transactions | As encoded in [`tx` messages](core-ref-p2p-network-data-messages#tx) in response to `getdata MSG_TX` | The transactions provided\n\nThe following annotated hexdump shows a [`blocktxn` message](core-ref-p2p-network-data-messages#blocktxn).  (The message header has been omitted.)\n\n``` text\n182327cb727da7d60541da793831fd0ab0509e79c8cd\n3d654cdf3a0100000000 ....................... Block Hash\n\n01 ......................................... Transactions Provided: 1\n\nTransaction(s)\n| Transaction 1\n| | 01000000 ................................ Transaction Version: 1\n| | 01 ...................................... Input count: 1\n| |\n| | Transaction input #1\n| | |\n| | | 0952617a516d956e2ecee71a6adc249f\n| | | 4bb757adcc409452ab98c8e55c31e62a ..... Outpoint TXID\n| | | 00000000 ............................. Outpoint index number: 0\n| | |\n| | | 6b ................................... Bytes in sig. script: 107\n| | | 483045022100d10edf447252e1e69ff1\n| | | 77330bb2c889a50be02e00cc5d79c0d0\n| | | 79ae56518fc40220245d36905dc950fc\n| | | d55694cfde8cde3109dc80b12aca3a6e\n| | | 332033802ee36e1b01210272cc6e7660\n| | | 2648831d8e80fca8eb24369cd0f23ff0\n| | | 79cf20ae9d9beee05de6db ............... Secp256k1 signature\n| | |\n| | | ffffffff ............................. Sequence number: UINT32_MAX\n| |\n| | 02 ..................................... Number of outputs: 02\n| |\n| | Transaction output #1\n| | | 0be0f50500000000 ..................... Duffs (0.99999755 Dash)\n| | |\n| | | 19 ................................... Bytes in pubkey script: 25\n| | | | 76 ................................. OP_DUP\n| | | | a9 ................................. OP_HASH160\n| | | | 14 ................................. Push 20 bytes as data\n| | | | | 923d91ed359f650eec6ea8b9030b340d\n| | | | | ea63d590 ......................... PubKey hash\n| | | | 88 ................................. OP_EQUALVERIFY\n| | | | ac ................................. OP_CHECKSIG\n| |\n| | [...] .................................. 1 more tx output omitted\n| |\n| | 00000000 ............................... locktime: 0 (a block height)\n```\n\n# cfcheckpt\n\n*Added in protocol version 70223 of Dash Core as described by [BIP 157](https://github.com/bitcoin/bips/blob/master/bip-0157.mediawiki).*\n\nThe [`cfcheckpt` message](core-ref-p2p-network-data-messages#cfcheckpt)  is sent in response to the [`getcfcheckpt` message](core-ref-p2p-network-data-messages#getcfcheckpt).  The filter headers included are the set of all filter headers on the requested chain where the height is a positive multiple of 1,000.\n\n| Bytes    | Name                 | Data Type        | Description\n|----------|----------------------|------------------|----------------\n| 1 | filter_type | uint8_t | Filter type for which headers are requested. Should match the field in the [`getcfcheckpt` message](core-ref-p2p-network-data-messages#getcfcheckpt) being responded to.\n| 32 | stop_hash | uint256 | The hash of the last block in the requested range. Should match the field in the [`getcfcheckpt` message](core-ref-p2p-network-data-messages#getcfcheckpt) being responded to.\n| 1-3 | filter_headers<br>_length | CompactSize | The length of the following vector of filter headers\n| `filter_headers`<br>`_length` * 32 | filter_hashes | [][32]byte | The filter headers at intervals of 1,000\n\n# cfheaders\n\n*Added in protocol version 70223 of Dash Core as described by [BIP 157](https://github.com/bitcoin/bips/blob/master/bip-0157.mediawiki).*\n\nThe [`cfheaders` message](core-ref-p2p-network-data-messages#cfheaders)  is sent in response to the [`getcfheaders` message](core-ref-p2p-network-data-messages#getcfheaders). Instead of including the filter headers themselves, the response includes one filter header and a sequence of filter hashes, from which the headers can be derived. This has the benefit that the client can verify the binding links between the headers.\n\n| Bytes    | Name                 | Data Type        | Description\n|----------|----------------------|------------------|----------------\n| 1 | filter_type | uint8_t | Filter type for which headers are requested. Should match the field in the [`getcfheaders` message](core-ref-p2p-network-data-messages#getcfheaders) being responded to.\n| 32 | stop_hash | uint256 | The hash of the last block in the requested range. Should match the field in the [`getcfheaders` message](core-ref-p2p-network-data-messages#getcfheaders) being responded to.\n| 32 | previous_filter<br>_header | uint256 | The filter header preceding the first block in the requested range\n| 1-3 | filter_hashes<br>_length | CompactSize | The length of the following vector of filter hashes. Must not be > 2000.\n| `filter_hashes`<br>`_length` * 32 | filter_hashes | [][32]byte | The filter hashes for each block in the requested range\n\n# cfilter\n\n*Added in protocol version 70223 of Dash Core as described by [BIP 157](https://github.com/bitcoin/bips/blob/master/bip-0157.mediawiki).*\n\nThe [`cfilter` message](core-ref-p2p-network-data-messages#cfilter)  is sent in response to the [`getcfilters` message](core-ref-p2p-network-data-messages#getcfilters), one for each block in the requested range.\n\n| Bytes    | Name                 | Data Type        | Description\n|----------|----------------------|------------------|----------------\n| 1 | filter_type | uint8_t | Filter type for which headers are requested. Should match the field in the [`getcfilters` message](core-ref-p2p-network-data-messages#getcfilters) being responded to.\n| 32 | block_hash | uint256 | Block hash of the block for which the filter is being returned. Must correspond to a block that is an ancestor of the request's `stop_hash` with a height >= `start_height`.\n| 1-5 | num_filter_bytes | CompactSize | A variable length integer representing the size of the filter in the following field\n| `num_filter_bytes` | filter_bytes |  []bytes | The  serialized compact filter for this block\n\n\n# cmpctblock\n\n*Added in protocol version 70209 of Dash Core as described by BIP152*\n\nThe [`cmpctblock` message](core-ref-p2p-network-data-messages#cmpctblock) is a reply to a [`getdata` message](core-ref-p2p-network-data-messages#getdata) which requested a <<glossary:block>> using the <<glossary:inventory>> type `MSG_CMPCT_BLOCK`. If the requested block was recently announced and is close to the tip of the best chain of the receiver and after having sent the requesting <<glossary:peer>> a [`sendcmpct` message](core-ref-p2p-network-control-messages#sendcmpct), nodes respond with a [`cmpctblock` message](core-ref-p2p-network-data-messages#cmpctblock) containing data for the block.\n\n**If the requested block is too old, the node responds with a *full non-compact block***\n\nUpon receipt of a [`cmpctblock` message](core-ref-p2p-network-data-messages#cmpctblock), after sending a [`sendcmpct` message](core-ref-p2p-network-control-messages#sendcmpct), nodes should calculate the short transaction ID for each <<glossary:unconfirmed transaction>> they have available (i.e. in their mempool) and compare each to each short transaction ID in the [`cmpctblock` message](core-ref-p2p-network-data-messages#cmpctblock). After finding already-available transactions, nodes which do not have all transactions available to reconstruct the full block should request the missing transactions using a [`getblocktxn` message](core-ref-p2p-network-data-messages#getblocktxn).\n\nA node must not send a [`cmpctblock` message](core-ref-p2p-network-data-messages#cmpctblock) unless they are able to respond to a [`getblocktxn` message](core-ref-p2p-network-data-messages#getblocktxn) which requests every transaction in the block. A node must not send a [`cmpctblock` message](core-ref-p2p-network-data-messages#cmpctblock) without having validated that the <<glossary:header>> properly commits to each transaction in the block, and properly builds on top of the existing, fully-validated chain with a valid proof-of-work either as a part of the current most-work valid chain, or building directly on top of it. A node may send a [`cmpctblock` message](core-ref-p2p-network-data-messages#cmpctblock) before validating that each transaction in the block validly spends existing UTXO set entries.\n\nThe [`cmpctblock` message](core-ref-p2p-network-data-messages#cmpctblock) contains a vector of `PrefilledTransaction` whose structure is defined below. A `PrefilledTransaction` is used in `HeaderAndShortIDs` to provide a list of a few transactions explicitly.\n\n| Bytes    | Name                 | Data Type            | Encoding | Description|\n|----------|----------------------|----------------------|----------|------------|\n| 1 or 3   | index                | CompactSize          | Compact Size, differentially encoded since the last PrefilledTransaction in a list | The index into the block at which this transaction is\n| *Varies* | tx                   | Transaction          | As encoded in [`tx` messages](core-ref-p2p-network-data-messages#tx) sent in response to `getdata MSG_TX` | Transaction which is in the block at index `index`\n\nThe [`cmpctblock` message](core-ref-p2p-network-data-messages#cmpctblock) is compromised of a serialized `HeaderAndShortIDs` structure which is defined below. A `HeaderAndShortIDs` structure is used to relay a block header, the short transactions IDs used for matching already-available transactions, and a select few transactions which we expect a peer may be missing.\n\n| Bytes    | Name                 | Data Type            | Encoding | Description|\n|----------|----------------------|----------------------|----------|------------|\n| 80       | header               | Block header         | First 80 bytes of the block as defined by the encoding used by [`block` messages](core-ref-p2p-network-data-messages#block) | The header of the block being provided\n| 8        | nonce                | uint64_t             | Little Endian | A nonce for use in short transaction ID calculations\n| 1 or 3   | shortids_<br>length  | CompactSize          | As used to encode array lengths elsewhere | The number of short transaction IDs in `shortids` (i.e. block tx count - `prefilledtxn`<br>`_length`)\n| *Varies* | shortids  | List of 6-byte integers | Little Endian | The short transaction IDs calculated from the transactions which were not provided explicitly in `prefilledtxn`\n| 1 or 3   | prefilledtxn<br>_length | CompactSize       | As used to encode array lengths elsewhere | The number of prefilled transactions in `prefilledtxn` (i.e. block tx count - `shortids`<br>`_length`)\n| *Varies* | prefilledtxn     | List of Prefilled<br>Transactions | As defined by `Prefilled`<br>`Transaction` definition below | Used to provide the coinbase transaction and a select few which we expect a peer may be missing\n\n## **Short Transaction ID calculation**\n\nShort transaction IDs are used to represent a transaction without sending a full 256-bit hash. They are calculated as follows,\n\n* A single-SHA256 hashing the <<glossary:block header>> with the nonce appended (in little-endian)\n* Running SipHash-2-4 with the input being the transaction ID and the keys (k0/k1) set to the first two little-endian 64-bit integers from the above hash, respectively.\n* Dropping the 2 most significant bytes from the SipHash output to make it 6 bytes.\n\nThe following annotated hexdump shows a [`cmpctblock` message](core-ref-p2p-network-data-messages#cmpctblock). (The message header has been omitted.)\n\n``` text\n00000020981178a4342cec6316296b2ad84c9b7cdf9f\n2688e5d0fe1a0003cd0000000000f64870f52a3d0125\n1336c9464961216732b25fbf288a51f25a0e81bffb20\ne9600194d85a64a50d1cc02b0181 ................ Block Header\n\n3151b67e5b418b9d ............................ Nonce\n\n01 .......................................... Short IDs Length: 1\n483edcd3c799 ................................ Short IDs\n\n01 .......................................... Prefilled Transaction Length: 1\n\nPrefilled Transactions\n| 00 ........................................ Index: 0\n|\n| Transaction 1 (Coinbase)\n| | 01000000 ................................ Transaction Version: 1\n| | 01 ...................................... Input count: 1\n| |\n| | Transaction input #1\n| | |\n| | | 00000000000000000000000000000000\n| | | 00000000000000000000000000000000 ..... Outpoint TXID\n| | | ffffffff ............................. Outpoint index number: UINT32_MAX\n| | |\n| | | 13 ................................... Bytes in sig. script: 19\n| | | 03daaf010e2f5032506f6f6c2d74444153482f Secp256k1 signature\n| | |\n| | | ffffffff ............................. Sequence number: UINT32_MAX\n| |\n| | 04 ..................................... Number of outputs: 04\n| |\n| | Transaction output #1\n| | | ffe5654200000000 ..................... Duffs (11.13974271 Dash)\n| | |\n| | | 19 ................................... Bytes in pubkey script: 25\n| | | | 76 ................................. OP_DUP\n| | | | a9 ................................. OP_HASH160\n| | | | 14 ................................. Push 20 bytes as data\n| | | | | b885cb21ad12e593c1a46d814df47ccb\n| | | | | 450a7d84 ......................... PubKey hash\n| | | | 88 ................................. OP_EQUALVERIFY\n| | | | ac ................................. OP_CHECKSIG\n| |\n| | [...] .................................. 3 more tx outputs omitted\n| |\n| | 00000000 ............................... locktime: 0 (a block height)\n```\n\n# getblocks\n\nThe [`getblocks` message](core-ref-p2p-network-data-messages#getblocks) requests an [`inv` message](core-ref-p2p-network-data-messages#inv) that provides <<glossary:block header>> hashes starting from a particular point in the <<glossary:block chain>>. It allows a <<glossary:peer>> which has been disconnected or started for the first time to get the data it needs to request the blocks it hasn't seen.\n\nPeers which have been disconnected may have <<glossary:stale blocks>> in their locally-stored block chain, so the [`getblocks` message](core-ref-p2p-network-data-messages#getblocks) allows the requesting peer to provide the receiving peer with multiple <<glossary:header>> hashes at heights on their local chain. This allows the receiving peer to find, within that list, the last header hash they had in common and reply with all subsequent header hashes.\n\n**Note:** the receiving peer itself may respond with an [`inv` message](core-ref-p2p-network-data-messages#inv) containing header hashes of stale blocks.  It is up to the requesting peer to poll all of its peers to find the best block chain.\n\nIf the receiving peer does not find a common header hash within the list, it will assume the last common block was the <<glossary:genesis block>> (block zero), so it will reply with in [`inv` message](core-ref-p2p-network-data-messages#inv) containing header hashes starting with block one (the first block after the genesis block).\n\n| Bytes    | Name                 | Data Type        | Description\n|----------|----------------------|------------------|----------------\n| 4        | version              | uint32_t         | The protocol version number; the same as sent in the [`version` message](core-ref-p2p-network-control-messages#version).\n| *Varies* | hash count           | compactSize uint | The number of header hashes provided not including the stop hash.  There is no limit except that the byte size of the entire message must be below the [`MAX_SIZE`](https://github.com/dashpay/dash/blob/v0.15.x/src/serialize.h#L29) limit; typically from 1 to 200 hashes are sent.\n| *Varies* | block header hashes  | char[32]         | One or more block header hashes (32 bytes each) in internal byte order.  Hashes should be provided in reverse order of block height, so highest-height hashes are listed first and lowest-height hashes are listed last.\n| 32       | stop hash            | char[32]         | The header hash of the last header hash being requested; set to all zeroes to request an [`inv` message](core-ref-p2p-network-data-messages#inv) with all subsequent header hashes (a maximum of 500 will be sent as a reply to this message; if you need more than 500, you will need to send another [`getblocks` message](core-ref-p2p-network-data-messages#getblocks) with a higher-height header hash as the first entry in block header hash field).\n\nThe following annotated hexdump shows a [`getblocks` message](core-ref-p2p-network-data-messages#getblocks).  (The message header has been omitted.)\n\n``` text\n71110100 ........................... Protocol version: 70001\n02 ................................. Hash count: 2\n\nd39f608a7775b537729884d4e6633bb2\n105e55a16a14d31b0000000000000000 ... Hash #1\n\n5c3e6403d40837110a2e8afb602b1c01\n714bda7ce23bea0a0000000000000000 ... Hash #2\n\n00000000000000000000000000000000\n00000000000000000000000000000000 ... Stop hash\n```\n\n# getblocktxn\n\n*Added in protocol version 70209 of Dash Core as described by BIP152*\n\nThe [`getblocktxn` message](core-ref-p2p-network-data-messages#getblocktxn) requests a [`blocktxn` message](core-ref-p2p-network-data-messages#blocktxn) for any transactions that it has not seen after a compact block is received. It is defined as a message containing a serialized `BlockTransactionsRequest` message. Upon receipt of a properly-formatted [`getblocktxn` message](core-ref-p2p-network-data-messages#getblocktxn), <<glossary:nodes>> which recently provided the sender of such a message with a [`cmpctblock` message](core-ref-p2p-network-data-messages#cmpctblock) for the block hash identified in this message must respond with either an appropriate [`blocktxn` message](core-ref-p2p-network-data-messages#blocktxn), or a full block message.\n\nA [`blocktxn` message](core-ref-p2p-network-data-messages#blocktxn) response must contain exactly and only each transaction which is present in the appropriate block at the index specified in the [`getblocktxn` message](core-ref-p2p-network-data-messages#getblocktxn) indexes list, in the order requested.\n\nThe structure of `BlockTransactionsRequest` is defined below.\n\n| Bytes    | Name            | Data Type            | Description|\n|----------|-----------------|----------------------|----------|------|\n| 32       | blockhash       | Binary blob          | The output from a double-SHA256 of the block header, as used elsewhere | The blockhash of the block which the transactions being requested are in\n| *Varies* | indexes_length  | CompactSize uint     | As used to encode array lengths elsewhere | The number of transactions requested\n| *Varies* | indexes         | CompactSize uint[]   | Differentially encoded | Vector of compactSize containing the indexes of the transactions being requested in the block.\n\nThe following annotated hexdump shows a [`getblocktxn` message](core-ref-p2p-network-data-messages#getblocktxn).  (The message header has been omitted.)\n\n``` text\n182327cb727da7d60541da793831fd0a\nb0509e79c8cd3d654cdf3a0100000000 ... Block Hash\n\n01 ................................. Index length: 1\n01 ................................. Index: 1\n```\n\n# getcfcheckpt\n\n*Added in protocol version 70223 of Dash Core as described by [BIP 157](https://github.com/bitcoin/bips/blob/master/bip-0157.mediawiki).*\n\nThe [`getcfcheckpt` message](core-ref-p2p-network-data-messages#getcfcheckpt) requests verifiable filter headers for a range of blocks. The response to this message is a [`cfcheckpt` message](core-ref-p2p-network-data-messages#cfcheckpt).\n\n| Bytes    | Name                 | Data Type        | Description\n|----------|----------------------|------------------|----------------\n| 1 | filter_type | uint8_t | Filter type for which headers are requested\n| 32 | stop_hash | uint256 | The hash of the last block in the requested range\n\n# getcfheaders\n\n*Added in protocol version 70223 of Dash Core as described by [BIP 157](https://github.com/bitcoin/bips/blob/master/bip-0157.mediawiki).*\n\nThe [`getcfheaders` message](core-ref-p2p-network-data-messages#getcfheaders) requests verifiable filter headers for a range of blocks. The response to this message is a [`cfheaders` message](core-ref-p2p-network-data-messages#cfheaders).\n\n| Bytes    | Name                 | Data Type        | Description\n|----------|----------------------|------------------|----------------\n| 1 | filter_type | uint8_t | Filter type for which headers are requested\n| 4 | start_height | uint32_t | The height of the first block in the requested range\n| 32 | stop_hash | uint256 | The hash of the last block in the requested range. Must be >= `start_height` and the difference between them must be less than 2000.\n\n\n# getcfilters\n\n*Added in protocol version 70223 of Dash Core as described by [BIP 157](https://github.com/bitcoin/bips/blob/master/bip-0157.mediawiki).*\n\nThe [`getcfilters` message](core-ref-p2p-network-data-messages#getcfilters) requests compact filters of a particular type for a particular range of blocks. The response to this message is a [`cfilter` message](core-ref-p2p-network-data-messages#cfilter).\n\n| Bytes    | Name                 | Data Type        | Description\n|----------|----------------------|------------------|----------------\n| 1 | filter_type | uint8_t | Filter type for which headers are requested\n| 4 | start_height | uint32_t | The height of the first block in the requested range\n| 32 | stop_hash | uint256 | The hash of the last block in the requested range\n\n# getdata\n\nThe [`getdata` message](core-ref-p2p-network-data-messages#getdata) requests one or more data objects from another <<glossary:node>>. The objects are requested by an inventory, which the requesting node typically previously received by way of an [`inv` message](core-ref-p2p-network-data-messages#inv).\n\nThe response to a [`getdata` message](core-ref-p2p-network-data-messages#getdata) can be a [`tx` message](core-ref-p2p-network-data-messages#tx), [`block` message](core-ref-p2p-network-data-messages#block), [`merkleblock` message](core-ref-p2p-network-data-messages#merkleblock), [`dstx` message](core-ref-p2p-network-privatesend-messages#dstx), [`govobj` message](core-ref-p2p-network-governance-messages#govobj), [`govobjvote` message](core-ref-p2p-network-governance-messages#govobjvote), [`notfound` message](core-ref-p2p-network-data-messages#notfound), [`cmpctblock` message](core-ref-p2p-network-data-messages#cmpctblock), or any other messages that are exchanged by way of [`inv` messages](core-ref-p2p-network-data-messages#inv).\n\nThis message cannot be used to request arbitrary data, such as historic transactions no longer in the memory pool or relay set. Full nodes may not even be able to provide older <<glossary:blocks>> if they've pruned old transactions from their block database. For this reason, the [`getdata` message](core-ref-p2p-network-data-messages#getdata) should usually only be used to request data from a node which previously advertised it had that data by sending an [`inv` message](core-ref-p2p-network-data-messages#inv).\n\nThe format and maximum size limitations of the [`getdata` message](core-ref-p2p-network-data-messages#getdata) are identical to the [`inv` message](core-ref-p2p-network-data-messages#inv); only the message header differs.\n\n# getheaders\n\n*Added in protocol version 70077.*\n\nThe [`getheaders` message](core-ref-p2p-network-data-messages#getheaders) requests a [`headers` message](core-ref-p2p-network-data-messages#headers) that provides block headers starting from a particular point in the <<glossary:block chain>>. It allows a <<glossary:peer>> which has been disconnected or started for the first time to get the <<glossary:headers>> it hasn\u2019t seen yet.\n\nThe [`getheaders` message](core-ref-p2p-network-data-messages#getheaders) is nearly identical to the [`getblocks` message](core-ref-p2p-network-data-messages#getblocks), with one minor difference: the `inv` reply to the [`getblocks` message](core-ref-p2p-network-data-messages#getblocks) will include no more than 500 <<glossary:block header>> hashes; the `headers` reply to the [`getheaders` message](core-ref-p2p-network-data-messages#getheaders) will include as many as 2,000 block headers.\n\n\n| Bytes    | Name                 | Data Type        | Description\n|----------|----------------------|------------------|----------------\n| 4        | version              | uint32_t         | The protocol version number; the same as sent in the [`version` message](core-ref-p2p-network-control-messages#version).\n| *Varies* | hash count           | compactSize uint | The number of header hashes provided not including the stop hash.\n| *Varies* | block header hashes  | char[32]         | One or more block header hashes (32 bytes each) in internal byte order.  Hashes should be provided in reverse order of block height, so highest-height hashes are listed first and lowest-height hashes are listed last.\n| 32       | stop hash            | char[32]         | The header hash of the last header hash being requested; set to all zeroes to request as many blocks as possible (2000).\n\n# getheaders2\n\n*Added in protocol version 70223 of Dash Core.*\n\nThe [`getheaders2` message](core-ref-p2p-network-data-messages#getheaders2) requests a [`headers2` message](core-ref-p2p-network-data-messages#headers2) that provides block headers starting from a particular point in the <<glossary:block chain>>. It allows a <<glossary:peer>> which has been disconnected or started for the first time to get the <<glossary:headers>> it hasn\u2019t seen yet.\n\nThe [`getheaders2` message](core-ref-p2p-network-data-messages#getheaders2) contains the same fields as the [`getheaders` message](core-ref-p2p-network-data-messages#getheaders).\n\n# getmnlistd\n\n*Added in protocol version 70213*\n\nThe [`getmnlistd` message](core-ref-p2p-network-data-messages#getmnlistd) requests a [`mnlistdiff` message](core-ref-p2p-network-data-messages#mnlistdiff) that provides either:\n\n  1. A full <<glossary:masternode>> list (if `baseBlockHash` is all-zero)\n  2. An update to a previously requested masternode list\n\n| Bytes | Name | Data type | Required | Description |\n| ---------- | ----------- | --------- | -------- | -------- |\n| 32 | baseBlockHash | uint256 | Required | Hash of a block the requester already has a valid masternode list of.<br>_Note: Can be all-zero to indicate that a full masternode list is requested._\n| 32 | blockHash | uint256 | Required | Hash of the block for which the masternode list diff is requested\n\nThe following annotated hexdump shows a [`getmnlistd` message](core-ref-p2p-network-data-messages#getmnlistd). (The message header has been omitted.)\n\n``` text\n000001ee5108348a2c59396da29dc576\n9b2a9bb303d7577aee9cd95136c49b9b ........... Base block hash\n\n0000030f51f12e7069a7aa5f1bc9085d\ndb3fe368976296fd3b6d73fdaf898cc0 ........... Block hash\n```\n\n# getqrinfo\n\n*Added in protocol version 70222 of Dash Core.*\n\nThe `getqrinfo` message requests a [`qrinfo` message](core-ref-p2p-network-data-messages#qrinfo) that provides the information required to verify quorum details for quorums formed using the quorum rotation process.\n\n| Bytes | Name | Data type | Required | Description |\n| ---------- | ----------- | --------- | -------- | -------- |\n| 4 | baseBlockHashesNb | uint32 | Required | Number of masternode lists the light client already knows (up to 4)\n| Varies | baseBlockHashes | uint256[] | Required | Array of base block hashes for the masternode lists the light client already knows\n| 32 | blockRequestHash | uint256 | Required | Hash of the block for which the masternode list diff is requested\n| 1 | extraShare | bool | Optional | Flag to indicate if an extra share is requested |\n\nThe following annotated hexdump shows a [`getqrinfo` message](core-ref-p2p-network-data-messages#getqrinfo). (The message header has been omitted.)\n\n``` text\n05 ................................. Number of base block hashes: 5\n\n\ncb6f9b4f2145f2e3fcf270737ad34d7e\n51cdb9e98f2580927c52b35f62010000 ... Base block hash 1\n8cfa868eb5adfdfb6ae333b790980f2d\n0737c64ccd716ce6b63969f481010000 ... Base block hash 2\n41e452b5187bc71a1e92c42c8e38f04b\n8c83b12415f7a73b292f5c79c9000000 ... Base block hash 3\n0387850f96fb9888bb445cce15b56603\n019df551c246e237ff3a6107e8020000 ... Base block hash 4\n7ab87c8f16f60fdba20102d348a0af08\n2a6590759c6535aa48941e807e020000 ... Base block hash 5\n\nd7b9d67da4a3016c62fcc37157032126\n46d11c2b3c533ccf9bb56f7540000000 ... Block request hash\n\n00 ................................. Extra share: false\n```\n\n\n# headers\n\n*Added in protocol version 31800 (of Bitcoin).*\n\nThe [`headers` message](core-ref-p2p-network-data-messages#headers) sends block headers to a <<glossary:node>> which previously requested certain <<glossary:headers>> with a [`getheaders` message](core-ref-p2p-network-data-messages#getheaders). A headers message can be empty.\n\n| Bytes    | Name    | Data Type        | Description\n|----------|---------|------------------|-----------------\n| *Varies* | count   | compactSize uint | Number of block headers up to a maximum of 2,000.  Note: headers-first sync assumes the sending node will send the maximum number of headers whenever possible.\n| *Varies* | headers | block_header     | Block headers: each 80-byte block header is in the format described in the [block headers section](core-ref-block-chain-block-headers) with an additional 0x00 suffixed.  This 0x00 is called the transaction count, but because the headers message doesn't include any transactions, the transaction count is always zero.\n\nThe following annotated hexdump shows a [`headers` message](core-ref-p2p-network-data-messages#headers).  (The message header has been omitted.)\n\n``` text\n01 ................................. Header count: 1\n\n02000000 ........................... Block version: 2\nb6ff0b1b1680a2862a30ca44d346d9e8\n910d334beb48ca0c0000000000000000 ... Hash of previous block's header\n9d10aa52ee949386ca9385695f04ede2\n70dda20810decd12bc9b048aaab31471 ... Merkle root\n24d95a54 ........................... Unix time: 1415239972\n30c31b18 ........................... Target (bits)\nfe9f0864 ........................... Nonce\n\n00 ................................. Transaction count (0x00)\n```\n\n# headers2\n\n*Added in protocol version 70223 of Dash Core.*\n\nThe [`headers2` message](core-ref-p2p-network-data-messages#headers2) sends compressed block headers to a <<glossary:node>> which previously requested certain <<glossary:headers>> with a [`getheaders2` message](core-ref-p2p-network-data-messages#getheaders) or indicated it wants to receive them by signaling with a [`sendheaders2` message](core-ref-p2p-network-control-messages#sendheaders2).\n\n| Bytes    | Name    | Data Type        | Description\n|----------|---------|------------------|-----------------\n| *Varies* | count   | compactSize uint | Number of block headers up to a maximum of 2,000.  Note: headers-first sync assumes the sending node will send the maximum number of headers whenever possible.\n| *Varies* | headers | block_header2     | Block headers in the [`block_header2`](https://github.com/thephez/dips/blob/compressed-headers/compressed-headers.md#block_header2-data-type) format<br>**Note**: the first header will always be uncompressed.\n\nThe following annotated hexdump shows a [`headers2` message](core-ref-p2p-network-data-messages#headers2).  (The message header has been omitted.)\n\n\n``` text\nfdd007 ............................. Header count: 2000 (0x07d0)\n\nHeader 1 (uncompressed)\n| 38 ............................... Bitfield (0x00100110)\n| 02000000 ......................... Block version\n| 2cbcf83b62913d56f605c0e581a48872\n| 839428c92e5eb76cd7ad94bcaf0b0000 . Hash of previous block's header\n| 7f11dcce14075520e8f74cc4ddf092b4\n| e26ebd23b8d8665a1ae5bfc41b58fdb4 . Merkle root\n| c3a95e53 ......................... Unix time: 1398712771\n| ffff0f1e ......................... Target (bits)\n| f37a0000 ......................... Nonce\n\nHeader 2 (previous header and time compressed)\n| 20 ............................... Bitfield (0x00100000)\n| 02000000 ......................... Block version\n| .................................. Hash of previous block's header (compressed)\n| 4d29e4f9b2e05a9ac97dd5ae4128b3c0\n| 104bdc95aabaa566cc8eeb682e336d0d . Merkle root\n| 0100 ............................. Unix time (compressed)\n| f0ff0f1e ......................... Target (bits)\n| 7b190000 ......................... Nonce\n\nHeader 3 (block version, previous header, time, and bits compressed)\n| 01 ............................... Bitfield (0x00000001)\n| .................................. Block version (compressed)\n| .................................. Hash of previous block's header (compressed)\n| 58968247522cc488db01996de610d6f3\n| b8c348e748198dc528a305941211c71c . Merkle root\n| 0200 ............................. Unix time (compressed)\n| .................................. Target (bits) (compressed)\n| 7b190000 ......................... Nonce\n\n... Remaining headers truncated\n```\n\n# inv\n\nThe [`inv` message](core-ref-p2p-network-data-messages#inv) (inventory message) transmits one or more <<glossary:inventories>> of objects known to the transmitting <<glossary:peer>>.  It can be sent unsolicited to announce new <<glossary:transactions>> or <<glossary:blocks>>, or it can be sent in reply to a [`getblocks` message](core-ref-p2p-network-data-messages#getblocks) or [`mempool` message](core-ref-p2p-network-data-messages#mempool).\n\nThe receiving peer can compare the inventories from an [`inv` message](core-ref-p2p-network-data-messages#inv) against the inventories it has already seen, and then use a follow-up message to request unseen objects.\n\n| Bytes    | Name      | Data Type             | Description\n|----------|-----------|-----------------------|-----------------\n| *Varies* | count     | compactSize uint      | The number of inventory entries.\n| *Varies* | inventory | inventory             | One or more inventory entries up to a maximum of 50,000 entries.\n\nThe following annotated hexdump shows an [`inv` message](core-ref-p2p-network-data-messages#inv) with two inventory entries.  (The message header has been omitted.)\n\n``` text\n02 ................................. Count: 2\n\n0f000000 ........................... Type: MSG_MASTERNODE_PING\ndd6cc6c11211793b239c2e311f1496e2\n2281b200b35233eaae465d2aa3c9d537 ... Hash (mnp)\n\n05000000 ........................... Type: MSG_TXLOCK_VOTE\nafc5b2f418f8c06c477a7d071240f5ee\nab17057f9ce4b50c2aef4fadf3729a2e ... Hash (txlvote)\n```\n\n# mempool\n\n*Added in protocol version 60002 (of Bitcoin).*\n\nThe [`mempool` message](core-ref-p2p-network-data-messages#mempool) requests the <<glossary:TXIDs>> of transactions that the receiving <<glossary:node>> has verified as valid but which have not yet appeared in a <<glossary:block>>. That is, transactions which are in the receiving node's memory pool. The response to the [`mempool` message](core-ref-p2p-network-data-messages#mempool) is one or more [`inv` messages](core-ref-p2p-network-data-messages#inv) containing the TXIDs in the usual <<glossary:inventory>> format.\n\nSending the [`mempool` message](core-ref-p2p-network-data-messages#mempool) is mostly useful when a program first connects to the network. Full nodes can use it to quickly gather most or all of the unconfirmed transactions available on the network; this is especially useful for miners trying to gather transactions for their transaction fees. SPV clients can set a filter before sending a `mempool` to only receive transactions that match that filter; this allows a recently-started client to get most or all unconfirmed transactions related to its wallet.\n[block:callout]\n{\n  \"type\": \"info\",\n  \"body\": \"Dash Core 0.15.0 expanded the mempool message to include syncing of [InstantSend Lock](core-ref-p2p-network-instantsend-messages#islock) inventories. Additionally, nodes now attempt to sync their mempool with peers at startup by default (limited to peers using protocol version 70216 or higher). This allows nodes to more quickly detect any double-spend attempts as well as show InstantSend lock status correctly for transactions received while offline.\\n\\nDash Core 0.17.0 expanded the mempool message to include syncing of [ChainLock](core-ref-p2p-network-instantsend-messages#clsig) inventories. This allows nodes to more quickly show ChainLock status correctly after being offline.\",\n  \"title\": \"InstantSend and ChainLock Synchronization\"\n}\n[/block]\nThe `inv` response to the [`mempool` message](core-ref-p2p-network-data-messages#mempool) is, at best, one node's view of the network---not a complete list of every <<glossary:unconfirmed transaction>> on the network. Here are some additional reasons the list might not be complete:\n\n* The [`mempool` message](core-ref-p2p-network-data-messages#mempool) is not currently fully compatible with the [`filterload` message](core-ref-p2p-network-control-messages#filterload)'s `BLOOM_UPDATE_ALL` and `BLOOM_UPDATE_P2PUBKEY_ONLY` flags. Mempool transactions are not sorted like in-block transactions, so a transaction (tx2) spending an <<glossary:output>> can appear before the transaction (tx1) containing that output, which means the automatic filter update mechanism won't operate until the second-appearing transaction (tx1) is seen---missing the first-appearing transaction (tx2). It has been proposed in [Bitcoin Core issue #2381](https://github.com/bitcoin/bitcoin/issues/2381) that the transactions should be sorted before being processed by the filter.\n\nThere is no payload in a [`mempool` message](core-ref-p2p-network-data-messages#mempool).  See the [message header section](core-ref-p2p-network-message-headers) for an example of a message without a payload.\n\n# merkleblock\n\n*Added in protocol version 70001 as described by BIP37.*\n\nThe [`merkleblock` message](core-ref-p2p-network-data-messages#merkleblock) is a reply to a [`getdata` message](core-ref-p2p-network-data-messages#getdata) which requested a <<glossary:block>> using the inventory type `MSG_MERKLEBLOCK`.  It is only part of the reply: if any matching transactions are found, they will be sent separately as [`tx` messages](core-ref-p2p-network-data-messages#tx). As of Dash Core 0.17.0 [`islock` messages](core-ref-p2p-network-instantsend-messages#islock) for matching transactions are sent if present.\n[block:callout]\n{\n  \"type\": \"warning\",\n  \"body\": \"Note: `islock` messages are currently dropped once a ChainLock is present so in most cases they will not actually be provided in response to a merkleblock request. Future updates may modify this behavior.\"\n}\n[/block]\nIf a filter has been previously set with the [`filterload` message](core-ref-p2p-network-control-messages#filterload), the [`merkleblock` message](core-ref-p2p-network-data-messages#merkleblock) will contain the <<glossary:TXIDs>> of any transactions in the requested block that matched the filter, as well as any parts of the block's <<glossary:merkle tree>> necessary to connect those transactions to the block header's <<glossary:merkle root>>. The message also contains a complete copy of the <<glossary:block header>> to allow the client to hash it and confirm its <<glossary:proof of work>>.\n\n| Bytes    | Name               | Data Type        | Description\n|----------|--------------------|------------------|----------------\n| 80       | block header       | block_header     | The block header in the format described in the [block header section](core-ref-block-chain-block-headers).\n| 4        | transaction count  | uint32_t         | The number of transactions in the block (including ones that don't match the filter).\n| *Varies* | hash count         | compactSize uint | The number of hashes in the following field.\n| *Varies* | hashes             | char[32]         | One or more hashes of both transactions and merkle nodes in internal byte order.  Each hash is 32 bytes.\n| *Varies* | flag byte count    | compactSize uint | The number of flag bytes in the following field.\n| *Varies* | flags              | byte[]           | A sequence of bits packed eight in a byte with the least significant bit first.  May be padded to the nearest byte boundary but must not contain any more bits than that.  Used to assign the hashes to particular nodes in the merkle tree as described below.\n\nThe annotated hexdump below shows a [`merkleblock` message](core-ref-p2p-network-data-messages#merkleblock) which corresponds to the examples below.  (The message header has been omitted.)\n\n``` text\n01000000 ........................... Block version: 1\n82bb869cf3a793432a66e826e05a6fc3\n7469f8efb7421dc88067010000000000 ... Hash of previous block's header\n7f16c5962e8bd963659c793ce370d95f\n093bc7e367117b3c30c1f8fdd0d97287 ... Merkle root\n76381b4d ........................... Time: 1293629558\n4c86041b ........................... nBits: 0x04864c * 256**(0x1b-3)\n554b8529 ........................... Nonce\n\n07000000 ........................... Transaction count: 7\n04 ................................. Hash count: 4\n\n3612262624047ee87660be1a707519a4\n43b1c1ce3d248cbfc6c15870f6c5daa2 ... Hash #1\n019f5b01d4195ecbc9398fbf3c3b1fa9\nbb3183301d7a1fb3bd174fcfa40a2b65 ... Hash #2\n41ed70551dd7e841883ab8f0b16bf041\n76b7d1480e4f0af9f3d4c3595768d068 ... Hash #3\n20d2a7bc994987302e5b1ac80fc425fe\n25f8b63169ea78e68fbaaefa59379bbf ... Hash #4\n\n01 ................................. Flag bytes: 1\n1d ................................. Flags: 1 0 1 1 1 0 0 0\n```\n\nNote: when fully decoded, the above [`merkleblock` message](core-ref-p2p-network-data-messages#merkleblock) provided the TXID for a single transaction that matched the filter. In the <<glossary:network>> traffic dump this output was taken from, the full transaction belonging to that TXID was sent immediately after the [`merkleblock` message](core-ref-p2p-network-data-messages#merkleblock) as a [`tx` message](core-ref-p2p-network-data-messages#tx).\n\n## Parsing A MerkleBlock Message\n\nAs seen in the annotated hexdump above, the [`merkleblock` message](core-ref-p2p-network-data-messages#merkleblock) provides three special data types: a transaction count, a list of hashes, and a list of one-bit flags.\n\nYou can use the transaction count to construct an empty <<glossary:merkle tree>>. We'll call each entry in the tree a node; on the bottom are TXID nodes---the hashes for these nodes are <<glossary:TXIDs>>; the remaining nodes (including the <<glossary:merkle root>>) are non-TXID nodes---they may actually have the same hash as a TXID, but we treat them differently.\n\n![Example Of Parsing A MerkleBlock Message](https://dash-docs.github.io/img/dev/animated-en-merkleblock-parsing.gif)\n\nKeep the hashes and flags in the order they appear in the [`merkleblock` message](core-ref-p2p-network-data-messages#merkleblock). When we say \"next flag\" or \"next hash\", we mean the next flag or hash on the list, even if it's the first one we've used so far.\n\nStart with the merkle root node and the first flag. The table below describes how to evaluate a flag based on whether the node being processed is a TXID node or a non-TXID node. Once you apply a flag to a node, never apply another flag to that same node or reuse that same flag again.\n\n| Flag  | TXID Node                                                                                | Non-TXID Node\n|-------|------------------------------------------------------------------------------------------|----\n| **0** | Use the next hash as this node's TXID, but this transaction didn't match the filter.     | Use the next hash as this node's hash.  Don't process any descendant nodes.\n| **1** | Use the next hash as this node's TXID, and mark this transaction as matching the filter. | The hash needs to be computed.  Process the left child node to get its hash; process the right child node to get its hash; then concatenate the two hashes as 64 raw bytes and hash them to get this node's hash.\n\nAny time you begin processing a node for the first time, evaluate the next flag. Never use a flag at any other time.\n\nWhen processing a child node, you may need to process its children (the grandchildren of the original node) or further-descended nodes before returning to the parent node. This is expected---keep processing depth first until you reach a TXID node or a non-TXID node with a flag of 0.\n\nAfter you process a TXID node or a non-TXID node with a flag of 0, stop processing flags and begin to ascend the tree. As you ascend, compute the hash of any nodes for which you now have both child hashes or for which you now have the sole child hash. See the [merkle tree section](core-ref-block-chain-block-headers#merkle-trees) for hashing instructions. If you reach a node where only the left hash is known, descend into its right child (if present) and further descendants as necessary.\n\nHowever, if you find a node whose left and right children both have the same hash, fail.  This is related to CVE-2012-2459.\n\nContinue descending and ascending until you have enough information to obtain the hash of the merkle root node. If you run out of flags or hashes before that condition is reached, fail. Then perform the following checks (order doesn't matter):\n\n* Fail if there are unused hashes in the hashes list.\n\n* Fail if there are unused flag bits---except for the minimum number of bits necessary to pad up to the next full byte.\n\n* Fail if the hash of the merkle root node is not identical to the merkle root in the <<glossary:block header>>.\n\n* Fail if the block header is invalid. Remember to ensure that the hash of the header is less than or equal to the <<glossary:target threshold>> encoded by the nBits header field. Your program should also, of course, attempt to ensure the header belongs to the best block chain and that the user knows how many confirmations this block has.\n\nFor a detailed example of parsing a [`merkleblock` message](core-ref-p2p-network-data-messages#merkleblock), please see the corresponding [merkle block examples section](core-example-p2p-network-parsing-a-merkleblock).\n\n## Creating A MerkleBlock Message\n\nIt's easier to understand how to create a [`merkleblock` message](core-ref-p2p-network-data-messages#merkleblock) after you understand how to parse an already-created message, so we recommend you read the parsing section above first.\n\nCreate a complete merkle tree with <<glossary:TXIDs>> on the bottom row and all the other hashes calculated up to the <<glossary:merkle root>> on the top row. For each transaction that matches the filter, track its TXID node and all of its ancestor nodes.\n\n![Example Of Creating A MerkleBlock Message](https://dash-docs.github.io/img/dev/animated-en-merkleblock-creation.gif)\n\nStart processing the tree with the <<glossary:merkle root>> node. The table below describes how to process both TXID nodes and non-TXID nodes based on whether the node is a match, a match ancestor, or neither a match nor a match ancestor.\n\n|                                      | TXID Node                                                              | Non-TXID Node\n|--------------------------------------|------------------------------------------------------------------------|----\n| **Neither Match Nor Match Ancestor** | Append a 0 to the flag list; append this node's TXID to the hash list. | Append a 0 to the flag list; append this node's hash to the hash list.  Do not descend into its child nodes.\n| **Match Or Match Ancestor**          | Append a 1 to the flag list; append this node's TXID to the hash list. | Append a 1 to the flag list; process the left child node.  Then, if the node has a right child, process the right child.  Do not append a hash to the hash list for this node.\n\nAny time you begin processing a node for the first time, a flag should be appended to the flag list. Never put a flag on the list at any other time, except when processing is complete to pad out the flag list to a byte boundary.\n\nWhen processing a child node, you may need to process its children (the grandchildren of the original node) or further-descended nodes before returning to the parent node. This is expected---keep processing depth first until you reach a TXID node or a node which is neither a TXID nor a match ancestor.\n\nAfter you process a TXID node or a node which is neither a TXID nor a match ancestor, stop processing and begin to ascend the tree until you find a node with a right child you haven't processed yet. Descend into that right child and process it.\n\nAfter you fully process the merkle root node according to the instructions in the table above, processing is complete.  Pad your flag list to a byte boundary and construct the [`merkleblock` message](core-ref-p2p-network-data-messages#merkleblock) using the template near the beginning of this subsection.\n\n# mnlistdiff\n\n*Added in protocol version 70213*\n\nThe [`mnlistdiff` message](core-ref-p2p-network-data-messages#mnlistdiff) is a reply to a [`getmnlistd` message](core-ref-p2p-network-data-messages#getmnlistd) which requested either a full <<glossary:masternode>> list or a diff for a range of <<glossary:blocks>>.\n\n| Bytes | Name | Data<br>type | Required | Description |\n| ---------- | ----------- | --------- | -------- | -------- |\n| 32 | baseBlockHash | uint256 | Required | Hash of a block the requester already has a valid masternode list of. Can be all-zero to indicate that a full masternode list is requested.\n| 32 | blockHash | uint256 | Required | Hash of the block for which the masternode list diff is requested\n| 4 | totalTransactions | uint32_t  | Required | Number of total transactions in `blockHash`\n| 1-9 | merkleHashes<br>Count | compactSize uint | Required | Number of Merkle hashes\n| variable | merkleHashes | vector | Required | Merkle hashes in depth-first order\n| 1-9 | merkleFlags<br>Count | compactSize uint | Required | Number of Merkle flag bytes\n| variable | merkleFlags | vector<uint8_t> | Required | Merkle flag bits, packed per 8 in a byte, least significant bit first\n| variable | cbTx | CTransaction | Required | The fully serialized coinbase transaction of `blockHash`\n| 1-9 | deletedMNsCount | compactSize uint | Required | Number of ProRegTx hashes which were deleted after baseBlockHash\n| variable | deletedMNs | vector | Required | A list of ProRegTx hashes for masternode which were deleted after `baseBlockHash`\n| variable | mnList | vector | Required | The list of Simplified Masternode List (SML) entries which were added or updated since `baseBlockHash`\n| 1-9 | deletedQuorums<br>Count | compactSize uint | Required | *Added in protocol version 70214*<br><br>Number of LLMQs which were deleted from the active set after `baseBlockHash` |\n| variable | deletedQuorums | (uint8_t+uint256)[] | Required | *Added in protocol version 70214*<br><br>A list of LLMQ type and quorum hashes for LLMQs which were deleted after `baseBlockHash` |\n| 1-9 | newQuorumsCount | compactSize uint | Required | *Added in protocol version 70214*<br><br>Number of new LLMQs which were added to the active set since `baseBlockHash` |\n| variable | newQuorums | qfcommit[] | Required | *Added in protocol version 70214*<br><br>The list of LLMQ commitments for the LLMQs which were added since `baseBlockHash` |\n\nSimplified Masternode List (SML) Entry\n\n| Bytes | Name | Data type | Description |\n| ---------- | ----------- | -------- | -------- |\n| 32 | proRegTxHash | uint256 | The hash of the ProRegTx that identifies the masternode\n| 32 | confirmedHash | uint256 | The hash of the block at which the masternode got confirmed\n| 16 | ipAddress | byte[] | IPv6 address in network byte order. Only IPv4 mapped addresses are allowed (to be extended in the future)\n| 2 | port | uint_16 | Port (network byte order)\n| 48 | pubKeyOperator | BLSPubKey | The operators public key\n| 20 |keyIDVoting | CKeyID | The public key hash used for voting.\n| 1 | isValid | bool | True if a masternode is not PoSe-banned\n\nThe following annotated hexdump shows a [`mnlistdiff` message](core-ref-p2p-network-data-messages#mnlistdiff). (The message header has been omitted.)\n\n``` text\n000001ee5108348a2c59396da29dc576\n9b2a9bb303d7577aee9cd95136c49b9b ........... Base block hash\n\n0000030f51f12e7069a7aa5f1bc9085d\ndb3fe368976296fd3b6d73fdaf898cc0 ........... Block hash\n\n05000000 ................................... Transactions: 5\n\n04 ......................................... Merkle hash count: 4\n\n4488a599e5d61709664c32305befd58b\nef29e33bc6e718af0233f938557a57a9 ........... Merkle hash 1\n5c8119b7b136d94e477a0d2917d5f724\n5ff299cc6e31994f6236a8fb34fec88f ........... Merkle hash 2\n905efa3e6743c889823f00147d36d12f\nd12ad401c19089f0affcabd423deef67 ........... Merkle hash 3\n3f3a7f84d7ad33214994b5aecf4c1e19\n2cb65b86750b1377e069073d1eba477a ........... Merkle hash 4\n\n01 ......................................... Merkle flag count: 1\n0f ......................................... Flags: 0 0 0 0 1 1 1 1\n\n[...]....................................... Coinbase Tx (Not shown)\n\n00 ......................................... Deleted masternodes: 0\n\n02 ......................................... Masternode list entries: 2\n\n00 ......................................... Deleted quorums: 0\n\n00 ......................................... New quorums: 0\n\nMasternode List\n| Masternode 1\n| | 01040eb32f760490054543356cff4638\n| | 65633439dd073cffa570305eb086f70e ....... ProRegTx hash\n| |\n| | 000001ee5108348a2c59396da29dc576\n| | 9b2a9bb303d7577aee9cd95136c49b9b ....... Confirmed block hash\n| |\n| | 00000000000000000000000000000000 ....... IP Address: ::ffff:0.0.0.0\n| | 0000 ................................... Port: 0\n| |\n| | 0000000000000000000000000000000000000000\n| | 0000000000000000000000000000000000000000\n| | 0000000000000000 ....................... Operator public key (BLS)\n| | c2ae01fb4084cbc3bc31e7f59b36be228a320404 Voting pubkey hash (ECDSA)\n| |\n| | 0 ...................................... Valid (0 - No)\n|\n| Masternode 2\n| | f7737beb39779971e9bc59632243e13f\n| | c5fc9ada93b69bf48c2d4c463296cd5a ....... ProRegTx hash\n| |\n| | 0000030f51f12e7069a7aa5f1bc9085d\n| | db3fe368976296fd3b6d73fdaf898cc0 ....... Confirmed block hash\n| |\n| | 000000000000000000000000cf9af40d ....... IP Address: ::ffff:207.154.244.13\n| | 4e1f ................................... Port: 19999\n| |\n| | 88d719278eef605d9c19037366910b59bc28d437\n| | de4a8db4d76fda6d6985dbdf10404fb9bb5cd0e8\n| | c22f4a914a6c5566 ....................... Operator public key (BLS)\n| | 43ce12751c4ba45dcdfe2c16cefd61461e17a54d Voting pubkey hash (ECDSA)\n| |\n| | 1 ...................................... Valid (1 - Yes)\n```\n\n# notfound\n\n*Added in protocol version 70001.*\n\nThe [`notfound` message](core-ref-p2p-network-data-messages#notfound) is a reply to a [`getdata` message](core-ref-p2p-network-data-messages#getdata) which requested an object the receiving <<glossary:node>> does not have available for relay. (Nodes are not expected to relay historic transactions which are no longer in the memory pool or relay set. Nodes may also have pruned spent transactions from older <<glossary:blocks>>, making them unable to send those blocks.)\n\nThe format and maximum size limitations of the [`notfound` message](core-ref-p2p-network-data-messages#notfound) are identical to the [`inv` message](core-ref-p2p-network-data-messages#inv); only the message header differs.\n\n# qrinfo\n\n*Added in protocol version 70222 of Dash Core.*\n\nThe `qrinfo` message sends quorum rotation information to a node which previously requested it with a [`getqrinfo` message](core-ref-p2p-network-data-messages#getqrinfo).\n\nNote: In the following fields, `c` refers to the quorum cycle length. This is synonymous with the DKG interval (`quorumDkgInterval`) as defined in [DIP6](https://github.com/dashpay/dips/blob/master/dip-0006.md#parametersvariables-of-a-llmq-and-dkg).\n\n| Bytes | Name | Data type | Required | Description |\n| ---------- | ----------- | --------- | -------- | -------- |\n| Varies | quorumSnapshot<br>AtHMinusC | CQuorumSnapshot | Required | Quorum snapshot for height `h-c`\n| Varies | quorumSnapshot<br>AtHMinus2C | CQuorumSnapshot | Required | Quorum snapshot for height `h-2c`\n| Varies | quorumSnapshot<br>AtHMinus3C | CQuorumSnapshot | Required | Quorum snapshot for height `h-3c`\n| Varies | mnListDiffTip | CSimplifiedMNListDiff<br>(see [`mnlistdiff`](#mnlistdiff)) | Required | Masternode list diff at height at the tip. \n| Varies | mnListDiffH | CSimplifiedMNListDiff<br>(see [`mnlistdiff`](#mnlistdiff)) | Required | Masternode list diff at height `h`. \n| Varies | mnListDiff<br>AtHMinusC | CSimplifiedMNListDiff<br>(see [`mnlistdiff`](#mnlistdiff)) | Required | Masternode list diff at height `h-c`\n| Varies | mnListDiff<br>AtHMinus2C | CSimplifiedMNListDiff<br>(see [`mnlistdiff`](#mnlistdiff)) | Required | Masternode list diff at height `h-2c`\n| Varies | mnListDiff<br>AtHMinus3C | CSimplifiedMNListDiff<br>(see [`mnlistdiff`](#mnlistdiff)) | Required | Masternode list diff at height `h-3c`\n| 1 | extraShare | bool | Required | Flag to indicate if an extra share is requested |\n| Varies | quorumSnapshot<br>AtHMinus4C | CQuorumSnapshot | Optional | Returned only if `extraShare` is on. See below for sub-message contents. |\n| Varies | mnListDiff<br>AtHMinus4C | CSimplifiedMNListDiff | Optional | Returned only if `extraShare` is on. As in DIP-4.\n| 1-9 | lastQuorumHashPer<br>IndexSize | compactSize uint | Required | Number of elements in `lastCommitmentPerIndex`\n| 32 * `lastQuorum`<br>`HashPer`<br>`IndexSize`  | lastCommitment<br>PerIndex | uint256_t[] |  Required | Contains the most recent commitment for each quorumIndex. Ordered by quorumIndex.\n| 1-9 | quorumSnapshot<br>ListSize | compactSize uint | Required | Number of elements in `quorumSnapshotList`\n| Varies | quorumSnapshot<br>List | CQuorumSnapshot[] | Required | The snapshots required to reconstruct the quorums built at `h` in heightsLists. Ordered from oldest to newest\n| 1-9 | mnListDiff<br>ListSize | compactSize uint | Required | Number of elements in `mnListDiffList`\n| Varies | mnListDiffList | CSimplifiedMNListDiff[] | Required | The MNLISTDIFFs required to calculate older quorums. Ordered from oldest to newest\n\n**CQuorumSnapshot**\n\nNote: All fields are required\n\n| Bytes | Name | Data type | Description |\n| ---------- | ----------- | --------- | -------- |\n| 4 | mnSkipListMode | int32_t |  Mode of the skip list\n| 1-9 | activeQuorum<br>MembersSize | compactSize uint | Number of elements in `activeQuorumMembers`\n| (`activeQuorum`<br>`MembersSize`) + 7)/8 | activeQuorumMembers | cbitset |  The bitset of nodes already in quarters at the start of cycle at height n\n| 1-9 | mnSkipListSize | compactSize uint |  Number of elements in mnSkipList\n| 4 * `mnSkipListSize` | mnSkipList | int32_t[] | Skiplist at height n\n\n\n\nThe following annotated hexdump shows a [`qrinfo` message](core-ref-p2p-network-data-messages#qrinfo). (The message header has been omitted.)\n\n``` text\nQuorum snapshot (h-c)\n| 01000000 ................................. Skiplist mode: 1\n| 1f ....................................... Active quorum members: 31\n| bbffff7f ................................. Active quorum members bitset\n| \n| 01 ....................................... Skip list size: 1\n| \n| Skip list\n| | 0b000000 ............................... Masternode 11\n\nQuorum snapshot (h-2c)\n| 01000000 ................................. Skiplist mode: 1\n| 1f ....................................... Active quorum members: 31\n| f3ff6f7b ................................. Active quorum members bitset\n|\n| 06 ....................................... Skip list size: 6\n| \n| Skip list\n| | 05000000 ............................... Masternode 5\n| | 03000000 ............................... Masternode 3\n| | 04000000 ............................... Masternode 4\n| | 06000000 ............................... Masternode 6\n| | 07000000 ............................... Masternode 7\n| | 08000000 ............................... Masternode 8\n\nQuorum snapshot (h-3c) ..................... Not shown for brevity\n\nMnListDiff (Tip)\n| e173b01943fe7b8d2bf5a13c034eafed\n| d2708a1a0f9e5104b86439382e050000 ......... Base block hash\n| 847b42ae4509c82e8c8ba599f23f15c1\n| e34c899a09e4ebf440f6e2ef4b000000 ......... Block hash\n| 01000000 ................................. Transactions: 1\n| 01 ....................................... Merkle hash count: 1\n| c44c59fd87c816506d3890aaf0c8f7df\n| bad10f4a9b3e2b43bc1e9c832e81b381 ......... Merkle hash 1\n| 01 ....................................... Merkle flag count: 1\n| 01 ....................................... Flags: 0 0 0 0 0 0 0 1\n|\n| [...]..................................... Coinbase Tx (Not shown)\n\nMnListDiff (h) ............................. Not shown for brevity\nMnListDiff (h-c) ........................... Not shown for brevity\nMnListDiff (h-2c) .......................... Not shown for brevity\nMnListDiff (h-3c) .......................... Not shown for brevity\n\n01 ....................................... Extra share: true\n\nQuorum snapshot (h-4c)\n| 01000000 ................................. Skiplist mode: 1\n| 1f ....................................... Active quorum members: 31\n| ff7fdd5f ................................. Active quorum members bitset\n|\n| 01 ....................................... Skip list size: 1\n|\n| Skip list\n| | 07000000 ............................... Masternode 7\n\nMnListDiff (h-4c)\n\nLast quorum hash per index\n| 04 ....................................... Quorum hashes: 4\n| c2e276c518b3f8484b237e300094e222\n| 388a095f486c822585a67b1520010000 ......... Quorum hash 1\n| bb4f0c5a3efb229bd5a4e4e45ca2228e\n| b11f05c3a6e8fdf9d7d4f499b7010000 ......... Quorum hash 2\n| aca22eb2c63daa5304cb9cbe6089afe3\n| 99e335f73306735718355ad3d9000000 ......... Quorum hash 3\n| 45bf29bada522857d6e3b2371e1fefc7\n| c01fcef0b6578e7062fd571760010000 ......... Quorum hash 4\n\n00 ......................................... Quorum snapshot list size: 0\n00 ......................................... Masternode list diff list size: 0\n```\n\n\n# tx\n\nThe [`tx` message](core-ref-p2p-network-data-messages#tx) transmits a single transaction in the <<glossary:raw transaction>> format. It can be sent in a variety of situations;\n\n* **Transaction Response:** Dash Core will send it in response to a [`getdata` message](core-ref-p2p-network-data-messages#getdata) that requests the transaction with an <<glossary:inventory>>  type of `MSG_TX`.\n\n* **MerkleBlock Response:** Dash Core will send it in response to a [`getdata` message](core-ref-p2p-network-data-messages#getdata) that requests a <<glossary:merkle block>> with an <<glossary:inventory>> type of `MSG_MERKLEBLOCK`. (This is in addition to sending a [`merkleblock` message](core-ref-p2p-network-data-messages#merkleblock).) Each [`tx` message](core-ref-p2p-network-data-messages#tx) in this case provides a matched transaction from that <<glossary:block>>.\n\nFor an example hexdump of the raw transaction format, see the [raw transaction section](core-ref-transactions-raw-transaction-format).",
 "order": 4,
 "isReference": false,
 "deprecated": false,
 "hidden": false,
 "sync_unique": "",
 "link_url": "",
 "link_external": false,
 "pendingAlgoliaPublish": false,
 "previousSlug": "",
 "slugUpdatedAt": "2021-01-25T00:40:44.499Z",
 "_id": "61549206c31f6b00207cf23d",
 "version": "61549206c31f6b00207cf2be",
 "updatedAt": "2022-08-09T19:21:29.847Z",
 "createdAt": "2019-10-23T16:02:30.243Z",
 "project": "5daf2e65f4109c0040fd51e1",
 "user": "5b8400d7185d5e00036dcc3b",
 "parentDoc": "61549206c31f6b00207cf239",
 "category": "61549205c31f6b00207cf231",
 "__v": 4,
 "isApi": false,
 "id": "61549206c31f6b00207cf23d",
 "body_html": "<div class=\"magic-block-textarea\"><p>The following network messages all request or provide data related to transactions and blocks.</p>\n<p><img src=\"https://dash-docs.github.io/img/dev/en-p2p-data-messages.svg\" alt=\"Overview Of P2P Protocol Data Request And Reply Messages\"></p>\n<p>Many of the data messages use &lt;&lt;glossary:inventories&gt;&gt; as unique identifiers for &lt;&lt;glossary:transactions&gt;&gt; and &lt;&lt;glossary:blocks&gt;&gt;.  Inventories have a simple 36-byte structure:</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data Type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>4</td>\n<td>type identifier</td>\n<td>uint32_t</td>\n<td>The type of object which was hashed.  See list of type identifiers below.</td>\n</tr>\n<tr>\n<td>32</td>\n<td>hash</td>\n<td>char[32]</td>\n<td>SHA256(SHA256()) hash of the object in internal byte order.</td>\n</tr>\n</tbody>\n</table></div>\n<p>The currently-available type identifiers are:</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Type Identifier</th>\n<th>Name</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>&lt;&lt;glossary:MSG_TX&gt;&gt;</td>\n<td>The hash is a TXID.</td>\n</tr>\n<tr>\n<td>2</td>\n<td>&lt;&lt;glossary:MSG_BLOCK&gt;&gt;</td>\n<td>The hash is of a block header.</td>\n</tr>\n<tr>\n<td>3</td>\n<td>&lt;&lt;glossary:MSG_FILTERED_BLOCK&gt;&gt;</td>\n<td>The hash is of a block header; identical to <code>MSG_BLOCK</code>. When used in a <a href=\"core-ref-p2p-network-data-messages#getdata\"><code>getdata</code> message</a>, this indicates the response should be a <a href=\"core-ref-p2p-network-data-messages#merkleblock\"><code>merkleblock</code> message</a> rather than a <a href=\"core-ref-p2p-network-data-messages#block\"><code>block</code> message</a> (but this only works if a bloom filter was previously configured).  <strong>Only for use in <a href=\"core-ref-p2p-network-data-messages#getdata\"><code>getdata</code> messages</a>.</strong></td>\n</tr>\n<tr>\n<td>4</td>\n<td>&lt;&lt;glossary:MSG_LEGACY_TXLOCK_REQUEST&gt;&gt;</td>\n<td><code>MSG_TXLOCK_REQUEST</code> prior to Dash Core 0.15.0. The hash is an Instant Send transaction lock request. Transactions received this way are automatically converted to a standard <a href=\"core-ref-p2p-network-data-messages#tx\"><code>tx</code> message</a> as of Dash Core 0.15.0.</td>\n</tr>\n<tr>\n<td>6</td>\n<td>&lt;&lt;glossary:MSG_SPORK&gt;&gt;</td>\n<td>The hash is Spork ID.</td>\n</tr>\n<tr>\n<td>16</td>\n<td>&lt;&lt;glossary:MSG_DSTX&gt;&gt;</td>\n<td>The hash is CoinJoin Broadcast TX.</td>\n</tr>\n<tr>\n<td>17</td>\n<td>&lt;&lt;glossary:MSG_GOVERNANCE_OBJECT&gt;&gt;</td>\n<td>The hash is a Governance Object.</td>\n</tr>\n<tr>\n<td>18</td>\n<td>&lt;&lt;glossary:MSG_GOVERNANCE_OBJECT_VOTE&gt;&gt;</td>\n<td>The hash is a Governance Object Vote.</td>\n</tr>\n<tr>\n<td>20</td>\n<td>&lt;&lt;glossary:MSG_CMPCT_BLOCK&gt;&gt;</td>\n<td>The hash is of a block header; identical to <code>MSG_BLOCK</code>. When used in a <a href=\"core-ref-p2p-network-data-messages#getdata\"><code>getdata</code> message</a>, this indicates the response should be a <a href=\"core-ref-p2p-network-data-messages#cmpctblock\"><code>cmpctblock</code> message</a>. <strong>Only for use in <a href=\"core-ref-p2p-network-data-messages#getdata\"><code>getdata</code> messages</a>.</strong></td>\n</tr>\n<tr>\n<td>21</td>\n<td>&lt;&lt;glossary:MSG_QUORUM_FINAL_COMMITMENT&gt;&gt;</td>\n<td>The hash is a long-living masternode quorum final commitment.<br><em>Added in 0.13.0</em></td>\n</tr>\n<tr>\n<td>23</td>\n<td>&lt;&lt;glossary:MSG_QUORUM_CONTRIB&gt;&gt;</td>\n<td>The hash is a long-living masternode quorum contribution.<br><em>Added in 0.14.0</em></td>\n</tr>\n<tr>\n<td>24</td>\n<td>&lt;&lt;glossary:MSG_QUORUM_COMPLAINT&gt;&gt;</td>\n<td>The hash is a long-living masternode quorum complaint.<br><em>Added in 0.14.0</em></td>\n</tr>\n<tr>\n<td>25</td>\n<td>&lt;&lt;glossary:MSG_QUORUM_JUSTIFICATION&gt;&gt;</td>\n<td>The hash is a long-living masternode quorum justification.<br><em>Added in 0.14.0</em></td>\n</tr>\n<tr>\n<td>26</td>\n<td>&lt;&lt;glossary:MSG_QUORUM_PREMATURE_COMMITMENT&gt;&gt;</td>\n<td>The hash is a long-living masternode quorum premature commitment.<br><em>Added in 0.14.0</em></td>\n</tr>\n<tr>\n<td>28</td>\n<td>&lt;&lt;glossary:MSG_QUORUM_RECOVERED_SIG&gt;&gt;</td>\n<td>The hash is a long-living masternode quorum recovered signature. <br><br><strong>Note</strong>: Only relayed to other masternodes in the same quorum and nodes that have sent a <a href=\"core-ref-p2p-network-quorum-messages#qwatch\"><code>qwatch</code> message</a> as of Dash Core 0.17.0<br><em>Added in 0.14.0</em></td>\n</tr>\n<tr>\n<td>29</td>\n<td>&lt;&lt;glossary:MSG_CLSIG&gt;&gt;</td>\n<td>The hash is a ChainLock signature.<br><em>Added in 0.14.0</em></td>\n</tr>\n<tr>\n<td>30</td>\n<td>&lt;&lt;glossary:MSG_ISLOCK&gt;&gt;</td>\n<td>The hash is an LLMQ-based InstantSend lock (<a href=\"https://github.com/dashpay/dips/blob/master/dip-0010.md\">DIP10</a>).<br><em>Added in 0.14.0</em></td>\n</tr>\n<tr>\n<td>31</td>\n<td>&lt;&lt;glossary:MSG_ISDLOCK&gt;&gt;</td>\n<td>The hash is an LLMQ-based deterministic InstantSend lock (<a href=\"https://github.com/dashpay/dips/blob/master/dip-0022.md\">DIP22</a>).<br><em>Added in 18.0</em></td>\n</tr>\n</tbody>\n</table></div>\n<p><strong>Deprecated Type Identifiers</strong></p>\n<p>The following type identifiers have been deprecated recently. To see type identifiers removed longer ago, please see the <a href=\"https://dashcore.readme.io/v0.16.0/docs/core-ref-p2p-network-data-messages\">previous version of documentation</a>.</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Type Identifier</th>\n<th>Name</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>5</td>\n<td>&lt;&lt;glossary:MSG_TXLOCK_VOTE&gt;&gt;</td>\n<td><strong>Deprecated in 0.15.0</strong><br><br>The hash is an Instant Send transaction vote.</td>\n</tr>\n</tbody>\n</table></div>\n<p>Type identifier zero and type identifiers greater than those shown in the table above are reserved for future implementations. Dash Core ignores all inventories with one of these unknown types.</p>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-block\"></div>block<a class=\"fa fa-anchor\" href=\"#section-block\"></a></h1>\n<p>The <a href=\"core-ref-p2p-network-data-messages#block\"><code>block</code> message</a> transmits a single &lt;&lt;glossary:serialized block&gt;&gt; in the format described in the <a href=\"core-ref-block-chain-serialized-blocks\">serialized blocks section</a>. See that section for an example hexdump.  It can be sent for two different reasons:</p>\n<ol>\n<li  value=\"1\"><p><strong>GetData Response:</strong> Nodes will always send it in response to a <a href=\"core-ref-p2p-network-data-messages#getdata\"><code>getdata</code> message</a> that requests the block with an &lt;&lt;glossary:inventory&gt;&gt; type of <code>MSG_BLOCK</code> (provided the node has that block available for relay).</p>\n</li><li  value=\"2\"><p><strong>Unsolicited:</strong> Some miners will send unsolicited <a href=\"core-ref-p2p-network-data-messages#block\"><code>block</code> messages</a> broadcasting their newly-mined blocks to all of their &lt;&lt;glossary:peers&gt;&gt;. Many &lt;&lt;glossary:mining&gt;&gt; pools do the same thing, although some may be misconfigured to send the block from multiple nodes, possibly sending the same block to some peers more than once.</p>\n</li></ol>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-blocktxn\"></div>blocktxn<a class=\"fa fa-anchor\" href=\"#section-blocktxn\"></a></h1>\n<p><em>Added in protocol version 70209 of Dash Core as described by BIP152</em></p>\n<p>The <a href=\"core-ref-p2p-network-data-messages#blocktxn\"><code>blocktxn</code> message</a> sends requested &lt;&lt;glossary:block&gt;&gt; &lt;&lt;glossary:transactions&gt;&gt; to a node which previously requested them with a <a href=\"core-ref-p2p-network-data-messages#getblocktxn\"><code>getblocktxn</code> message</a>. It is defined as a message containing a serialized <code>BlockTransactions</code> message.</p>\n<p>Upon receipt of a properly-formatted requested <a href=\"core-ref-p2p-network-data-messages#blocktxn\"><code>blocktxn</code> message</a>, &lt;&lt;glossary:nodes&gt;&gt; should:</p>\n<ol>\n<li  value=\"1\">Attempt to reconstruct the full block by taking the prefilledtxn transactions from the original <a href=\"core-ref-p2p-network-data-messages#cmpctblock\"><code>cmpctblock</code> message</a> and placing them in the marked positions</li><li  value=\"2\">For each short transaction ID from the original <a href=\"core-ref-p2p-network-data-messages#cmpctblock\"><code>cmpctblock</code> message</a>, in order, find the corresponding transaction (from either the <a href=\"core-ref-p2p-network-data-messages#blocktxn\"><code>blocktxn</code> message</a> or from other sources)</li><li  value=\"3\">Place each short transaction ID in the first available position in the block</li><li  value=\"4\">Once the block has been reconstructed, it shall be processed as normal.</li></ol>\n<p><strong>Short transaction IDs are expected to occasionally collide. Nodes must not be penalized for such collisions.</strong></p>\n<p>The structure of <code>BlockTransactions</code> is defined below.</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data Type</th>\n<th>Encoding</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>32</td>\n<td>blockhash</td>\n<td>Binary blob</td>\n<td>The output from a double-SHA256 of the block header, as used elsewhere</td>\n<td>The blockhash of the block which the transactions being provided are in</td>\n</tr>\n<tr>\n<td>1 or 3</td>\n<td>transactions<br>_length</td>\n<td>CompactSize</td>\n<td>As used to encode array lengths elsewhere</td>\n<td>The number of transactions provided</td>\n</tr>\n<tr>\n<td><em>Varies</em></td>\n<td>transactions</td>\n<td>List of transactions</td>\n<td>As encoded in <a href=\"core-ref-p2p-network-data-messages#tx\"><code>tx</code> messages</a> in response to <code>getdata MSG_TX</code></td>\n<td>The transactions provided</td>\n</tr>\n</tbody>\n</table></div>\n<p>The following annotated hexdump shows a <a href=\"core-ref-p2p-network-data-messages#blocktxn\"><code>blocktxn</code> message</a>.  (The message header has been omitted.)</p>\n<pre><code class=\"lang-text\">182327cb727da7d60541da793831fd0ab0509e79c8cd\n3d654cdf3a0100000000 ....................... Block Hash\n\n01 ......................................... Transactions Provided: 1\n\nTransaction(s)\n| Transaction 1\n| | 01000000 ................................ Transaction Version: 1\n| | 01 ...................................... Input count: 1\n| |\n| | Transaction input #1\n| | |\n| | | 0952617a516d956e2ecee71a6adc249f\n| | | 4bb757adcc409452ab98c8e55c31e62a ..... Outpoint TXID\n| | | 00000000 ............................. Outpoint index number: 0\n| | |\n| | | 6b ................................... Bytes in sig. script: 107\n| | | 483045022100d10edf447252e1e69ff1\n| | | 77330bb2c889a50be02e00cc5d79c0d0\n| | | 79ae56518fc40220245d36905dc950fc\n| | | d55694cfde8cde3109dc80b12aca3a6e\n| | | 332033802ee36e1b01210272cc6e7660\n| | | 2648831d8e80fca8eb24369cd0f23ff0\n| | | 79cf20ae9d9beee05de6db ............... Secp256k1 signature\n| | |\n| | | ffffffff ............................. Sequence number: UINT32_MAX\n| |\n| | 02 ..................................... Number of outputs: 02\n| |\n| | Transaction output #1\n| | | 0be0f50500000000 ..................... Duffs (0.99999755 Dash)\n| | |\n| | | 19 ................................... Bytes in pubkey script: 25\n| | | | 76 ................................. OP_DUP\n| | | | a9 ................................. OP_HASH160\n| | | | 14 ................................. Push 20 bytes as data\n| | | | | 923d91ed359f650eec6ea8b9030b340d\n| | | | | ea63d590 ......................... PubKey hash\n| | | | 88 ................................. OP_EQUALVERIFY\n| | | | ac ................................. OP_CHECKSIG\n| |\n| | [...] .................................. 1 more tx output omitted\n| |\n| | 00000000 ............................... locktime: 0 (a block height)\n</code></pre>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-cfcheckpt\"></div>cfcheckpt<a class=\"fa fa-anchor\" href=\"#section-cfcheckpt\"></a></h1>\n<p><em>Added in protocol version 70223 of Dash Core as described by <a href=\"https://github.com/bitcoin/bips/blob/master/bip-0157.mediawiki\">BIP 157</a>.</em></p>\n<p>The <a href=\"core-ref-p2p-network-data-messages#cfcheckpt\"><code>cfcheckpt</code> message</a>  is sent in response to the <a href=\"core-ref-p2p-network-data-messages#getcfcheckpt\"><code>getcfcheckpt</code> message</a>.  The filter headers included are the set of all filter headers on the requested chain where the height is a positive multiple of 1,000.</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data Type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>filter_type</td>\n<td>uint8_t</td>\n<td>Filter type for which headers are requested. Should match the field in the <a href=\"core-ref-p2p-network-data-messages#getcfcheckpt\"><code>getcfcheckpt</code> message</a> being responded to.</td>\n</tr>\n<tr>\n<td>32</td>\n<td>stop_hash</td>\n<td>uint256</td>\n<td>The hash of the last block in the requested range. Should match the field in the <a href=\"core-ref-p2p-network-data-messages#getcfcheckpt\"><code>getcfcheckpt</code> message</a> being responded to.</td>\n</tr>\n<tr>\n<td>1-3</td>\n<td>filter_headers<br>_length</td>\n<td>CompactSize</td>\n<td>The length of the following vector of filter headers</td>\n</tr>\n<tr>\n<td><code>filter_headers</code><br><code>_length</code> * 32</td>\n<td>filter_hashes</td>\n<td>[][32]byte</td>\n<td>The filter headers at intervals of 1,000</td>\n</tr>\n</tbody>\n</table></div>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-cfheaders\"></div>cfheaders<a class=\"fa fa-anchor\" href=\"#section-cfheaders\"></a></h1>\n<p><em>Added in protocol version 70223 of Dash Core as described by <a href=\"https://github.com/bitcoin/bips/blob/master/bip-0157.mediawiki\">BIP 157</a>.</em></p>\n<p>The <a href=\"core-ref-p2p-network-data-messages#cfheaders\"><code>cfheaders</code> message</a>  is sent in response to the <a href=\"core-ref-p2p-network-data-messages#getcfheaders\"><code>getcfheaders</code> message</a>. Instead of including the filter headers themselves, the response includes one filter header and a sequence of filter hashes, from which the headers can be derived. This has the benefit that the client can verify the binding links between the headers.</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data Type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>filter_type</td>\n<td>uint8_t</td>\n<td>Filter type for which headers are requested. Should match the field in the <a href=\"core-ref-p2p-network-data-messages#getcfheaders\"><code>getcfheaders</code> message</a> being responded to.</td>\n</tr>\n<tr>\n<td>32</td>\n<td>stop_hash</td>\n<td>uint256</td>\n<td>The hash of the last block in the requested range. Should match the field in the <a href=\"core-ref-p2p-network-data-messages#getcfheaders\"><code>getcfheaders</code> message</a> being responded to.</td>\n</tr>\n<tr>\n<td>32</td>\n<td>previous_filter<br>_header</td>\n<td>uint256</td>\n<td>The filter header preceding the first block in the requested range</td>\n</tr>\n<tr>\n<td>1-3</td>\n<td>filter_hashes<br>_length</td>\n<td>CompactSize</td>\n<td>The length of the following vector of filter hashes. Must not be &gt; 2000.</td>\n</tr>\n<tr>\n<td><code>filter_hashes</code><br><code>_length</code> * 32</td>\n<td>filter_hashes</td>\n<td>[][32]byte</td>\n<td>The filter hashes for each block in the requested range</td>\n</tr>\n</tbody>\n</table></div>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-cfilter\"></div>cfilter<a class=\"fa fa-anchor\" href=\"#section-cfilter\"></a></h1>\n<p><em>Added in protocol version 70223 of Dash Core as described by <a href=\"https://github.com/bitcoin/bips/blob/master/bip-0157.mediawiki\">BIP 157</a>.</em></p>\n<p>The <a href=\"core-ref-p2p-network-data-messages#cfilter\"><code>cfilter</code> message</a>  is sent in response to the <a href=\"core-ref-p2p-network-data-messages#getcfilters\"><code>getcfilters</code> message</a>, one for each block in the requested range.</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data Type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>filter_type</td>\n<td>uint8_t</td>\n<td>Filter type for which headers are requested. Should match the field in the <a href=\"core-ref-p2p-network-data-messages#getcfilters\"><code>getcfilters</code> message</a> being responded to.</td>\n</tr>\n<tr>\n<td>32</td>\n<td>block_hash</td>\n<td>uint256</td>\n<td>Block hash of the block for which the filter is being returned. Must correspond to a block that is an ancestor of the request&#39;s <code>stop_hash</code> with a height &gt;= <code>start_height</code>.</td>\n</tr>\n<tr>\n<td>1-5</td>\n<td>num_filter_bytes</td>\n<td>CompactSize</td>\n<td>A variable length integer representing the size of the filter in the following field</td>\n</tr>\n<tr>\n<td><code>num_filter_bytes</code></td>\n<td>filter_bytes</td>\n<td>[]bytes</td>\n<td>The  serialized compact filter for this block</td>\n</tr>\n</tbody>\n</table></div>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-cmpctblock\"></div>cmpctblock<a class=\"fa fa-anchor\" href=\"#section-cmpctblock\"></a></h1>\n<p><em>Added in protocol version 70209 of Dash Core as described by BIP152</em></p>\n<p>The <a href=\"core-ref-p2p-network-data-messages#cmpctblock\"><code>cmpctblock</code> message</a> is a reply to a <a href=\"core-ref-p2p-network-data-messages#getdata\"><code>getdata</code> message</a> which requested a &lt;&lt;glossary:block&gt;&gt; using the &lt;&lt;glossary:inventory&gt;&gt; type <code>MSG_CMPCT_BLOCK</code>. If the requested block was recently announced and is close to the tip of the best chain of the receiver and after having sent the requesting &lt;&lt;glossary:peer&gt;&gt; a <a href=\"core-ref-p2p-network-control-messages#sendcmpct\"><code>sendcmpct</code> message</a>, nodes respond with a <a href=\"core-ref-p2p-network-data-messages#cmpctblock\"><code>cmpctblock</code> message</a> containing data for the block.</p>\n<p><strong>If the requested block is too old, the node responds with a <em>full non-compact block</em></strong></p>\n<p>Upon receipt of a <a href=\"core-ref-p2p-network-data-messages#cmpctblock\"><code>cmpctblock</code> message</a>, after sending a <a href=\"core-ref-p2p-network-control-messages#sendcmpct\"><code>sendcmpct</code> message</a>, nodes should calculate the short transaction ID for each &lt;&lt;glossary:unconfirmed transaction&gt;&gt; they have available (i.e. in their mempool) and compare each to each short transaction ID in the <a href=\"core-ref-p2p-network-data-messages#cmpctblock\"><code>cmpctblock</code> message</a>. After finding already-available transactions, nodes which do not have all transactions available to reconstruct the full block should request the missing transactions using a <a href=\"core-ref-p2p-network-data-messages#getblocktxn\"><code>getblocktxn</code> message</a>.</p>\n<p>A node must not send a <a href=\"core-ref-p2p-network-data-messages#cmpctblock\"><code>cmpctblock</code> message</a> unless they are able to respond to a <a href=\"core-ref-p2p-network-data-messages#getblocktxn\"><code>getblocktxn</code> message</a> which requests every transaction in the block. A node must not send a <a href=\"core-ref-p2p-network-data-messages#cmpctblock\"><code>cmpctblock</code> message</a> without having validated that the &lt;&lt;glossary:header&gt;&gt; properly commits to each transaction in the block, and properly builds on top of the existing, fully-validated chain with a valid proof-of-work either as a part of the current most-work valid chain, or building directly on top of it. A node may send a <a href=\"core-ref-p2p-network-data-messages#cmpctblock\"><code>cmpctblock</code> message</a> before validating that each transaction in the block validly spends existing UTXO set entries.</p>\n<p>The <a href=\"core-ref-p2p-network-data-messages#cmpctblock\"><code>cmpctblock</code> message</a> contains a vector of <code>PrefilledTransaction</code> whose structure is defined below. A <code>PrefilledTransaction</code> is used in <code>HeaderAndShortIDs</code> to provide a list of a few transactions explicitly.</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data Type</th>\n<th>Encoding</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1 or 3</td>\n<td>index</td>\n<td>CompactSize</td>\n<td>Compact Size, differentially encoded since the last PrefilledTransaction in a list</td>\n<td>The index into the block at which this transaction is</td>\n</tr>\n<tr>\n<td><em>Varies</em></td>\n<td>tx</td>\n<td>Transaction</td>\n<td>As encoded in <a href=\"core-ref-p2p-network-data-messages#tx\"><code>tx</code> messages</a> sent in response to <code>getdata MSG_TX</code></td>\n<td>Transaction which is in the block at index <code>index</code></td>\n</tr>\n</tbody>\n</table></div>\n<p>The <a href=\"core-ref-p2p-network-data-messages#cmpctblock\"><code>cmpctblock</code> message</a> is compromised of a serialized <code>HeaderAndShortIDs</code> structure which is defined below. A <code>HeaderAndShortIDs</code> structure is used to relay a block header, the short transactions IDs used for matching already-available transactions, and a select few transactions which we expect a peer may be missing.</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data Type</th>\n<th>Encoding</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>80</td>\n<td>header</td>\n<td>Block header</td>\n<td>First 80 bytes of the block as defined by the encoding used by <a href=\"core-ref-p2p-network-data-messages#block\"><code>block</code> messages</a></td>\n<td>The header of the block being provided</td>\n</tr>\n<tr>\n<td>8</td>\n<td>nonce</td>\n<td>uint64_t</td>\n<td>Little Endian</td>\n<td>A nonce for use in short transaction ID calculations</td>\n</tr>\n<tr>\n<td>1 or 3</td>\n<td>shortids_<br>length</td>\n<td>CompactSize</td>\n<td>As used to encode array lengths elsewhere</td>\n<td>The number of short transaction IDs in <code>shortids</code> (i.e. block tx count - <code>prefilledtxn</code><br><code>_length</code>)</td>\n</tr>\n<tr>\n<td><em>Varies</em></td>\n<td>shortids</td>\n<td>List of 6-byte integers</td>\n<td>Little Endian</td>\n<td>The short transaction IDs calculated from the transactions which were not provided explicitly in <code>prefilledtxn</code></td>\n</tr>\n<tr>\n<td>1 or 3</td>\n<td>prefilledtxn<br>_length</td>\n<td>CompactSize</td>\n<td>As used to encode array lengths elsewhere</td>\n<td>The number of prefilled transactions in <code>prefilledtxn</code> (i.e. block tx count - <code>shortids</code><br><code>_length</code>)</td>\n</tr>\n<tr>\n<td><em>Varies</em></td>\n<td>prefilledtxn</td>\n<td>List of Prefilled<br>Transactions</td>\n<td>As defined by <code>Prefilled</code><br><code>Transaction</code> definition below</td>\n<td>Used to provide the coinbase transaction and a select few which we expect a peer may be missing</td>\n</tr>\n</tbody>\n</table></div>\n<h2 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-short-transaction-id-calculation\"></div><strong>Short Transaction ID calculation</strong><a class=\"fa fa-anchor\" href=\"#section-short-transaction-id-calculation\"></a></h2>\n<p>Short transaction IDs are used to represent a transaction without sending a full 256-bit hash. They are calculated as follows,</p>\n<ul>\n<li >A single-SHA256 hashing the &lt;&lt;glossary:block header&gt;&gt; with the nonce appended (in little-endian)</li><li >Running SipHash-2-4 with the input being the transaction ID and the keys (k0/k1) set to the first two little-endian 64-bit integers from the above hash, respectively.</li><li >Dropping the 2 most significant bytes from the SipHash output to make it 6 bytes.</li></ul>\n<p>The following annotated hexdump shows a <a href=\"core-ref-p2p-network-data-messages#cmpctblock\"><code>cmpctblock</code> message</a>. (The message header has been omitted.)</p>\n<pre><code class=\"lang-text\">00000020981178a4342cec6316296b2ad84c9b7cdf9f\n2688e5d0fe1a0003cd0000000000f64870f52a3d0125\n1336c9464961216732b25fbf288a51f25a0e81bffb20\ne9600194d85a64a50d1cc02b0181 ................ Block Header\n\n3151b67e5b418b9d ............................ Nonce\n\n01 .......................................... Short IDs Length: 1\n483edcd3c799 ................................ Short IDs\n\n01 .......................................... Prefilled Transaction Length: 1\n\nPrefilled Transactions\n| 00 ........................................ Index: 0\n|\n| Transaction 1 (Coinbase)\n| | 01000000 ................................ Transaction Version: 1\n| | 01 ...................................... Input count: 1\n| |\n| | Transaction input #1\n| | |\n| | | 00000000000000000000000000000000\n| | | 00000000000000000000000000000000 ..... Outpoint TXID\n| | | ffffffff ............................. Outpoint index number: UINT32_MAX\n| | |\n| | | 13 ................................... Bytes in sig. script: 19\n| | | 03daaf010e2f5032506f6f6c2d74444153482f Secp256k1 signature\n| | |\n| | | ffffffff ............................. Sequence number: UINT32_MAX\n| |\n| | 04 ..................................... Number of outputs: 04\n| |\n| | Transaction output #1\n| | | ffe5654200000000 ..................... Duffs (11.13974271 Dash)\n| | |\n| | | 19 ................................... Bytes in pubkey script: 25\n| | | | 76 ................................. OP_DUP\n| | | | a9 ................................. OP_HASH160\n| | | | 14 ................................. Push 20 bytes as data\n| | | | | b885cb21ad12e593c1a46d814df47ccb\n| | | | | 450a7d84 ......................... PubKey hash\n| | | | 88 ................................. OP_EQUALVERIFY\n| | | | ac ................................. OP_CHECKSIG\n| |\n| | [...] .................................. 3 more tx outputs omitted\n| |\n| | 00000000 ............................... locktime: 0 (a block height)\n</code></pre>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-getblocks\"></div>getblocks<a class=\"fa fa-anchor\" href=\"#section-getblocks\"></a></h1>\n<p>The <a href=\"core-ref-p2p-network-data-messages#getblocks\"><code>getblocks</code> message</a> requests an <a href=\"core-ref-p2p-network-data-messages#inv\"><code>inv</code> message</a> that provides &lt;&lt;glossary:block header&gt;&gt; hashes starting from a particular point in the &lt;&lt;glossary:block chain&gt;&gt;. It allows a &lt;&lt;glossary:peer&gt;&gt; which has been disconnected or started for the first time to get the data it needs to request the blocks it hasn&#39;t seen.</p>\n<p>Peers which have been disconnected may have &lt;&lt;glossary:stale blocks&gt;&gt; in their locally-stored block chain, so the <a href=\"core-ref-p2p-network-data-messages#getblocks\"><code>getblocks</code> message</a> allows the requesting peer to provide the receiving peer with multiple &lt;&lt;glossary:header&gt;&gt; hashes at heights on their local chain. This allows the receiving peer to find, within that list, the last header hash they had in common and reply with all subsequent header hashes.</p>\n<p><strong>Note:</strong> the receiving peer itself may respond with an <a href=\"core-ref-p2p-network-data-messages#inv\"><code>inv</code> message</a> containing header hashes of stale blocks.  It is up to the requesting peer to poll all of its peers to find the best block chain.</p>\n<p>If the receiving peer does not find a common header hash within the list, it will assume the last common block was the &lt;&lt;glossary:genesis block&gt;&gt; (block zero), so it will reply with in <a href=\"core-ref-p2p-network-data-messages#inv\"><code>inv</code> message</a> containing header hashes starting with block one (the first block after the genesis block).</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data Type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>4</td>\n<td>version</td>\n<td>uint32_t</td>\n<td>The protocol version number; the same as sent in the <a href=\"core-ref-p2p-network-control-messages#version\"><code>version</code> message</a>.</td>\n</tr>\n<tr>\n<td><em>Varies</em></td>\n<td>hash count</td>\n<td>compactSize uint</td>\n<td>The number of header hashes provided not including the stop hash.  There is no limit except that the byte size of the entire message must be below the <a href=\"https://github.com/dashpay/dash/blob/v0.15.x/src/serialize.h#L29\"><code>MAX_SIZE</code></a> limit; typically from 1 to 200 hashes are sent.</td>\n</tr>\n<tr>\n<td><em>Varies</em></td>\n<td>block header hashes</td>\n<td>char[32]</td>\n<td>One or more block header hashes (32 bytes each) in internal byte order.  Hashes should be provided in reverse order of block height, so highest-height hashes are listed first and lowest-height hashes are listed last.</td>\n</tr>\n<tr>\n<td>32</td>\n<td>stop hash</td>\n<td>char[32]</td>\n<td>The header hash of the last header hash being requested; set to all zeroes to request an <a href=\"core-ref-p2p-network-data-messages#inv\"><code>inv</code> message</a> with all subsequent header hashes (a maximum of 500 will be sent as a reply to this message; if you need more than 500, you will need to send another <a href=\"core-ref-p2p-network-data-messages#getblocks\"><code>getblocks</code> message</a> with a higher-height header hash as the first entry in block header hash field).</td>\n</tr>\n</tbody>\n</table></div>\n<p>The following annotated hexdump shows a <a href=\"core-ref-p2p-network-data-messages#getblocks\"><code>getblocks</code> message</a>.  (The message header has been omitted.)</p>\n<pre><code class=\"lang-text\">71110100 ........................... Protocol version: 70001\n02 ................................. Hash count: 2\n\nd39f608a7775b537729884d4e6633bb2\n105e55a16a14d31b0000000000000000 ... Hash #1\n\n5c3e6403d40837110a2e8afb602b1c01\n714bda7ce23bea0a0000000000000000 ... Hash #2\n\n00000000000000000000000000000000\n00000000000000000000000000000000 ... Stop hash\n</code></pre>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-getblocktxn\"></div>getblocktxn<a class=\"fa fa-anchor\" href=\"#section-getblocktxn\"></a></h1>\n<p><em>Added in protocol version 70209 of Dash Core as described by BIP152</em></p>\n<p>The <a href=\"core-ref-p2p-network-data-messages#getblocktxn\"><code>getblocktxn</code> message</a> requests a <a href=\"core-ref-p2p-network-data-messages#blocktxn\"><code>blocktxn</code> message</a> for any transactions that it has not seen after a compact block is received. It is defined as a message containing a serialized <code>BlockTransactionsRequest</code> message. Upon receipt of a properly-formatted <a href=\"core-ref-p2p-network-data-messages#getblocktxn\"><code>getblocktxn</code> message</a>, &lt;&lt;glossary:nodes&gt;&gt; which recently provided the sender of such a message with a <a href=\"core-ref-p2p-network-data-messages#cmpctblock\"><code>cmpctblock</code> message</a> for the block hash identified in this message must respond with either an appropriate <a href=\"core-ref-p2p-network-data-messages#blocktxn\"><code>blocktxn</code> message</a>, or a full block message.</p>\n<p>A <a href=\"core-ref-p2p-network-data-messages#blocktxn\"><code>blocktxn</code> message</a> response must contain exactly and only each transaction which is present in the appropriate block at the index specified in the <a href=\"core-ref-p2p-network-data-messages#getblocktxn\"><code>getblocktxn</code> message</a> indexes list, in the order requested.</p>\n<p>The structure of <code>BlockTransactionsRequest</code> is defined below.</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data Type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>32</td>\n<td>blockhash</td>\n<td>Binary blob</td>\n<td>The output from a double-SHA256 of the block header, as used elsewhere</td>\n<td>The blockhash of the block which the transactions being requested are in</td>\n</tr>\n<tr>\n<td><em>Varies</em></td>\n<td>indexes_length</td>\n<td>CompactSize uint</td>\n<td>As used to encode array lengths elsewhere</td>\n<td>The number of transactions requested</td>\n</tr>\n<tr>\n<td><em>Varies</em></td>\n<td>indexes</td>\n<td>CompactSize uint[]</td>\n<td>Differentially encoded</td>\n<td>Vector of compactSize containing the indexes of the transactions being requested in the block.</td>\n</tr>\n</tbody>\n</table></div>\n<p>The following annotated hexdump shows a <a href=\"core-ref-p2p-network-data-messages#getblocktxn\"><code>getblocktxn</code> message</a>.  (The message header has been omitted.)</p>\n<pre><code class=\"lang-text\">182327cb727da7d60541da793831fd0a\nb0509e79c8cd3d654cdf3a0100000000 ... Block Hash\n\n01 ................................. Index length: 1\n01 ................................. Index: 1\n</code></pre>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-getcfcheckpt\"></div>getcfcheckpt<a class=\"fa fa-anchor\" href=\"#section-getcfcheckpt\"></a></h1>\n<p><em>Added in protocol version 70223 of Dash Core as described by <a href=\"https://github.com/bitcoin/bips/blob/master/bip-0157.mediawiki\">BIP 157</a>.</em></p>\n<p>The <a href=\"core-ref-p2p-network-data-messages#getcfcheckpt\"><code>getcfcheckpt</code> message</a> requests verifiable filter headers for a range of blocks. The response to this message is a <a href=\"core-ref-p2p-network-data-messages#cfcheckpt\"><code>cfcheckpt</code> message</a>.</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data Type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>filter_type</td>\n<td>uint8_t</td>\n<td>Filter type for which headers are requested</td>\n</tr>\n<tr>\n<td>32</td>\n<td>stop_hash</td>\n<td>uint256</td>\n<td>The hash of the last block in the requested range</td>\n</tr>\n</tbody>\n</table></div>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-getcfheaders\"></div>getcfheaders<a class=\"fa fa-anchor\" href=\"#section-getcfheaders\"></a></h1>\n<p><em>Added in protocol version 70223 of Dash Core as described by <a href=\"https://github.com/bitcoin/bips/blob/master/bip-0157.mediawiki\">BIP 157</a>.</em></p>\n<p>The <a href=\"core-ref-p2p-network-data-messages#getcfheaders\"><code>getcfheaders</code> message</a> requests verifiable filter headers for a range of blocks. The response to this message is a <a href=\"core-ref-p2p-network-data-messages#cfheaders\"><code>cfheaders</code> message</a>.</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data Type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>filter_type</td>\n<td>uint8_t</td>\n<td>Filter type for which headers are requested</td>\n</tr>\n<tr>\n<td>4</td>\n<td>start_height</td>\n<td>uint32_t</td>\n<td>The height of the first block in the requested range</td>\n</tr>\n<tr>\n<td>32</td>\n<td>stop_hash</td>\n<td>uint256</td>\n<td>The hash of the last block in the requested range. Must be &gt;= <code>start_height</code> and the difference between them must be less than 2000.</td>\n</tr>\n</tbody>\n</table></div>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-getcfilters\"></div>getcfilters<a class=\"fa fa-anchor\" href=\"#section-getcfilters\"></a></h1>\n<p><em>Added in protocol version 70223 of Dash Core as described by <a href=\"https://github.com/bitcoin/bips/blob/master/bip-0157.mediawiki\">BIP 157</a>.</em></p>\n<p>The <a href=\"core-ref-p2p-network-data-messages#getcfilters\"><code>getcfilters</code> message</a> requests compact filters of a particular type for a particular range of blocks. The response to this message is a <a href=\"core-ref-p2p-network-data-messages#cfilter\"><code>cfilter</code> message</a>.</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data Type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>filter_type</td>\n<td>uint8_t</td>\n<td>Filter type for which headers are requested</td>\n</tr>\n<tr>\n<td>4</td>\n<td>start_height</td>\n<td>uint32_t</td>\n<td>The height of the first block in the requested range</td>\n</tr>\n<tr>\n<td>32</td>\n<td>stop_hash</td>\n<td>uint256</td>\n<td>The hash of the last block in the requested range</td>\n</tr>\n</tbody>\n</table></div>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-getdata\"></div>getdata<a class=\"fa fa-anchor\" href=\"#section-getdata\"></a></h1>\n<p>The <a href=\"core-ref-p2p-network-data-messages#getdata\"><code>getdata</code> message</a> requests one or more data objects from another &lt;&lt;glossary:node&gt;&gt;. The objects are requested by an inventory, which the requesting node typically previously received by way of an <a href=\"core-ref-p2p-network-data-messages#inv\"><code>inv</code> message</a>.</p>\n<p>The response to a <a href=\"core-ref-p2p-network-data-messages#getdata\"><code>getdata</code> message</a> can be a <a href=\"core-ref-p2p-network-data-messages#tx\"><code>tx</code> message</a>, <a href=\"core-ref-p2p-network-data-messages#block\"><code>block</code> message</a>, <a href=\"core-ref-p2p-network-data-messages#merkleblock\"><code>merkleblock</code> message</a>, <a href=\"core-ref-p2p-network-privatesend-messages#dstx\"><code>dstx</code> message</a>, <a href=\"core-ref-p2p-network-governance-messages#govobj\"><code>govobj</code> message</a>, <a href=\"core-ref-p2p-network-governance-messages#govobjvote\"><code>govobjvote</code> message</a>, <a href=\"core-ref-p2p-network-data-messages#notfound\"><code>notfound</code> message</a>, <a href=\"core-ref-p2p-network-data-messages#cmpctblock\"><code>cmpctblock</code> message</a>, or any other messages that are exchanged by way of <a href=\"core-ref-p2p-network-data-messages#inv\"><code>inv</code> messages</a>.</p>\n<p>This message cannot be used to request arbitrary data, such as historic transactions no longer in the memory pool or relay set. Full nodes may not even be able to provide older &lt;&lt;glossary:blocks&gt;&gt; if they&#39;ve pruned old transactions from their block database. For this reason, the <a href=\"core-ref-p2p-network-data-messages#getdata\"><code>getdata</code> message</a> should usually only be used to request data from a node which previously advertised it had that data by sending an <a href=\"core-ref-p2p-network-data-messages#inv\"><code>inv</code> message</a>.</p>\n<p>The format and maximum size limitations of the <a href=\"core-ref-p2p-network-data-messages#getdata\"><code>getdata</code> message</a> are identical to the <a href=\"core-ref-p2p-network-data-messages#inv\"><code>inv</code> message</a>; only the message header differs.</p>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-getheaders\"></div>getheaders<a class=\"fa fa-anchor\" href=\"#section-getheaders\"></a></h1>\n<p><em>Added in protocol version 70077.</em></p>\n<p>The <a href=\"core-ref-p2p-network-data-messages#getheaders\"><code>getheaders</code> message</a> requests a <a href=\"core-ref-p2p-network-data-messages#headers\"><code>headers</code> message</a> that provides block headers starting from a particular point in the &lt;&lt;glossary:block chain&gt;&gt;. It allows a &lt;&lt;glossary:peer&gt;&gt; which has been disconnected or started for the first time to get the &lt;&lt;glossary:headers&gt;&gt; it hasn\u2019t seen yet.</p>\n<p>The <a href=\"core-ref-p2p-network-data-messages#getheaders\"><code>getheaders</code> message</a> is nearly identical to the <a href=\"core-ref-p2p-network-data-messages#getblocks\"><code>getblocks</code> message</a>, with one minor difference: the <code>inv</code> reply to the <a href=\"core-ref-p2p-network-data-messages#getblocks\"><code>getblocks</code> message</a> will include no more than 500 &lt;&lt;glossary:block header&gt;&gt; hashes; the <code>headers</code> reply to the <a href=\"core-ref-p2p-network-data-messages#getheaders\"><code>getheaders</code> message</a> will include as many as 2,000 block headers.</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data Type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>4</td>\n<td>version</td>\n<td>uint32_t</td>\n<td>The protocol version number; the same as sent in the <a href=\"core-ref-p2p-network-control-messages#version\"><code>version</code> message</a>.</td>\n</tr>\n<tr>\n<td><em>Varies</em></td>\n<td>hash count</td>\n<td>compactSize uint</td>\n<td>The number of header hashes provided not including the stop hash.</td>\n</tr>\n<tr>\n<td><em>Varies</em></td>\n<td>block header hashes</td>\n<td>char[32]</td>\n<td>One or more block header hashes (32 bytes each) in internal byte order.  Hashes should be provided in reverse order of block height, so highest-height hashes are listed first and lowest-height hashes are listed last.</td>\n</tr>\n<tr>\n<td>32</td>\n<td>stop hash</td>\n<td>char[32]</td>\n<td>The header hash of the last header hash being requested; set to all zeroes to request as many blocks as possible (2000).</td>\n</tr>\n</tbody>\n</table></div>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-getheaders-2\"></div>getheaders2<a class=\"fa fa-anchor\" href=\"#section-getheaders-2\"></a></h1>\n<p><em>Added in protocol version 70223 of Dash Core.</em></p>\n<p>The <a href=\"core-ref-p2p-network-data-messages#getheaders2\"><code>getheaders2</code> message</a> requests a <a href=\"core-ref-p2p-network-data-messages#headers2\"><code>headers2</code> message</a> that provides block headers starting from a particular point in the &lt;&lt;glossary:block chain&gt;&gt;. It allows a &lt;&lt;glossary:peer&gt;&gt; which has been disconnected or started for the first time to get the &lt;&lt;glossary:headers&gt;&gt; it hasn\u2019t seen yet.</p>\n<p>The <a href=\"core-ref-p2p-network-data-messages#getheaders2\"><code>getheaders2</code> message</a> contains the same fields as the <a href=\"core-ref-p2p-network-data-messages#getheaders\"><code>getheaders</code> message</a>.</p>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-getmnlistd\"></div>getmnlistd<a class=\"fa fa-anchor\" href=\"#section-getmnlistd\"></a></h1>\n<p><em>Added in protocol version 70213</em></p>\n<p>The <a href=\"core-ref-p2p-network-data-messages#getmnlistd\"><code>getmnlistd</code> message</a> requests a <a href=\"core-ref-p2p-network-data-messages#mnlistdiff\"><code>mnlistdiff</code> message</a> that provides either:</p>\n<ol>\n<li  value=\"1\">A full &lt;&lt;glossary:masternode&gt;&gt; list (if <code>baseBlockHash</code> is all-zero)</li><li  value=\"2\">An update to a previously requested masternode list</li></ol>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data type</th>\n<th>Required</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>32</td>\n<td>baseBlockHash</td>\n<td>uint256</td>\n<td>Required</td>\n<td>Hash of a block the requester already has a valid masternode list of.<br><em>Note: Can be all-zero to indicate that a full masternode list is requested.</em></td>\n</tr>\n<tr>\n<td>32</td>\n<td>blockHash</td>\n<td>uint256</td>\n<td>Required</td>\n<td>Hash of the block for which the masternode list diff is requested</td>\n</tr>\n</tbody>\n</table></div>\n<p>The following annotated hexdump shows a <a href=\"core-ref-p2p-network-data-messages#getmnlistd\"><code>getmnlistd</code> message</a>. (The message header has been omitted.)</p>\n<pre><code class=\"lang-text\">000001ee5108348a2c59396da29dc576\n9b2a9bb303d7577aee9cd95136c49b9b ........... Base block hash\n\n0000030f51f12e7069a7aa5f1bc9085d\ndb3fe368976296fd3b6d73fdaf898cc0 ........... Block hash\n</code></pre>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-getqrinfo\"></div>getqrinfo<a class=\"fa fa-anchor\" href=\"#section-getqrinfo\"></a></h1>\n<p><em>Added in protocol version 70222 of Dash Core.</em></p>\n<p>The <code>getqrinfo</code> message requests a <a href=\"core-ref-p2p-network-data-messages#qrinfo\"><code>qrinfo</code> message</a> that provides the information required to verify quorum details for quorums formed using the quorum rotation process.</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data type</th>\n<th>Required</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>4</td>\n<td>baseBlockHashesNb</td>\n<td>uint32</td>\n<td>Required</td>\n<td>Number of masternode lists the light client already knows (up to 4)</td>\n</tr>\n<tr>\n<td>Varies</td>\n<td>baseBlockHashes</td>\n<td>uint256[]</td>\n<td>Required</td>\n<td>Array of base block hashes for the masternode lists the light client already knows</td>\n</tr>\n<tr>\n<td>32</td>\n<td>blockRequestHash</td>\n<td>uint256</td>\n<td>Required</td>\n<td>Hash of the block for which the masternode list diff is requested</td>\n</tr>\n<tr>\n<td>1</td>\n<td>extraShare</td>\n<td>bool</td>\n<td>Optional</td>\n<td>Flag to indicate if an extra share is requested</td>\n</tr>\n</tbody>\n</table></div>\n<p>The following annotated hexdump shows a <a href=\"core-ref-p2p-network-data-messages#getqrinfo\"><code>getqrinfo</code> message</a>. (The message header has been omitted.)</p>\n<pre><code class=\"lang-text\">05 ................................. Number of base block hashes: 5\n\n\ncb6f9b4f2145f2e3fcf270737ad34d7e\n51cdb9e98f2580927c52b35f62010000 ... Base block hash 1\n8cfa868eb5adfdfb6ae333b790980f2d\n0737c64ccd716ce6b63969f481010000 ... Base block hash 2\n41e452b5187bc71a1e92c42c8e38f04b\n8c83b12415f7a73b292f5c79c9000000 ... Base block hash 3\n0387850f96fb9888bb445cce15b56603\n019df551c246e237ff3a6107e8020000 ... Base block hash 4\n7ab87c8f16f60fdba20102d348a0af08\n2a6590759c6535aa48941e807e020000 ... Base block hash 5\n\nd7b9d67da4a3016c62fcc37157032126\n46d11c2b3c533ccf9bb56f7540000000 ... Block request hash\n\n00 ................................. Extra share: false\n</code></pre>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-headers\"></div>headers<a class=\"fa fa-anchor\" href=\"#section-headers\"></a></h1>\n<p><em>Added in protocol version 31800 (of Bitcoin).</em></p>\n<p>The <a href=\"core-ref-p2p-network-data-messages#headers\"><code>headers</code> message</a> sends block headers to a &lt;&lt;glossary:node&gt;&gt; which previously requested certain &lt;&lt;glossary:headers&gt;&gt; with a <a href=\"core-ref-p2p-network-data-messages#getheaders\"><code>getheaders</code> message</a>. A headers message can be empty.</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data Type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><em>Varies</em></td>\n<td>count</td>\n<td>compactSize uint</td>\n<td>Number of block headers up to a maximum of 2,000.  Note: headers-first sync assumes the sending node will send the maximum number of headers whenever possible.</td>\n</tr>\n<tr>\n<td><em>Varies</em></td>\n<td>headers</td>\n<td>block_header</td>\n<td>Block headers: each 80-byte block header is in the format described in the <a href=\"core-ref-block-chain-block-headers\">block headers section</a> with an additional 0x00 suffixed.  This 0x00 is called the transaction count, but because the headers message doesn&#39;t include any transactions, the transaction count is always zero.</td>\n</tr>\n</tbody>\n</table></div>\n<p>The following annotated hexdump shows a <a href=\"core-ref-p2p-network-data-messages#headers\"><code>headers</code> message</a>.  (The message header has been omitted.)</p>\n<pre><code class=\"lang-text\">01 ................................. Header count: 1\n\n02000000 ........................... Block version: 2\nb6ff0b1b1680a2862a30ca44d346d9e8\n910d334beb48ca0c0000000000000000 ... Hash of previous block&#39;s header\n9d10aa52ee949386ca9385695f04ede2\n70dda20810decd12bc9b048aaab31471 ... Merkle root\n24d95a54 ........................... Unix time: 1415239972\n30c31b18 ........................... Target (bits)\nfe9f0864 ........................... Nonce\n\n00 ................................. Transaction count (0x00)\n</code></pre>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-headers-2\"></div>headers2<a class=\"fa fa-anchor\" href=\"#section-headers-2\"></a></h1>\n<p><em>Added in protocol version 70223 of Dash Core.</em></p>\n<p>The <a href=\"core-ref-p2p-network-data-messages#headers2\"><code>headers2</code> message</a> sends compressed block headers to a &lt;&lt;glossary:node&gt;&gt; which previously requested certain &lt;&lt;glossary:headers&gt;&gt; with a <a href=\"core-ref-p2p-network-data-messages#getheaders\"><code>getheaders2</code> message</a> or indicated it wants to receive them by signaling with a <a href=\"core-ref-p2p-network-control-messages#sendheaders2\"><code>sendheaders2</code> message</a>.</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data Type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><em>Varies</em></td>\n<td>count</td>\n<td>compactSize uint</td>\n<td>Number of block headers up to a maximum of 2,000.  Note: headers-first sync assumes the sending node will send the maximum number of headers whenever possible.</td>\n</tr>\n<tr>\n<td><em>Varies</em></td>\n<td>headers</td>\n<td>block_header2</td>\n<td>Block headers in the <a href=\"https://github.com/thephez/dips/blob/compressed-headers/compressed-headers.md#block_header2-data-type\"><code>block_header2</code></a> format<br><strong>Note</strong>: the first header will always be uncompressed.</td>\n</tr>\n</tbody>\n</table></div>\n<p>The following annotated hexdump shows a <a href=\"core-ref-p2p-network-data-messages#headers2\"><code>headers2</code> message</a>.  (The message header has been omitted.)</p>\n<pre><code class=\"lang-text\">fdd007 ............................. Header count: 2000 (0x07d0)\n\nHeader 1 (uncompressed)\n| 38 ............................... Bitfield (0x00100110)\n| 02000000 ......................... Block version\n| 2cbcf83b62913d56f605c0e581a48872\n| 839428c92e5eb76cd7ad94bcaf0b0000 . Hash of previous block&#39;s header\n| 7f11dcce14075520e8f74cc4ddf092b4\n| e26ebd23b8d8665a1ae5bfc41b58fdb4 . Merkle root\n| c3a95e53 ......................... Unix time: 1398712771\n| ffff0f1e ......................... Target (bits)\n| f37a0000 ......................... Nonce\n\nHeader 2 (previous header and time compressed)\n| 20 ............................... Bitfield (0x00100000)\n| 02000000 ......................... Block version\n| .................................. Hash of previous block&#39;s header (compressed)\n| 4d29e4f9b2e05a9ac97dd5ae4128b3c0\n| 104bdc95aabaa566cc8eeb682e336d0d . Merkle root\n| 0100 ............................. Unix time (compressed)\n| f0ff0f1e ......................... Target (bits)\n| 7b190000 ......................... Nonce\n\nHeader 3 (block version, previous header, time, and bits compressed)\n| 01 ............................... Bitfield (0x00000001)\n| .................................. Block version (compressed)\n| .................................. Hash of previous block&#39;s header (compressed)\n| 58968247522cc488db01996de610d6f3\n| b8c348e748198dc528a305941211c71c . Merkle root\n| 0200 ............................. Unix time (compressed)\n| .................................. Target (bits) (compressed)\n| 7b190000 ......................... Nonce\n\n... Remaining headers truncated\n</code></pre>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-inv\"></div>inv<a class=\"fa fa-anchor\" href=\"#section-inv\"></a></h1>\n<p>The <a href=\"core-ref-p2p-network-data-messages#inv\"><code>inv</code> message</a> (inventory message) transmits one or more &lt;&lt;glossary:inventories&gt;&gt; of objects known to the transmitting &lt;&lt;glossary:peer&gt;&gt;.  It can be sent unsolicited to announce new &lt;&lt;glossary:transactions&gt;&gt; or &lt;&lt;glossary:blocks&gt;&gt;, or it can be sent in reply to a <a href=\"core-ref-p2p-network-data-messages#getblocks\"><code>getblocks</code> message</a> or <a href=\"core-ref-p2p-network-data-messages#mempool\"><code>mempool</code> message</a>.</p>\n<p>The receiving peer can compare the inventories from an <a href=\"core-ref-p2p-network-data-messages#inv\"><code>inv</code> message</a> against the inventories it has already seen, and then use a follow-up message to request unseen objects.</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data Type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><em>Varies</em></td>\n<td>count</td>\n<td>compactSize uint</td>\n<td>The number of inventory entries.</td>\n</tr>\n<tr>\n<td><em>Varies</em></td>\n<td>inventory</td>\n<td>inventory</td>\n<td>One or more inventory entries up to a maximum of 50,000 entries.</td>\n</tr>\n</tbody>\n</table></div>\n<p>The following annotated hexdump shows an <a href=\"core-ref-p2p-network-data-messages#inv\"><code>inv</code> message</a> with two inventory entries.  (The message header has been omitted.)</p>\n<pre><code class=\"lang-text\">02 ................................. Count: 2\n\n0f000000 ........................... Type: MSG_MASTERNODE_PING\ndd6cc6c11211793b239c2e311f1496e2\n2281b200b35233eaae465d2aa3c9d537 ... Hash (mnp)\n\n05000000 ........................... Type: MSG_TXLOCK_VOTE\nafc5b2f418f8c06c477a7d071240f5ee\nab17057f9ce4b50c2aef4fadf3729a2e ... Hash (txlvote)\n</code></pre>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-mempool\"></div>mempool<a class=\"fa fa-anchor\" href=\"#section-mempool\"></a></h1>\n<p><em>Added in protocol version 60002 (of Bitcoin).</em></p>\n<p>The <a href=\"core-ref-p2p-network-data-messages#mempool\"><code>mempool</code> message</a> requests the &lt;&lt;glossary:TXIDs&gt;&gt; of transactions that the receiving &lt;&lt;glossary:node&gt;&gt; has verified as valid but which have not yet appeared in a &lt;&lt;glossary:block&gt;&gt;. That is, transactions which are in the receiving node&#39;s memory pool. The response to the <a href=\"core-ref-p2p-network-data-messages#mempool\"><code>mempool</code> message</a> is one or more <a href=\"core-ref-p2p-network-data-messages#inv\"><code>inv</code> messages</a> containing the TXIDs in the usual &lt;&lt;glossary:inventory&gt;&gt; format.</p>\n<p>Sending the <a href=\"core-ref-p2p-network-data-messages#mempool\"><code>mempool</code> message</a> is mostly useful when a program first connects to the network. Full nodes can use it to quickly gather most or all of the unconfirmed transactions available on the network; this is especially useful for miners trying to gather transactions for their transaction fees. SPV clients can set a filter before sending a <code>mempool</code> to only receive transactions that match that filter; this allows a recently-started client to get most or all unconfirmed transactions related to its wallet.</p>\n\n</div>\n<div class=\"magic-block-callout type-info \">\n\t<h3><i title=\"Info\" class=\"fa fa-info-circle\"></i>InstantSend and ChainLock Synchronization\n\t</h3>\n\t<div class=\"callout-body\"><p>Dash Core 0.15.0 expanded the mempool message to include syncing of <a href=\"core-ref-p2p-network-instantsend-messages#islock\">InstantSend Lock</a> inventories. Additionally, nodes now attempt to sync their mempool with peers at startup by default (limited to peers using protocol version 70216 or higher). This allows nodes to more quickly detect any double-spend attempts as well as show InstantSend lock status correctly for transactions received while offline.</p>\n<p>Dash Core 0.17.0 expanded the mempool message to include syncing of <a href=\"core-ref-p2p-network-instantsend-messages#clsig\">ChainLock</a> inventories. This allows nodes to more quickly show ChainLock status correctly after being offline.</p>\n\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><p>The <code>inv</code> response to the <a href=\"core-ref-p2p-network-data-messages#mempool\"><code>mempool</code> message</a> is, at best, one node&#39;s view of the network---not a complete list of every &lt;&lt;glossary:unconfirmed transaction&gt;&gt; on the network. Here are some additional reasons the list might not be complete:</p>\n<ul>\n<li >The <a href=\"core-ref-p2p-network-data-messages#mempool\"><code>mempool</code> message</a> is not currently fully compatible with the <a href=\"core-ref-p2p-network-control-messages#filterload\"><code>filterload</code> message</a>&#39;s <code>BLOOM_UPDATE_ALL</code> and <code>BLOOM_UPDATE_P2PUBKEY_ONLY</code> flags. Mempool transactions are not sorted like in-block transactions, so a transaction (tx2) spending an &lt;&lt;glossary:output&gt;&gt; can appear before the transaction (tx1) containing that output, which means the automatic filter update mechanism won&#39;t operate until the second-appearing transaction (tx1) is seen---missing the first-appearing transaction (tx2). It has been proposed in <a href=\"https://github.com/bitcoin/bitcoin/issues/2381\">Bitcoin Core issue #2381</a> that the transactions should be sorted before being processed by the filter.</li></ul>\n<p>There is no payload in a <a href=\"core-ref-p2p-network-data-messages#mempool\"><code>mempool</code> message</a>.  See the <a href=\"core-ref-p2p-network-message-headers\">message header section</a> for an example of a message without a payload.</p>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-merkleblock\"></div>merkleblock<a class=\"fa fa-anchor\" href=\"#section-merkleblock\"></a></h1>\n<p><em>Added in protocol version 70001 as described by BIP37.</em></p>\n<p>The <a href=\"core-ref-p2p-network-data-messages#merkleblock\"><code>merkleblock</code> message</a> is a reply to a <a href=\"core-ref-p2p-network-data-messages#getdata\"><code>getdata</code> message</a> which requested a &lt;&lt;glossary:block&gt;&gt; using the inventory type <code>MSG_MERKLEBLOCK</code>.  It is only part of the reply: if any matching transactions are found, they will be sent separately as <a href=\"core-ref-p2p-network-data-messages#tx\"><code>tx</code> messages</a>. As of Dash Core 0.17.0 <a href=\"core-ref-p2p-network-instantsend-messages#islock\"><code>islock</code> messages</a> for matching transactions are sent if present.</p>\n\n</div>\n<div class=\"magic-block-callout type-warning no-title\"><span class=\"noTitleIcon\"><i title=\"Warning\" class=\"fa fa-exclamation-circle\"></i></span>\n\t<div class=\"callout-body\"><p>Note: <code>islock</code> messages are currently dropped once a ChainLock is present so in most cases they will not actually be provided in response to a merkleblock request. Future updates may modify this behavior.</p>\n\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><p>If a filter has been previously set with the <a href=\"core-ref-p2p-network-control-messages#filterload\"><code>filterload</code> message</a>, the <a href=\"core-ref-p2p-network-data-messages#merkleblock\"><code>merkleblock</code> message</a> will contain the &lt;&lt;glossary:TXIDs&gt;&gt; of any transactions in the requested block that matched the filter, as well as any parts of the block&#39;s &lt;&lt;glossary:merkle tree&gt;&gt; necessary to connect those transactions to the block header&#39;s &lt;&lt;glossary:merkle root&gt;&gt;. The message also contains a complete copy of the &lt;&lt;glossary:block header&gt;&gt; to allow the client to hash it and confirm its &lt;&lt;glossary:proof of work&gt;&gt;.</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data Type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>80</td>\n<td>block header</td>\n<td>block_header</td>\n<td>The block header in the format described in the <a href=\"core-ref-block-chain-block-headers\">block header section</a>.</td>\n</tr>\n<tr>\n<td>4</td>\n<td>transaction count</td>\n<td>uint32_t</td>\n<td>The number of transactions in the block (including ones that don&#39;t match the filter).</td>\n</tr>\n<tr>\n<td><em>Varies</em></td>\n<td>hash count</td>\n<td>compactSize uint</td>\n<td>The number of hashes in the following field.</td>\n</tr>\n<tr>\n<td><em>Varies</em></td>\n<td>hashes</td>\n<td>char[32]</td>\n<td>One or more hashes of both transactions and merkle nodes in internal byte order.  Each hash is 32 bytes.</td>\n</tr>\n<tr>\n<td><em>Varies</em></td>\n<td>flag byte count</td>\n<td>compactSize uint</td>\n<td>The number of flag bytes in the following field.</td>\n</tr>\n<tr>\n<td><em>Varies</em></td>\n<td>flags</td>\n<td>byte[]</td>\n<td>A sequence of bits packed eight in a byte with the least significant bit first.  May be padded to the nearest byte boundary but must not contain any more bits than that.  Used to assign the hashes to particular nodes in the merkle tree as described below.</td>\n</tr>\n</tbody>\n</table></div>\n<p>The annotated hexdump below shows a <a href=\"core-ref-p2p-network-data-messages#merkleblock\"><code>merkleblock</code> message</a> which corresponds to the examples below.  (The message header has been omitted.)</p>\n<pre><code class=\"lang-text\">01000000 ........................... Block version: 1\n82bb869cf3a793432a66e826e05a6fc3\n7469f8efb7421dc88067010000000000 ... Hash of previous block&#39;s header\n7f16c5962e8bd963659c793ce370d95f\n093bc7e367117b3c30c1f8fdd0d97287 ... Merkle root\n76381b4d ........................... Time: 1293629558\n4c86041b ........................... nBits: 0x04864c * 256**(0x1b-3)\n554b8529 ........................... Nonce\n\n07000000 ........................... Transaction count: 7\n04 ................................. Hash count: 4\n\n3612262624047ee87660be1a707519a4\n43b1c1ce3d248cbfc6c15870f6c5daa2 ... Hash #1\n019f5b01d4195ecbc9398fbf3c3b1fa9\nbb3183301d7a1fb3bd174fcfa40a2b65 ... Hash #2\n41ed70551dd7e841883ab8f0b16bf041\n76b7d1480e4f0af9f3d4c3595768d068 ... Hash #3\n20d2a7bc994987302e5b1ac80fc425fe\n25f8b63169ea78e68fbaaefa59379bbf ... Hash #4\n\n01 ................................. Flag bytes: 1\n1d ................................. Flags: 1 0 1 1 1 0 0 0\n</code></pre>\n<p>Note: when fully decoded, the above <a href=\"core-ref-p2p-network-data-messages#merkleblock\"><code>merkleblock</code> message</a> provided the TXID for a single transaction that matched the filter. In the &lt;&lt;glossary:network&gt;&gt; traffic dump this output was taken from, the full transaction belonging to that TXID was sent immediately after the <a href=\"core-ref-p2p-network-data-messages#merkleblock\"><code>merkleblock</code> message</a> as a <a href=\"core-ref-p2p-network-data-messages#tx\"><code>tx</code> message</a>.</p>\n<h2 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-parsing-a-merkle-block-message\"></div>Parsing A MerkleBlock Message<a class=\"fa fa-anchor\" href=\"#section-parsing-a-merkle-block-message\"></a></h2>\n<p>As seen in the annotated hexdump above, the <a href=\"core-ref-p2p-network-data-messages#merkleblock\"><code>merkleblock</code> message</a> provides three special data types: a transaction count, a list of hashes, and a list of one-bit flags.</p>\n<p>You can use the transaction count to construct an empty &lt;&lt;glossary:merkle tree&gt;&gt;. We&#39;ll call each entry in the tree a node; on the bottom are TXID nodes---the hashes for these nodes are &lt;&lt;glossary:TXIDs&gt;&gt;; the remaining nodes (including the &lt;&lt;glossary:merkle root&gt;&gt;) are non-TXID nodes---they may actually have the same hash as a TXID, but we treat them differently.</p>\n<p><img src=\"https://dash-docs.github.io/img/dev/animated-en-merkleblock-parsing.gif\" alt=\"Example Of Parsing A MerkleBlock Message\"></p>\n<p>Keep the hashes and flags in the order they appear in the <a href=\"core-ref-p2p-network-data-messages#merkleblock\"><code>merkleblock</code> message</a>. When we say &quot;next flag&quot; or &quot;next hash&quot;, we mean the next flag or hash on the list, even if it&#39;s the first one we&#39;ve used so far.</p>\n<p>Start with the merkle root node and the first flag. The table below describes how to evaluate a flag based on whether the node being processed is a TXID node or a non-TXID node. Once you apply a flag to a node, never apply another flag to that same node or reuse that same flag again.</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Flag</th>\n<th>TXID Node</th>\n<th>Non-TXID Node</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>0</strong></td>\n<td>Use the next hash as this node&#39;s TXID, but this transaction didn&#39;t match the filter.</td>\n<td>Use the next hash as this node&#39;s hash.  Don&#39;t process any descendant nodes.</td>\n</tr>\n<tr>\n<td><strong>1</strong></td>\n<td>Use the next hash as this node&#39;s TXID, and mark this transaction as matching the filter.</td>\n<td>The hash needs to be computed.  Process the left child node to get its hash; process the right child node to get its hash; then concatenate the two hashes as 64 raw bytes and hash them to get this node&#39;s hash.</td>\n</tr>\n</tbody>\n</table></div>\n<p>Any time you begin processing a node for the first time, evaluate the next flag. Never use a flag at any other time.</p>\n<p>When processing a child node, you may need to process its children (the grandchildren of the original node) or further-descended nodes before returning to the parent node. This is expected---keep processing depth first until you reach a TXID node or a non-TXID node with a flag of 0.</p>\n<p>After you process a TXID node or a non-TXID node with a flag of 0, stop processing flags and begin to ascend the tree. As you ascend, compute the hash of any nodes for which you now have both child hashes or for which you now have the sole child hash. See the <a href=\"core-ref-block-chain-block-headers#merkle-trees\">merkle tree section</a> for hashing instructions. If you reach a node where only the left hash is known, descend into its right child (if present) and further descendants as necessary.</p>\n<p>However, if you find a node whose left and right children both have the same hash, fail.  This is related to CVE-2012-2459.</p>\n<p>Continue descending and ascending until you have enough information to obtain the hash of the merkle root node. If you run out of flags or hashes before that condition is reached, fail. Then perform the following checks (order doesn&#39;t matter):</p>\n<ul>\n<li ><p>Fail if there are unused hashes in the hashes list.</p>\n</li><li ><p>Fail if there are unused flag bits---except for the minimum number of bits necessary to pad up to the next full byte.</p>\n</li><li ><p>Fail if the hash of the merkle root node is not identical to the merkle root in the &lt;&lt;glossary:block header&gt;&gt;.</p>\n</li><li ><p>Fail if the block header is invalid. Remember to ensure that the hash of the header is less than or equal to the &lt;&lt;glossary:target threshold&gt;&gt; encoded by the nBits header field. Your program should also, of course, attempt to ensure the header belongs to the best block chain and that the user knows how many confirmations this block has.</p>\n</li></ul>\n<p>For a detailed example of parsing a <a href=\"core-ref-p2p-network-data-messages#merkleblock\"><code>merkleblock</code> message</a>, please see the corresponding <a href=\"core-example-p2p-network-parsing-a-merkleblock\">merkle block examples section</a>.</p>\n<h2 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-creating-a-merkle-block-message\"></div>Creating A MerkleBlock Message<a class=\"fa fa-anchor\" href=\"#section-creating-a-merkle-block-message\"></a></h2>\n<p>It&#39;s easier to understand how to create a <a href=\"core-ref-p2p-network-data-messages#merkleblock\"><code>merkleblock</code> message</a> after you understand how to parse an already-created message, so we recommend you read the parsing section above first.</p>\n<p>Create a complete merkle tree with &lt;&lt;glossary:TXIDs&gt;&gt; on the bottom row and all the other hashes calculated up to the &lt;&lt;glossary:merkle root&gt;&gt; on the top row. For each transaction that matches the filter, track its TXID node and all of its ancestor nodes.</p>\n<p><img src=\"https://dash-docs.github.io/img/dev/animated-en-merkleblock-creation.gif\" alt=\"Example Of Creating A MerkleBlock Message\"></p>\n<p>Start processing the tree with the &lt;&lt;glossary:merkle root&gt;&gt; node. The table below describes how to process both TXID nodes and non-TXID nodes based on whether the node is a match, a match ancestor, or neither a match nor a match ancestor.</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th></th>\n<th>TXID Node</th>\n<th>Non-TXID Node</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>Neither Match Nor Match Ancestor</strong></td>\n<td>Append a 0 to the flag list; append this node&#39;s TXID to the hash list.</td>\n<td>Append a 0 to the flag list; append this node&#39;s hash to the hash list.  Do not descend into its child nodes.</td>\n</tr>\n<tr>\n<td><strong>Match Or Match Ancestor</strong></td>\n<td>Append a 1 to the flag list; append this node&#39;s TXID to the hash list.</td>\n<td>Append a 1 to the flag list; process the left child node.  Then, if the node has a right child, process the right child.  Do not append a hash to the hash list for this node.</td>\n</tr>\n</tbody>\n</table></div>\n<p>Any time you begin processing a node for the first time, a flag should be appended to the flag list. Never put a flag on the list at any other time, except when processing is complete to pad out the flag list to a byte boundary.</p>\n<p>When processing a child node, you may need to process its children (the grandchildren of the original node) or further-descended nodes before returning to the parent node. This is expected---keep processing depth first until you reach a TXID node or a node which is neither a TXID nor a match ancestor.</p>\n<p>After you process a TXID node or a node which is neither a TXID nor a match ancestor, stop processing and begin to ascend the tree until you find a node with a right child you haven&#39;t processed yet. Descend into that right child and process it.</p>\n<p>After you fully process the merkle root node according to the instructions in the table above, processing is complete.  Pad your flag list to a byte boundary and construct the <a href=\"core-ref-p2p-network-data-messages#merkleblock\"><code>merkleblock</code> message</a> using the template near the beginning of this subsection.</p>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-mnlistdiff\"></div>mnlistdiff<a class=\"fa fa-anchor\" href=\"#section-mnlistdiff\"></a></h1>\n<p><em>Added in protocol version 70213</em></p>\n<p>The <a href=\"core-ref-p2p-network-data-messages#mnlistdiff\"><code>mnlistdiff</code> message</a> is a reply to a <a href=\"core-ref-p2p-network-data-messages#getmnlistd\"><code>getmnlistd</code> message</a> which requested either a full &lt;&lt;glossary:masternode&gt;&gt; list or a diff for a range of &lt;&lt;glossary:blocks&gt;&gt;.</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data<br>type</th>\n<th>Required</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>32</td>\n<td>baseBlockHash</td>\n<td>uint256</td>\n<td>Required</td>\n<td>Hash of a block the requester already has a valid masternode list of. Can be all-zero to indicate that a full masternode list is requested.</td>\n</tr>\n<tr>\n<td>32</td>\n<td>blockHash</td>\n<td>uint256</td>\n<td>Required</td>\n<td>Hash of the block for which the masternode list diff is requested</td>\n</tr>\n<tr>\n<td>4</td>\n<td>totalTransactions</td>\n<td>uint32_t</td>\n<td>Required</td>\n<td>Number of total transactions in <code>blockHash</code></td>\n</tr>\n<tr>\n<td>1-9</td>\n<td>merkleHashes<br>Count</td>\n<td>compactSize uint</td>\n<td>Required</td>\n<td>Number of Merkle hashes</td>\n</tr>\n<tr>\n<td>variable</td>\n<td>merkleHashes</td>\n<td>vector</td>\n<td>Required</td>\n<td>Merkle hashes in depth-first order</td>\n</tr>\n<tr>\n<td>1-9</td>\n<td>merkleFlags<br>Count</td>\n<td>compactSize uint</td>\n<td>Required</td>\n<td>Number of Merkle flag bytes</td>\n</tr>\n<tr>\n<td>variable</td>\n<td>merkleFlags</td>\n<td>vector&lt;uint8_t&gt;</td>\n<td>Required</td>\n<td>Merkle flag bits, packed per 8 in a byte, least significant bit first</td>\n</tr>\n<tr>\n<td>variable</td>\n<td>cbTx</td>\n<td>CTransaction</td>\n<td>Required</td>\n<td>The fully serialized coinbase transaction of <code>blockHash</code></td>\n</tr>\n<tr>\n<td>1-9</td>\n<td>deletedMNsCount</td>\n<td>compactSize uint</td>\n<td>Required</td>\n<td>Number of ProRegTx hashes which were deleted after baseBlockHash</td>\n</tr>\n<tr>\n<td>variable</td>\n<td>deletedMNs</td>\n<td>vector</td>\n<td>Required</td>\n<td>A list of ProRegTx hashes for masternode which were deleted after <code>baseBlockHash</code></td>\n</tr>\n<tr>\n<td>variable</td>\n<td>mnList</td>\n<td>vector</td>\n<td>Required</td>\n<td>The list of Simplified Masternode List (SML) entries which were added or updated since <code>baseBlockHash</code></td>\n</tr>\n<tr>\n<td>1-9</td>\n<td>deletedQuorums<br>Count</td>\n<td>compactSize uint</td>\n<td>Required</td>\n<td><em>Added in protocol version 70214</em><br><br>Number of LLMQs which were deleted from the active set after <code>baseBlockHash</code></td>\n</tr>\n<tr>\n<td>variable</td>\n<td>deletedQuorums</td>\n<td>(uint8_t+uint256)[]</td>\n<td>Required</td>\n<td><em>Added in protocol version 70214</em><br><br>A list of LLMQ type and quorum hashes for LLMQs which were deleted after <code>baseBlockHash</code></td>\n</tr>\n<tr>\n<td>1-9</td>\n<td>newQuorumsCount</td>\n<td>compactSize uint</td>\n<td>Required</td>\n<td><em>Added in protocol version 70214</em><br><br>Number of new LLMQs which were added to the active set since <code>baseBlockHash</code></td>\n</tr>\n<tr>\n<td>variable</td>\n<td>newQuorums</td>\n<td>qfcommit[]</td>\n<td>Required</td>\n<td><em>Added in protocol version 70214</em><br><br>The list of LLMQ commitments for the LLMQs which were added since <code>baseBlockHash</code></td>\n</tr>\n</tbody>\n</table></div>\n<p>Simplified Masternode List (SML) Entry</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>32</td>\n<td>proRegTxHash</td>\n<td>uint256</td>\n<td>The hash of the ProRegTx that identifies the masternode</td>\n</tr>\n<tr>\n<td>32</td>\n<td>confirmedHash</td>\n<td>uint256</td>\n<td>The hash of the block at which the masternode got confirmed</td>\n</tr>\n<tr>\n<td>16</td>\n<td>ipAddress</td>\n<td>byte[]</td>\n<td>IPv6 address in network byte order. Only IPv4 mapped addresses are allowed (to be extended in the future)</td>\n</tr>\n<tr>\n<td>2</td>\n<td>port</td>\n<td>uint_16</td>\n<td>Port (network byte order)</td>\n</tr>\n<tr>\n<td>48</td>\n<td>pubKeyOperator</td>\n<td>BLSPubKey</td>\n<td>The operators public key</td>\n</tr>\n<tr>\n<td>20</td>\n<td>keyIDVoting</td>\n<td>CKeyID</td>\n<td>The public key hash used for voting.</td>\n</tr>\n<tr>\n<td>1</td>\n<td>isValid</td>\n<td>bool</td>\n<td>True if a masternode is not PoSe-banned</td>\n</tr>\n</tbody>\n</table></div>\n<p>The following annotated hexdump shows a <a href=\"core-ref-p2p-network-data-messages#mnlistdiff\"><code>mnlistdiff</code> message</a>. (The message header has been omitted.)</p>\n<pre><code class=\"lang-text\">000001ee5108348a2c59396da29dc576\n9b2a9bb303d7577aee9cd95136c49b9b ........... Base block hash\n\n0000030f51f12e7069a7aa5f1bc9085d\ndb3fe368976296fd3b6d73fdaf898cc0 ........... Block hash\n\n05000000 ................................... Transactions: 5\n\n04 ......................................... Merkle hash count: 4\n\n4488a599e5d61709664c32305befd58b\nef29e33bc6e718af0233f938557a57a9 ........... Merkle hash 1\n5c8119b7b136d94e477a0d2917d5f724\n5ff299cc6e31994f6236a8fb34fec88f ........... Merkle hash 2\n905efa3e6743c889823f00147d36d12f\nd12ad401c19089f0affcabd423deef67 ........... Merkle hash 3\n3f3a7f84d7ad33214994b5aecf4c1e19\n2cb65b86750b1377e069073d1eba477a ........... Merkle hash 4\n\n01 ......................................... Merkle flag count: 1\n0f ......................................... Flags: 0 0 0 0 1 1 1 1\n\n[...]....................................... Coinbase Tx (Not shown)\n\n00 ......................................... Deleted masternodes: 0\n\n02 ......................................... Masternode list entries: 2\n\n00 ......................................... Deleted quorums: 0\n\n00 ......................................... New quorums: 0\n\nMasternode List\n| Masternode 1\n| | 01040eb32f760490054543356cff4638\n| | 65633439dd073cffa570305eb086f70e ....... ProRegTx hash\n| |\n| | 000001ee5108348a2c59396da29dc576\n| | 9b2a9bb303d7577aee9cd95136c49b9b ....... Confirmed block hash\n| |\n| | 00000000000000000000000000000000 ....... IP Address: ::ffff:0.0.0.0\n| | 0000 ................................... Port: 0\n| |\n| | 0000000000000000000000000000000000000000\n| | 0000000000000000000000000000000000000000\n| | 0000000000000000 ....................... Operator public key (BLS)\n| | c2ae01fb4084cbc3bc31e7f59b36be228a320404 Voting pubkey hash (ECDSA)\n| |\n| | 0 ...................................... Valid (0 - No)\n|\n| Masternode 2\n| | f7737beb39779971e9bc59632243e13f\n| | c5fc9ada93b69bf48c2d4c463296cd5a ....... ProRegTx hash\n| |\n| | 0000030f51f12e7069a7aa5f1bc9085d\n| | db3fe368976296fd3b6d73fdaf898cc0 ....... Confirmed block hash\n| |\n| | 000000000000000000000000cf9af40d ....... IP Address: ::ffff:207.154.244.13\n| | 4e1f ................................... Port: 19999\n| |\n| | 88d719278eef605d9c19037366910b59bc28d437\n| | de4a8db4d76fda6d6985dbdf10404fb9bb5cd0e8\n| | c22f4a914a6c5566 ....................... Operator public key (BLS)\n| | 43ce12751c4ba45dcdfe2c16cefd61461e17a54d Voting pubkey hash (ECDSA)\n| |\n| | 1 ...................................... Valid (1 - Yes)\n</code></pre>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-notfound\"></div>notfound<a class=\"fa fa-anchor\" href=\"#section-notfound\"></a></h1>\n<p><em>Added in protocol version 70001.</em></p>\n<p>The <a href=\"core-ref-p2p-network-data-messages#notfound\"><code>notfound</code> message</a> is a reply to a <a href=\"core-ref-p2p-network-data-messages#getdata\"><code>getdata</code> message</a> which requested an object the receiving &lt;&lt;glossary:node&gt;&gt; does not have available for relay. (Nodes are not expected to relay historic transactions which are no longer in the memory pool or relay set. Nodes may also have pruned spent transactions from older &lt;&lt;glossary:blocks&gt;&gt;, making them unable to send those blocks.)</p>\n<p>The format and maximum size limitations of the <a href=\"core-ref-p2p-network-data-messages#notfound\"><code>notfound</code> message</a> are identical to the <a href=\"core-ref-p2p-network-data-messages#inv\"><code>inv</code> message</a>; only the message header differs.</p>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-qrinfo\"></div>qrinfo<a class=\"fa fa-anchor\" href=\"#section-qrinfo\"></a></h1>\n<p><em>Added in protocol version 70222 of Dash Core.</em></p>\n<p>The <code>qrinfo</code> message sends quorum rotation information to a node which previously requested it with a <a href=\"core-ref-p2p-network-data-messages#getqrinfo\"><code>getqrinfo</code> message</a>.</p>\n<p>Note: In the following fields, <code>c</code> refers to the quorum cycle length. This is synonymous with the DKG interval (<code>quorumDkgInterval</code>) as defined in <a href=\"https://github.com/dashpay/dips/blob/master/dip-0006.md#parametersvariables-of-a-llmq-and-dkg\">DIP6</a>.</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data type</th>\n<th>Required</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Varies</td>\n<td>quorumSnapshot<br>AtHMinusC</td>\n<td>CQuorumSnapshot</td>\n<td>Required</td>\n<td>Quorum snapshot for height <code>h-c</code></td>\n</tr>\n<tr>\n<td>Varies</td>\n<td>quorumSnapshot<br>AtHMinus2C</td>\n<td>CQuorumSnapshot</td>\n<td>Required</td>\n<td>Quorum snapshot for height <code>h-2c</code></td>\n</tr>\n<tr>\n<td>Varies</td>\n<td>quorumSnapshot<br>AtHMinus3C</td>\n<td>CQuorumSnapshot</td>\n<td>Required</td>\n<td>Quorum snapshot for height <code>h-3c</code></td>\n</tr>\n<tr>\n<td>Varies</td>\n<td>mnListDiffTip</td>\n<td>CSimplifiedMNListDiff<br>(see <a href=\"#mnlistdiff\"><code>mnlistdiff</code></a>)</td>\n<td>Required</td>\n<td>Masternode list diff at height at the tip. </td>\n</tr>\n<tr>\n<td>Varies</td>\n<td>mnListDiffH</td>\n<td>CSimplifiedMNListDiff<br>(see <a href=\"#mnlistdiff\"><code>mnlistdiff</code></a>)</td>\n<td>Required</td>\n<td>Masternode list diff at height <code>h</code>. </td>\n</tr>\n<tr>\n<td>Varies</td>\n<td>mnListDiff<br>AtHMinusC</td>\n<td>CSimplifiedMNListDiff<br>(see <a href=\"#mnlistdiff\"><code>mnlistdiff</code></a>)</td>\n<td>Required</td>\n<td>Masternode list diff at height <code>h-c</code></td>\n</tr>\n<tr>\n<td>Varies</td>\n<td>mnListDiff<br>AtHMinus2C</td>\n<td>CSimplifiedMNListDiff<br>(see <a href=\"#mnlistdiff\"><code>mnlistdiff</code></a>)</td>\n<td>Required</td>\n<td>Masternode list diff at height <code>h-2c</code></td>\n</tr>\n<tr>\n<td>Varies</td>\n<td>mnListDiff<br>AtHMinus3C</td>\n<td>CSimplifiedMNListDiff<br>(see <a href=\"#mnlistdiff\"><code>mnlistdiff</code></a>)</td>\n<td>Required</td>\n<td>Masternode list diff at height <code>h-3c</code></td>\n</tr>\n<tr>\n<td>1</td>\n<td>extraShare</td>\n<td>bool</td>\n<td>Required</td>\n<td>Flag to indicate if an extra share is requested</td>\n</tr>\n<tr>\n<td>Varies</td>\n<td>quorumSnapshot<br>AtHMinus4C</td>\n<td>CQuorumSnapshot</td>\n<td>Optional</td>\n<td>Returned only if <code>extraShare</code> is on. See below for sub-message contents.</td>\n</tr>\n<tr>\n<td>Varies</td>\n<td>mnListDiff<br>AtHMinus4C</td>\n<td>CSimplifiedMNListDiff</td>\n<td>Optional</td>\n<td>Returned only if <code>extraShare</code> is on. As in DIP-4.</td>\n</tr>\n<tr>\n<td>1-9</td>\n<td>lastQuorumHashPer<br>IndexSize</td>\n<td>compactSize uint</td>\n<td>Required</td>\n<td>Number of elements in <code>lastCommitmentPerIndex</code></td>\n</tr>\n<tr>\n<td>32 * <code>lastQuorum</code><br><code>HashPer</code><br><code>IndexSize</code></td>\n<td>lastCommitment<br>PerIndex</td>\n<td>uint256_t[]</td>\n<td>Required</td>\n<td>Contains the most recent commitment for each quorumIndex. Ordered by quorumIndex.</td>\n</tr>\n<tr>\n<td>1-9</td>\n<td>quorumSnapshot<br>ListSize</td>\n<td>compactSize uint</td>\n<td>Required</td>\n<td>Number of elements in <code>quorumSnapshotList</code></td>\n</tr>\n<tr>\n<td>Varies</td>\n<td>quorumSnapshot<br>List</td>\n<td>CQuorumSnapshot[]</td>\n<td>Required</td>\n<td>The snapshots required to reconstruct the quorums built at <code>h</code> in heightsLists. Ordered from oldest to newest</td>\n</tr>\n<tr>\n<td>1-9</td>\n<td>mnListDiff<br>ListSize</td>\n<td>compactSize uint</td>\n<td>Required</td>\n<td>Number of elements in <code>mnListDiffList</code></td>\n</tr>\n<tr>\n<td>Varies</td>\n<td>mnListDiffList</td>\n<td>CSimplifiedMNListDiff[]</td>\n<td>Required</td>\n<td>The MNLISTDIFFs required to calculate older quorums. Ordered from oldest to newest</td>\n</tr>\n</tbody>\n</table></div>\n<p><strong>CQuorumSnapshot</strong></p>\n<p>Note: All fields are required</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>4</td>\n<td>mnSkipListMode</td>\n<td>int32_t</td>\n<td>Mode of the skip list</td>\n</tr>\n<tr>\n<td>1-9</td>\n<td>activeQuorum<br>MembersSize</td>\n<td>compactSize uint</td>\n<td>Number of elements in <code>activeQuorumMembers</code></td>\n</tr>\n<tr>\n<td>(<code>activeQuorum</code><br><code>MembersSize</code>) + 7)/8</td>\n<td>activeQuorumMembers</td>\n<td>cbitset</td>\n<td>The bitset of nodes already in quarters at the start of cycle at height n</td>\n</tr>\n<tr>\n<td>1-9</td>\n<td>mnSkipListSize</td>\n<td>compactSize uint</td>\n<td>Number of elements in mnSkipList</td>\n</tr>\n<tr>\n<td>4 * <code>mnSkipListSize</code></td>\n<td>mnSkipList</td>\n<td>int32_t[]</td>\n<td>Skiplist at height n</td>\n</tr>\n</tbody>\n</table></div>\n<p>The following annotated hexdump shows a <a href=\"core-ref-p2p-network-data-messages#qrinfo\"><code>qrinfo</code> message</a>. (The message header has been omitted.)</p>\n<pre><code class=\"lang-text\">Quorum snapshot (h-c)\n| 01000000 ................................. Skiplist mode: 1\n| 1f ....................................... Active quorum members: 31\n| bbffff7f ................................. Active quorum members bitset\n| \n| 01 ....................................... Skip list size: 1\n| \n| Skip list\n| | 0b000000 ............................... Masternode 11\n\nQuorum snapshot (h-2c)\n| 01000000 ................................. Skiplist mode: 1\n| 1f ....................................... Active quorum members: 31\n| f3ff6f7b ................................. Active quorum members bitset\n|\n| 06 ....................................... Skip list size: 6\n| \n| Skip list\n| | 05000000 ............................... Masternode 5\n| | 03000000 ............................... Masternode 3\n| | 04000000 ............................... Masternode 4\n| | 06000000 ............................... Masternode 6\n| | 07000000 ............................... Masternode 7\n| | 08000000 ............................... Masternode 8\n\nQuorum snapshot (h-3c) ..................... Not shown for brevity\n\nMnListDiff (Tip)\n| e173b01943fe7b8d2bf5a13c034eafed\n| d2708a1a0f9e5104b86439382e050000 ......... Base block hash\n| 847b42ae4509c82e8c8ba599f23f15c1\n| e34c899a09e4ebf440f6e2ef4b000000 ......... Block hash\n| 01000000 ................................. Transactions: 1\n| 01 ....................................... Merkle hash count: 1\n| c44c59fd87c816506d3890aaf0c8f7df\n| bad10f4a9b3e2b43bc1e9c832e81b381 ......... Merkle hash 1\n| 01 ....................................... Merkle flag count: 1\n| 01 ....................................... Flags: 0 0 0 0 0 0 0 1\n|\n| [...]..................................... Coinbase Tx (Not shown)\n\nMnListDiff (h) ............................. Not shown for brevity\nMnListDiff (h-c) ........................... Not shown for brevity\nMnListDiff (h-2c) .......................... Not shown for brevity\nMnListDiff (h-3c) .......................... Not shown for brevity\n\n01 ....................................... Extra share: true\n\nQuorum snapshot (h-4c)\n| 01000000 ................................. Skiplist mode: 1\n| 1f ....................................... Active quorum members: 31\n| ff7fdd5f ................................. Active quorum members bitset\n|\n| 01 ....................................... Skip list size: 1\n|\n| Skip list\n| | 07000000 ............................... Masternode 7\n\nMnListDiff (h-4c)\n\nLast quorum hash per index\n| 04 ....................................... Quorum hashes: 4\n| c2e276c518b3f8484b237e300094e222\n| 388a095f486c822585a67b1520010000 ......... Quorum hash 1\n| bb4f0c5a3efb229bd5a4e4e45ca2228e\n| b11f05c3a6e8fdf9d7d4f499b7010000 ......... Quorum hash 2\n| aca22eb2c63daa5304cb9cbe6089afe3\n| 99e335f73306735718355ad3d9000000 ......... Quorum hash 3\n| 45bf29bada522857d6e3b2371e1fefc7\n| c01fcef0b6578e7062fd571760010000 ......... Quorum hash 4\n\n00 ......................................... Quorum snapshot list size: 0\n00 ......................................... Masternode list diff list size: 0\n</code></pre>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-tx\"></div>tx<a class=\"fa fa-anchor\" href=\"#section-tx\"></a></h1>\n<p>The <a href=\"core-ref-p2p-network-data-messages#tx\"><code>tx</code> message</a> transmits a single transaction in the &lt;&lt;glossary:raw transaction&gt;&gt; format. It can be sent in a variety of situations;</p>\n<ul>\n<li ><p><strong>Transaction Response:</strong> Dash Core will send it in response to a <a href=\"core-ref-p2p-network-data-messages#getdata\"><code>getdata</code> message</a> that requests the transaction with an &lt;&lt;glossary:inventory&gt;&gt;  type of <code>MSG_TX</code>.</p>\n</li><li ><p><strong>MerkleBlock Response:</strong> Dash Core will send it in response to a <a href=\"core-ref-p2p-network-data-messages#getdata\"><code>getdata</code> message</a> that requests a &lt;&lt;glossary:merkle block&gt;&gt; with an &lt;&lt;glossary:inventory&gt;&gt; type of <code>MSG_MERKLEBLOCK</code>. (This is in addition to sending a <a href=\"core-ref-p2p-network-data-messages#merkleblock\"><code>merkleblock</code> message</a>.) Each <a href=\"core-ref-p2p-network-data-messages#tx\"><code>tx</code> message</a> in this case provides a matched transaction from that &lt;&lt;glossary:block&gt;&gt;.</p>\n</li></ul>\n<p>For an example hexdump of the raw transaction format, see the <a href=\"core-ref-transactions-raw-transaction-format\">raw transaction section</a>.</p>\n\n</div>"
}