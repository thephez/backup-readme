{
 "metadata": {
  "image": [],
  "title": "Dash base opcodes guide",
  "description": "The opcodes used in the pubkey scripts of standard transactions are described in this subsection.",
  "keywords": "",
  "robots": "index"
 },
 "api": {
  "method": "get",
  "url": "",
  "auth": "required",
  "results": {
   "codes": [
    {
     "status": 200,
     "language": "json",
     "code": "{}",
     "name": ""
    },
    {
     "status": 400,
     "language": "json",
     "code": "{}",
     "name": ""
    }
   ]
  },
  "params": []
 },
 "next": {
  "description": "",
  "pages": [
   {
    "type": "doc",
    "icon": "file-text-o",
    "name": "Address Conversion",
    "slug": "core-ref-transactions-address-conversion",
    "category": "Core Reference"
   }
  ]
 },
 "algolia": {
  "recordCount": 5,
  "publishPending": false,
  "translationFailure": false,
  "updatedAt": "2023-02-21T19:15:42.995Z"
 },
 "title": "OpCodes",
 "icon": "",
 "updates": [],
 "type": "basic",
 "slug": "core-ref-transactions-opcodes",
 "excerpt": "",
 "body": "# Base Opcodes\n\nThe <<glossary:opcodes>> used in the pubkey scripts of standard <<glossary:transactions>> are:\n\n* Various data pushing opcodes from 0x00 to 0x4e (1--78). These aren't typically shown in examples, but they must be used to push <<glossary:signatures>> and <<glossary:public keys>> onto the stack. See the link below this list for a description.\n\n* `OP_TRUE`/`OP_1` (0x51) and `OP_2` through `OP_16` (0x52--0x60), which push the values 1 through 16 to the stack.\n\n* `OP_VERIFY` (0x69) consumes the topmost item on the stack. If that item is zero (false) it terminates the script in failure.\n\n* `OP_RETURN` (0x6a) terminates the script in failure when executed.\n\n* `OP_DUP` (0x76) pushes a copy of the topmost stack item on to the stack.\n\n* `OP_EQUAL` (0x87) consumes the top two items on the stack, compares them, and pushes true onto the stack if they are the same, false if not.\n\n* `OP_EQUALVERIFY` (0x88) runs `OP_EQUAL` and then `OP_VERIFY` in sequence.\n\n* `OP_HASH160` (0xa9) consumes the topmost item on the stack, computes the RIPEMD160(SHA256()) hash of that item, and pushes that hash onto the stack.\n\n**<span id=\"op_checksig\"></span>**\n* `OP_CHECKSIG` (0xac) consumes a signature and a full public key, and pushes true onto the stack if the transaction data specified by the <<glossary:SIGHASH flag>> was converted into the signature using the same <<glossary:ECDSA private key>> that generated the public key. Otherwise, it pushes false onto the stack.\n\n* `OP_CHECKMULTISIG` (0xae) consumes the value (n) at the top of the stack, consumes that many of the next stack levels (public keys), consumes the value (m) now at the top of the stack, and consumes that many of the next values (signatures) plus one extra value.\n\n    The \"one extra value\" it consumes is the result of an off-by-one error in the Bitcoin Core implementation. This value is not used, so signature scripts prefix the list of <<glossary:secp256k1 signatures>> with a single OP_0 (0x00).\n\n    `OP_CHECKMULTISIG` compares the first signature against each public key until it finds an [ECDSA](https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm) match. Starting with the subsequent public key, it compares the second signature against each remaining public key until it finds an ECDSA match. The process is repeated until all signatures have been checked or not enough public keys remain to produce a successful result.\n\n    Because public keys are not checked again if they fail any signature comparison, signatures must be placed in the signature script using the same order as their corresponding public keys were placed in the <<glossary:pubkey script>> or <<glossary:redeem script>>. See the `OP_CHECKMULTISIG` warning below for more details.\n\nA complete list of Bitcoin opcodes can be found on the Bitcoin Wiki [Script Page](https://en.bitcoin.it/wiki/Script), with an authoritative list in the `opcodetype` enum of the Dash Core [script header file](https://github.com/dashpay/dash/blob/master/src/script/script.h).\n\n# Expanded Opcodes\n\nSeveral opcodes were disabled in the Bitcoin scripting system due to the discovery of a series of bugs in the early days of Bitcoin. [Dash Improvement Proposal 20](https://github.com/dashpay/dips/blob/master/dip-0020.md) reintroduced a number of these opcodes based on work done by Bitcoin Cash developers. Many of the disabled opcodes have been enabled and several of them re-designed to replace the original ones. \n\n> \ud83d\udc4d New Opcodes\n> \n> The following opcodes were added/reactivated in Dash Core 0.17.0 as described in [DIP 20](https://github.com/dashpay/dips/blob/master/dip-0020.md).\n\n\n* `OP_CAT` (0x7e) concatenates two byte arrays.\n\n* `OP_SPLIT` (0x7f) Split byte array `x` at position `n`. *This opcode was disabled and named `OP_SUBSTR` prior to Dash Core 0.17.0*.\n\n* `OP_NUM2BIN` (0x80) Convert numeric `a` into byte array of length `b`. *This opcode was disabled and named `OP_LEFT` prior to Dash Core 0.17.0*.\n\n* `OP_BIN2NUM` (0x81) Convert byte array `x` into numeric. *This opcode was disabled and named `OP_RIGHT` prior to Dash Core 0.17.0*.\n\n* `OP_AND` (0x84) Boolean _AND_ between each bit in the operands.\n\n* `OP_OR` (0x85) Boolean _OR_ between each bit in the operands.\n\n* `OP_XOR` (0x86) Boolean _EXCLUSIVE OR_ between each bit in the operands.\n\n* `OP_DIV` (0x96) Return the integer quotient of `a` and `b`. If the result would be a non-integer it is rounded towards zero. `a` and `b` are interpreted as numeric values.\n\n* `OP_MOD` (0x97) Returns the remainder after dividing `a` by `b`. The output will be represented using the least number of bytes required. `a` and `b` are interpreted as numeric values.\n\n* `OP_CHECKDATASIG` (0xba) Checks whether a signature is valid with respect to a message and a public key. It allows Script to validate arbitrary messages from outside the blockchain.\n\n* `OP_CHECKDATASIGVERIFY` (0xbb) `OP_CHECKDATASIGVERIFY` is equivalent to `OP_CHECKDATASIG` followed by `OP_VERIFY`. It leaves nothing on the stack and will cause the script to fail immediately if the signature check does not pass.\n\n# Signature Scripts\n\n## Signature Script Modification\n\n![Warning icon](https://dash-docs.github.io/img/icons/icon_warning.svg) **<span id=\"signature_script_modification_warning\">Signature script modification warning</span>:** <<glossary:Signature scripts>> are not signed, so anyone can modify them. This means signature scripts should only contain data and <<glossary:data-pushing opcode>> which can't be modified without causing the pubkey script to fail. Placing non-data-pushing opcodes in the signature script currently makes a transaction non-standard, and future consensus rules may forbid such transactions altogether. (Non-data-pushing opcodes are already forbidden in signature scripts when spending a <<glossary:P2SH pubkey script>>.)\n\n## Multisig Signature Order\n\n![Warning icon](https://dash-docs.github.io/img/icons/icon_warning.svg) **`OP_CHECKMULTISIG` warning:** The <<glossary:multisig>> verification process described above requires that signatures in the signature script be provided in the same order as their corresponding public keys in the pubkey script or redeem script. For example, the following combined signature and pubkey script will produce the stack and comparisons shown:\n\n``` text\nOP_0 <A sig> <B sig> OP_2 <A pubkey> <B pubkey> <C pubkey> OP_3\n\nSig Stack       Pubkey Stack  (Actually a single stack)\n---------       ------------\nB sig           C pubkey\nA sig           B pubkey\nOP_0            A pubkey\n\n1. B sig compared to C pubkey (no match)\n2. B sig compared to B pubkey (match #1)\n3. A sig compared to A pubkey (match #2)\n\nSuccess: two matches found\n```\n\nBut reversing the order of the signatures with everything else the same will fail, as shown below:\n\n``` text\nOP_0 <B sig> <A sig> OP_2 <A pubkey> <B pubkey> <C pubkey> OP_3\n\nSig Stack       Pubkey Stack  (Actually a single stack)\n---------       ------------\nA sig           C pubkey\nB sig           B pubkey\nOP_0            A pubkey\n\n1. A sig compared to C pubkey (no match)\n2. A sig compared to B pubkey (no match)\n\nFailure, aborted: two signature matches required but none found so\n                  far, and there's only one pubkey remaining\n```",
 "order": 0,
 "isReference": false,
 "deprecated": false,
 "hidden": false,
 "sync_unique": "",
 "link_url": "",
 "link_external": false,
 "reusableContent": [],
 "previousSlug": "",
 "slugUpdatedAt": "2021-01-06T20:42:42.049Z",
 "revision": 7,
 "_id": "63f5176df91c7700118e77b4",
 "version": "63f5176df91c7700118e7825",
 "updatedAt": "2023-01-25T21:11:28.877Z",
 "createdAt": "2019-10-23T16:10:33.564Z",
 "project": "5daf2e65f4109c0040fd51e1",
 "user": "5b8400d7185d5e00036dcc3b",
 "parentDoc": "63f5176df91c7700118e77ae",
 "category": "63f5176df91c7700118e779d",
 "__v": 1,
 "pendingAlgoliaPublish": false,
 "isApi": false,
 "id": "63f5176df91c7700118e77b4",
 "body_html": "<h1 class=\"heading heading-1 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"base-opcodes\"></div><div class=\"heading-text\"><div id=\"section-base-opcodes\" class=\"heading-anchor_backwardsCompatibility\"></div>Base Opcodes</div><a aria-label=\"Skip link to Base Opcodes\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#base-opcodes\"></a></h1>\n<p>The <span class=\"GlossaryItem-trigger\">opcodes</span> used in the pubkey scripts of standard <span class=\"GlossaryItem-trigger\">transactions</span> are:</p>\n<ul>\n<li>\n<p>Various data pushing opcodes from 0x00 to 0x4e (1--78). These aren&#x27;t typically shown in examples, but they must be used to push <span class=\"GlossaryItem-trigger\">signatures</span> and <span class=\"GlossaryItem-trigger\">public keys</span> onto the stack. See the link below this list for a description.</p>\n</li>\n<li>\n<p><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_TRUE</code>/<button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_1</code> (0x51) and <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_2</code> through <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_16</code> (0x52--0x60), which push the values 1 through 16 to the stack.</p>\n</li>\n<li>\n<p><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_VERIFY</code> (0x69) consumes the topmost item on the stack. If that item is zero (false) it terminates the script in failure.</p>\n</li>\n<li>\n<p><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_RETURN</code> (0x6a) terminates the script in failure when executed.</p>\n</li>\n<li>\n<p><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_DUP</code> (0x76) pushes a copy of the topmost stack item on to the stack.</p>\n</li>\n<li>\n<p><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_EQUAL</code> (0x87) consumes the top two items on the stack, compares them, and pushes true onto the stack if they are the same, false if not.</p>\n</li>\n<li>\n<p><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_EQUALVERIFY</code> (0x88) runs <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_EQUAL</code> and then <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_VERIFY</code> in sequence.</p>\n</li>\n<li>\n<p><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_HASH160</code> (0xa9) consumes the topmost item on the stack, computes the RIPEMD160(SHA256()) hash of that item, and pushes that hash onto the stack.</p>\n</li>\n</ul>\n<p><strong><span id=\"op_checksig\"></span></strong></p>\n<ul>\n<li>\n<p><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_CHECKSIG</code> (0xac) consumes a signature and a full public key, and pushes true onto the stack if the transaction data specified by the <span class=\"GlossaryItem-trigger\">SIGHASH flag</span> was converted into the signature using the same <span class=\"GlossaryItem-trigger\">ECDSA private key</span> that generated the public key. Otherwise, it pushes false onto the stack.</p>\n</li>\n<li>\n<p><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_CHECKMULTISIG</code> (0xae) consumes the value (n) at the top of the stack, consumes that many of the next stack levels (public keys), consumes the value (m) now at the top of the stack, and consumes that many of the next values (signatures) plus one extra value.</p>\n<p>  The &quot;one extra value&quot; it consumes is the result of an off-by-one error in the Bitcoin Core implementation. This value is not used, so signature scripts prefix the list of <span class=\"GlossaryItem-trigger\">secp256k1 signatures</span> with a single OP_0 (0x00).</p>\n<p>  <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_CHECKMULTISIG</code> compares the first signature against each public key until it finds an <a href=\"https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm\" target=\"\" title=\"\">ECDSA</a> match. Starting with the subsequent public key, it compares the second signature against each remaining public key until it finds an ECDSA match. The process is repeated until all signatures have been checked or not enough public keys remain to produce a successful result.</p>\n<p>  Because public keys are not checked again if they fail any signature comparison, signatures must be placed in the signature script using the same order as their corresponding public keys were placed in the <span class=\"GlossaryItem-trigger\">pubkey script</span> or <span class=\"GlossaryItem-trigger\">redeem script</span>. See the <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_CHECKMULTISIG</code> warning below for more details.</p>\n</li>\n</ul>\n<p>A complete list of Bitcoin opcodes can be found on the Bitcoin Wiki <a href=\"https://en.bitcoin.it/wiki/Script\" target=\"\" title=\"\">Script Page</a>, with an authoritative list in the <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">opcodetype</code> enum of the Dash Core <a href=\"https://github.com/dashpay/dash/blob/master/src/script/script.h\" target=\"\" title=\"\">script header file</a>.</p>\n<h1 class=\"heading heading-1 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"expanded-opcodes\"></div><div class=\"heading-text\"><div id=\"section-expanded-opcodes\" class=\"heading-anchor_backwardsCompatibility\"></div>Expanded Opcodes</div><a aria-label=\"Skip link to Expanded Opcodes\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#expanded-opcodes\"></a></h1>\n<p>Several opcodes were disabled in the Bitcoin scripting system due to the discovery of a series of bugs in the early days of Bitcoin. <a href=\"https://github.com/dashpay/dips/blob/master/dip-0020.md\" target=\"\" title=\"\">Dash Improvement Proposal 20</a> reintroduced a number of these opcodes based on work done by Bitcoin Cash developers. Many of the disabled opcodes have been enabled and several of them re-designed to replace the original ones. </p>\n<blockquote class=\"callout callout_okay\" theme=\"\ud83d\udc4d\"><h2 class=\"callout-heading\"><span class=\"callout-icon\">\ud83d\udc4d</span><p>New Opcodes</p></h2><p>The following opcodes were added/reactivated in Dash Core 0.17.0 as described in <a href=\"https://github.com/dashpay/dips/blob/master/dip-0020.md\" target=\"\" title=\"\">DIP 20</a>.</p></blockquote>\n<ul>\n<li>\n<p><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_CAT</code> (0x7e) concatenates two byte arrays.</p>\n</li>\n<li>\n<p><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_SPLIT</code> (0x7f) Split byte array <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">x</code> at position <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">n</code>. <em>This opcode was disabled and named <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_SUBSTR</code> prior to Dash Core 0.17.0</em>.</p>\n</li>\n<li>\n<p><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_NUM2BIN</code> (0x80) Convert numeric <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">a</code> into byte array of length <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">b</code>. <em>This opcode was disabled and named <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_LEFT</code> prior to Dash Core 0.17.0</em>.</p>\n</li>\n<li>\n<p><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_BIN2NUM</code> (0x81) Convert byte array <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">x</code> into numeric. <em>This opcode was disabled and named <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_RIGHT</code> prior to Dash Core 0.17.0</em>.</p>\n</li>\n<li>\n<p><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_AND</code> (0x84) Boolean <em>AND</em> between each bit in the operands.</p>\n</li>\n<li>\n<p><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_OR</code> (0x85) Boolean <em>OR</em> between each bit in the operands.</p>\n</li>\n<li>\n<p><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_XOR</code> (0x86) Boolean <em>EXCLUSIVE OR</em> between each bit in the operands.</p>\n</li>\n<li>\n<p><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_DIV</code> (0x96) Return the integer quotient of <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">a</code> and <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">b</code>. If the result would be a non-integer it is rounded towards zero. <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">a</code> and <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">b</code> are interpreted as numeric values.</p>\n</li>\n<li>\n<p><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_MOD</code> (0x97) Returns the remainder after dividing <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">a</code> by <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">b</code>. The output will be represented using the least number of bytes required. <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">a</code> and <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">b</code> are interpreted as numeric values.</p>\n</li>\n<li>\n<p><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_CHECKDATASIG</code> (0xba) Checks whether a signature is valid with respect to a message and a public key. It allows Script to validate arbitrary messages from outside the blockchain.</p>\n</li>\n<li>\n<p><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_CHECKDATASIGVERIFY</code> (0xbb) <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_CHECKDATASIGVERIFY</code> is equivalent to <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_CHECKDATASIG</code> followed by <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_VERIFY</code>. It leaves nothing on the stack and will cause the script to fail immediately if the signature check does not pass.</p>\n</li>\n</ul>\n<h1 class=\"heading heading-1 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"signature-scripts\"></div><div class=\"heading-text\"><div id=\"section-signature-scripts\" class=\"heading-anchor_backwardsCompatibility\"></div>Signature Scripts</div><a aria-label=\"Skip link to Signature Scripts\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#signature-scripts\"></a></h1>\n<h2 class=\"heading heading-2 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"signature-script-modification\"></div><div class=\"heading-text\"><div id=\"section-signature-script-modification\" class=\"heading-anchor_backwardsCompatibility\"></div>Signature Script Modification</div><a aria-label=\"Skip link to Signature Script Modification\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#signature-script-modification\"></a></h2>\n<p><span aria-label=\"Warning icon\" class=\"img lightbox closed\" role=\"button\" tabindex=\"0\"><span class=\"lightbox-inner\"><img alt=\"Warning icon\" loading=\"lazy\" src=\"https://dash-docs.github.io/img/icons/icon_warning.svg\" align=\"\" caption=\"\" height=\"auto\" title=\"\" width=\"auto\"/></span></span> <strong><span id=\"signature_script_modification_warning\">Signature script modification warning</span>:</strong> <span class=\"GlossaryItem-trigger\">Signature scripts</span> are not signed, so anyone can modify them. This means signature scripts should only contain data and <span class=\"GlossaryItem-trigger\">data-pushing opcode</span> which can&#x27;t be modified without causing the pubkey script to fail. Placing non-data-pushing opcodes in the signature script currently makes a transaction non-standard, and future consensus rules may forbid such transactions altogether. (Non-data-pushing opcodes are already forbidden in signature scripts when spending a <span class=\"GlossaryItem-trigger\">P2SH pubkey script</span>.)</p>\n<h2 class=\"heading heading-2 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"multisig-signature-order\"></div><div class=\"heading-text\"><div id=\"section-multisig-signature-order\" class=\"heading-anchor_backwardsCompatibility\"></div>Multisig Signature Order</div><a aria-label=\"Skip link to Multisig Signature Order\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#multisig-signature-order\"></a></h2>\n<p><span aria-label=\"Warning icon\" class=\"img lightbox closed\" role=\"button\" tabindex=\"0\"><span class=\"lightbox-inner\"><img alt=\"Warning icon\" loading=\"lazy\" src=\"https://dash-docs.github.io/img/icons/icon_warning.svg\" align=\"\" caption=\"\" height=\"auto\" title=\"\" width=\"auto\"/></span></span> <strong><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">OP_CHECKMULTISIG</code> warning:</strong> The <span class=\"GlossaryItem-trigger\">multisig</span> verification process described above requires that signatures in the signature script be provided in the same order as their corresponding public keys in the pubkey script or redeem script. For example, the following combined signature and pubkey script will produce the stack and comparisons shown:</p>\n<div class=\"CodeTabs CodeTabs_initial theme-light\"><div class=\"CodeTabs-toolbar\" role=\"tablist\"><button aria-selected=\"true\" class=\"CodeTabs_active\" role=\"tab\" type=\"button\">Text</button></div><div class=\"CodeTabs-inner\" role=\"tabpanel\"><pre><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang-text theme-light\" data-lang=\"text\" name=\"\" tabindex=\"0\">OP_0 &lt;A sig&gt; &lt;B sig&gt; OP_2 &lt;A pubkey&gt; &lt;B pubkey&gt; &lt;C pubkey&gt; OP_3\n\nSig Stack       Pubkey Stack  (Actually a single stack)\n---------       ------------\nB sig           C pubkey\nA sig           B pubkey\nOP_0            A pubkey\n\n1. B sig compared to C pubkey (no match)\n2. B sig compared to B pubkey (match #1)\n3. A sig compared to A pubkey (match #2)\n\nSuccess: two matches found\n</code></pre></div></div>\n<p>But reversing the order of the signatures with everything else the same will fail, as shown below:</p>\n<div class=\"CodeTabs CodeTabs_initial theme-light\"><div class=\"CodeTabs-toolbar\" role=\"tablist\"><button aria-selected=\"true\" class=\"CodeTabs_active\" role=\"tab\" type=\"button\">Text</button></div><div class=\"CodeTabs-inner\" role=\"tabpanel\"><pre><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang-text theme-light\" data-lang=\"text\" name=\"\" tabindex=\"0\">OP_0 &lt;B sig&gt; &lt;A sig&gt; OP_2 &lt;A pubkey&gt; &lt;B pubkey&gt; &lt;C pubkey&gt; OP_3\n\nSig Stack       Pubkey Stack  (Actually a single stack)\n---------       ------------\nA sig           C pubkey\nB sig           B pubkey\nOP_0            A pubkey\n\n1. A sig compared to C pubkey (no match)\n2. A sig compared to B pubkey (no match)\n\nFailure, aborted: two signature matches required but none found so\n                  far, and there&#x27;s only one pubkey remaining\n</code></pre></div></div>"
}