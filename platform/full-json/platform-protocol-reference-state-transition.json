{
 "metadata": {
  "keywords": "",
  "robots": "index",
  "image": [],
  "title": "",
  "description": ""
 },
 "mdx": {
  "altBody": "",
  "status": "rdmd"
 },
 "api": {
  "method": "get",
  "url": "",
  "auth": "required",
  "results": {
   "codes": [
    {
     "name": "",
     "code": "{}",
     "language": "json",
     "status": 200
    },
    {
     "name": "",
     "code": "{}",
     "language": "json",
     "status": 400
    }
   ]
  },
  "params": [],
  "examples": {
   "codes": []
  }
 },
 "next": {
  "description": "",
  "pages": []
 },
 "algolia": {
  "translationFailure": false,
  "publishPending": false,
  "recordCount": 14,
  "updatedAt": "2023-09-06T16:36:42.546Z"
 },
 "reusableContent": [],
 "_id": "64f8a9df750465004742adbc",
 "title": "State Transition",
 "updates": [],
 "type": "basic",
 "slug": "platform-protocol-reference-state-transition",
 "excerpt": "",
 "body": "# State Transition Overview\n\n State transitions are the means for submitting data that creates, updates, or deletes platform data and results in a change to a new state. Each one must contain:\n\n- [Common fields](#common-fields) present in all state transitions\n- Additional fields specific to the type of action the state transition provides (e.g. [creating an identity](platform-protocol-reference-identity#identity-creation))\n\n## Fees\n\nState transition fees are paid via the credits established when an identity is created. Credits are created at a rate of [1000 credits/satoshi](https://github.com/dashpay/platform/blob/v0.24.5/packages/rs-dpp/src/identity/credits_converter.rs#L3). Fees for actions vary based on parameters related to storage and computational effort that are defined in [rs-dpp](https://github.com/dashpay/platform/blob/v0.24.5/packages/rs-dpp/src/state_transition/fee/constants.rs).\n\n## Size\n\nAll serialized data (including state transitions) is limited to a maximum size of [16 KB](https://github.com/dashpay/platform/blob/v0.24.5/packages/rs-dpp/src/util/serializer.rs#L8).\n\n## Common Fields\n\nAll state transitions include the following fields:\n\n| Field           | Type           | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |\n| --------------- | -------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| protocolVersion | integer        | The platform protocol version (currently `1`)                                                                                                                                                                                                                                                                                                                                                                                                                                         |\n| type            | integer        | State transition type:<br>`0` - [data contract create](platform-protocol-reference-data-contract#data-contract-creation)<br>`1` - [documents batch](platform-protocol-reference-document#document-submission)<br>`2` - [identity create](platform-protocol-reference-identity#identity-creation)<br>`3` - [identity topup](identity.md#identity-topup)<br>`4` - [data contract update](data-contract.md#data-contract-update)<br>`5` - [identity update](identity.md#identity-update) |\n| signature       | array of bytes | Signature of state transition data (65 bytes)                                                                                                                                                                                                                                                                                                                                                                                                                                         |\n\nAdditionally, all state transitions except the identity create and topup state transitions include:\n\n| Field                | Type    | Description                                                                                                                               |\n| -------------------- | ------- | ----------------------------------------------------------------------------------------------------------------------------------------- |\n| signaturePublicKeyId | integer | The `id` of the [identity public key](platform-protocol-reference-identity#identity-publickeys) that signed the state transition (`=> 0`) |\n\n# State Transition Types\n\n## Data Contract Create\n\n| Field        | Type                                                                                   | Description                                                                                |\n| ------------ | -------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------ |\n| dataContract | [data contract object](platform-protocol-reference-data-contract#data-contract-object) | Object containing valid [data contract](platform-protocol-reference-data-contract) details |\n| entropy      | array of bytes                                                                         | Entropy used to generate the data contract ID (32 bytes)                                   |\n\nMore detailed information about the `dataContract` object can be found in the [data contract section](platform-protocol-reference-data-contract).\n\n### Entropy Generation\n\nEntropy is included in [Data Contracts](platform-protocol-reference-data-contract#data-contract-creation) and [Documents](platform-protocol-reference-document#document-create-transition).\n\n```rust\n// From the Rust reference implementation (rs-dpp)\n// entropyGenerator.js\nfn generate(&self) -> anyhow::Result<[u8; 32]> {\n  let mut buffer = [0u8; 32];\n  getrandom(&mut buffer).context(\"generating entropy failed\")?;\n  Ok(buffer)\n}\n```\n\n## Data Contract Update\n\n| Field        | Type                                                                                   | Description                                                                                |\n| ------------ | -------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------ |\n| dataContract | [data contract object](platform-protocol-reference-data-contract#data-contract-object) | Object containing valid [data contract](platform-protocol-reference-data-contract) details |\n\nMore detailed information about the `dataContract` object can be found in the [data contract section](platform-protocol-reference-data-contract).\n\n## Documents Batch\n\n| Field       | Type                        | Description                                                                            |\n| ----------- | --------------------------- | -------------------------------------------------------------------------------------- |\n| ownerId     | array of bytes              | [Identity](platform-protocol-reference-identity) submitting the document(s) (32 bytes) |\n| transitions | array of transition objects | Document `create`, `replace`, or `delete` transitions (up to 10 objects)               |\n\nMore detailed information about the `transitions` array can be found in the [document section](platform-protocol-reference-document).\n\n## Identity Create\n\n| Field          | Type           | Description                                                                                                                                          |\n| -------------- | -------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------- |\n| assetLockProof | array of bytes | Lock [outpoint](https://docs.dash.org/projects/core/en/stable/docs/resources/glossary.html#outpoint) from the layer 1 locking transaction (36 bytes) |\n| publicKeys     | array of keys  | [Public key(s)](platform-protocol-reference-identity#identity-publickeys) associated with the identity (maximum number of keys: `10`)                |\n\nMore detailed information about the `publicKeys` object can be found in the [identity section](platform-protocol-reference-identity).\n\n## Identity TopUp\n\n| Field          | Type           | Description                                                                                                                                          |\n| -------------- | -------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------- |\n| assetLockProof | array of bytes | Lock [outpoint](https://docs.dash.org/projects/core/en/stable/docs/resources/glossary.html#outpoint) from the layer 1 locking transaction (36 bytes) |\n| identityId     | array of bytes | An [Identity ID](platform-protocol-reference-identity#identity-id) for the identity receiving the topup (can be any identity) (32 bytes)             |\n\n## Identity Update\n\n| Field                | Type                 | Description                                                                                                                                                                                             |\n| -------------------- | -------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| identityId           | array of bytes       | The [Identity ID](platform-protocol-reference-identity#identity-id) for the identity being updated (32 bytes)                                                                                           |\n| revision             | integer              | Identity update revision. Used for optimistic concurrency control. Incremented by one with each new update so that the update will fail if the underlying data is modified between reading and writing. |\n| addPublicKeys        | array of public keys | (Optional) Array of up to 10 new public keys to add to the identity. Required if adding keys.                                                                                                           |\n| disablePublicKeys    | array of integers    | (Optional) Array of up to 10 existing identity public key ID(s) to disable for the identity. Required if disabling keys.                                                                                |\n| publicKeysDisabledAt | integer              | (Optional) Timestamp when keys were disabled. Required if `disablePublicKeys` is present.                                                                                                               |\n\n# State Transition Signing\n\nState transitions must be signed by a private key associated with the identity creating the state transition. Since v0.23, each identity must have at least two keys: a primary key (security level `0`) that is only used when signing identity update state transitions and an additional key (security level `2`) that is used to sign all other state transitions.\n\nThe process to sign a state transition consists of the following steps:\n\n1. Canonical CBOR encode the state transition data - this include all ST fields except the `signature` and `signaturePublicKeyId`\n2. Sign the encoded data with a private key associated with the identity creating the state transition\n3. Set the state transition `signature` to the value of the signature created in the previous step\n4. For all state transitions _other than identity create or topup_, set the state transition`signaturePublicKeyId` to the [public key `id`](platform-protocol-reference-identity#public-key-id) corresponding to the key used to sign\n\n## Signature Validation\n\nThe `signature` validation (see [js-dpp](https://github.com/dashpay/platform/blob/v0.24.5/packages/js-dpp/test/unit/stateTransition/validation/validateStateTransitionIdentitySignatureFactory.spec.js)) verifies that:\n\n1. The identity exists\n2. The identity has a public key\n3. The identity's public key is of type `ECDSA`\n4. The state transition signature is valid\n\nThe example test output below shows the necessary criteria:\n\n```text\nvalidateStateTransitionIdentitySignatureFactory\n  \u2714 should pass properly signed state transition\n  \u2714 should return invalid result if owner id doesn't exist\n  \u2714 should return MissingPublicKeyError if the identity doesn't have a matching public key\n  \u2714 should return InvalidIdentityPublicKeyTypeError if type is not exist\n  \u2714 should return InvalidStateTransitionSignatureError if signature is invalid\n  Consensus errors\n    \u2714 should return InvalidSignaturePublicKeySecurityLevelConsensusError if InvalidSignaturePublicKeySecurityLevelError was thrown\n    \u2714 should return PublicKeySecurityLevelNotMetConsensusError if PublicKeySecurityLevelNotMetError was thrown\n    \u2714 should return WrongPublicKeyPurposeConsensusError if WrongPublicKeyPurposeError was thrown\n    \u2714 should return PublicKeyIsDisabledConsensusError if PublicKeyIsDisabledError was thrown\n    \u2714 should return InvalidStateTransitionSignatureError if DPPError was thrown\n    \u2714 should throw unknown error\n    \u2714 should not verify signature on dry run\n```",
 "order": 3,
 "isReference": false,
 "hidden": false,
 "sync_unique": "",
 "link_url": "",
 "link_external": false,
 "pendingAlgoliaPublish": false,
 "previousSlug": "reference-state-transition",
 "slugUpdatedAt": "2020-11-17T18:27:29.245Z",
 "createdAt": "2020-09-02T14:22:06.081Z",
 "updatedAt": "2023-08-15T20:37:23.212Z",
 "user": "5b8400d7185d5e00036dcc3b",
 "category": "64f8a9df750465004742ad73",
 "project": "5bda01cad172e200499a20a9",
 "version": "64f8a9df750465004742ae1d",
 "__v": 0,
 "parentDoc": null,
 "deprecated": false,
 "icon": "",
 "revision": 3,
 "isApi": false,
 "id": "64f8a9df750465004742adbc",
 "body_html": "<h1 class=\"heading heading-1 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"state-transition-overview\"></div><div class=\"heading-text\"><div id=\"section-state-transition-overview\" class=\"heading-anchor_backwardsCompatibility\"></div>State Transition Overview</div><a aria-label=\"Skip link to State Transition Overview\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#state-transition-overview\"></a></h1>\n<p> State transitions are the means for submitting data that creates, updates, or deletes platform data and results in a change to a new state. Each one must contain:</p>\n<ul>\n<li><a href=\"#common-fields\" target=\"\" title=\"\">Common fields</a> present in all state transitions</li>\n<li>Additional fields specific to the type of action the state transition provides (e.g. <a href=\"platform-protocol-reference-identity#identity-creation\" target=\"\" title=\"\">creating an identity</a>)</li>\n</ul>\n<h2 class=\"heading heading-2 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"fees\"></div><div class=\"heading-text\"><div id=\"section-fees\" class=\"heading-anchor_backwardsCompatibility\"></div>Fees</div><a aria-label=\"Skip link to Fees\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#fees\"></a></h2>\n<p>State transition fees are paid via the credits established when an identity is created. Credits are created at a rate of <a href=\"https://github.com/dashpay/platform/blob/v0.24.5/packages/rs-dpp/src/identity/credits_converter.rs#L3\" target=\"\" title=\"\">1000 credits/satoshi</a>. Fees for actions vary based on parameters related to storage and computational effort that are defined in <a href=\"https://github.com/dashpay/platform/blob/v0.24.5/packages/rs-dpp/src/state_transition/fee/constants.rs\" target=\"\" title=\"\">rs-dpp</a>.</p>\n<h2 class=\"heading heading-2 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"size\"></div><div class=\"heading-text\"><div id=\"section-size\" class=\"heading-anchor_backwardsCompatibility\"></div>Size</div><a aria-label=\"Skip link to Size\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#size\"></a></h2>\n<p>All serialized data (including state transitions) is limited to a maximum size of <a href=\"https://github.com/dashpay/platform/blob/v0.24.5/packages/rs-dpp/src/util/serializer.rs#L8\" target=\"\" title=\"\">16 KB</a>.</p>\n<h2 class=\"heading heading-2 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"common-fields\"></div><div class=\"heading-text\"><div id=\"section-common-fields\" class=\"heading-anchor_backwardsCompatibility\"></div>Common Fields</div><a aria-label=\"Skip link to Common Fields\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#common-fields\"></a></h2>\n<p>All state transitions include the following fields:</p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<div class=\"rdmd-table\"><div class=\"rdmd-table-inner\"><table><thead><tr><th>Field</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>protocolVersion</td><td>integer</td><td>The platform protocol version (currently <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">1</code>)</td></tr><tr><td>type</td><td>integer</td><td>State transition type:<br/><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">0</code> - <a href=\"platform-protocol-reference-data-contract#data-contract-creation\" target=\"\" title=\"\">data contract create</a><br/><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">1</code> - <a href=\"platform-protocol-reference-document#document-submission\" target=\"\" title=\"\">documents batch</a><br/><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">2</code> - <a href=\"platform-protocol-reference-identity#identity-creation\" target=\"\" title=\"\">identity create</a><br/><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">3</code> - <a href=\"identity.md#identity-topup\" target=\"\" title=\"\">identity topup</a><br/><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">4</code> - <a href=\"data-contract.md#data-contract-update\" target=\"\" title=\"\">data contract update</a><br/><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">5</code> - <a href=\"identity.md#identity-update\" target=\"\" title=\"\">identity update</a></td></tr><tr><td>signature</td><td>array of bytes</td><td>Signature of state transition data (65 bytes)</td></tr></tbody></table></div></div>\n<p>Additionally, all state transitions except the identity create and topup state transitions include:</p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<div class=\"rdmd-table\"><div class=\"rdmd-table-inner\"><table><thead><tr><th>Field</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>signaturePublicKeyId</td><td>integer</td><td>The <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">id</code> of the <a href=\"platform-protocol-reference-identity#identity-publickeys\" target=\"\" title=\"\">identity public key</a> that signed the state transition (<button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">=&gt; 0</code>)</td></tr></tbody></table></div></div>\n<h1 class=\"heading heading-1 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"state-transition-types\"></div><div class=\"heading-text\"><div id=\"section-state-transition-types\" class=\"heading-anchor_backwardsCompatibility\"></div>State Transition Types</div><a aria-label=\"Skip link to State Transition Types\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#state-transition-types\"></a></h1>\n<h2 class=\"heading heading-2 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"data-contract-create\"></div><div class=\"heading-text\"><div id=\"section-data-contract-create\" class=\"heading-anchor_backwardsCompatibility\"></div>Data Contract Create</div><a aria-label=\"Skip link to Data Contract Create\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#data-contract-create\"></a></h2>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<div class=\"rdmd-table\"><div class=\"rdmd-table-inner\"><table><thead><tr><th>Field</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>dataContract</td><td><a href=\"platform-protocol-reference-data-contract#data-contract-object\" target=\"\" title=\"\">data contract object</a></td><td>Object containing valid <a href=\"platform-protocol-reference-data-contract\" target=\"\" title=\"\">data contract</a> details</td></tr><tr><td>entropy</td><td>array of bytes</td><td>Entropy used to generate the data contract ID (32 bytes)</td></tr></tbody></table></div></div>\n<p>More detailed information about the <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">dataContract</code> object can be found in the <a href=\"platform-protocol-reference-data-contract\" target=\"\" title=\"\">data contract section</a>.</p>\n<h3 class=\"heading heading-3 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"entropy-generation\"></div><div class=\"heading-text\"><div id=\"section-entropy-generation\" class=\"heading-anchor_backwardsCompatibility\"></div>Entropy Generation</div><a aria-label=\"Skip link to Entropy Generation\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#entropy-generation\"></a></h3>\n<p>Entropy is included in <a href=\"platform-protocol-reference-data-contract#data-contract-creation\" target=\"\" title=\"\">Data Contracts</a> and <a href=\"platform-protocol-reference-document#document-create-transition\" target=\"\" title=\"\">Documents</a>.</p>\n<div class=\"CodeTabs CodeTabs_initial theme-light\"><div class=\"CodeTabs-toolbar\" role=\"tablist\"><button aria-selected=\"true\" class=\"CodeTabs_active\" role=\"tab\" type=\"button\">Rust</button></div><div class=\"CodeTabs-inner\" role=\"tabpanel\"><pre><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang-rust theme-light\" data-lang=\"rust\" name=\"\" tabindex=\"0\">// From the Rust reference implementation (rs-dpp)\n// entropyGenerator.js\nfn generate(&amp;self) -&gt; anyhow::Result&lt;[u8; 32]&gt; {\n  let mut buffer = [0u8; 32];\n  getrandom(&amp;mut buffer).context(&quot;generating entropy failed&quot;)?;\n  Ok(buffer)\n}\n</code></pre></div></div>\n<h2 class=\"heading heading-2 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"data-contract-update\"></div><div class=\"heading-text\"><div id=\"section-data-contract-update\" class=\"heading-anchor_backwardsCompatibility\"></div>Data Contract Update</div><a aria-label=\"Skip link to Data Contract Update\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#data-contract-update\"></a></h2>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<div class=\"rdmd-table\"><div class=\"rdmd-table-inner\"><table><thead><tr><th>Field</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>dataContract</td><td><a href=\"platform-protocol-reference-data-contract#data-contract-object\" target=\"\" title=\"\">data contract object</a></td><td>Object containing valid <a href=\"platform-protocol-reference-data-contract\" target=\"\" title=\"\">data contract</a> details</td></tr></tbody></table></div></div>\n<p>More detailed information about the <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">dataContract</code> object can be found in the <a href=\"platform-protocol-reference-data-contract\" target=\"\" title=\"\">data contract section</a>.</p>\n<h2 class=\"heading heading-2 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"documents-batch\"></div><div class=\"heading-text\"><div id=\"section-documents-batch\" class=\"heading-anchor_backwardsCompatibility\"></div>Documents Batch</div><a aria-label=\"Skip link to Documents Batch\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#documents-batch\"></a></h2>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<div class=\"rdmd-table\"><div class=\"rdmd-table-inner\"><table><thead><tr><th>Field</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>ownerId</td><td>array of bytes</td><td><a href=\"platform-protocol-reference-identity\" target=\"\" title=\"\">Identity</a> submitting the document(s) (32 bytes)</td></tr><tr><td>transitions</td><td>array of transition objects</td><td>Document <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">create</code>, <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">replace</code>, or <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">delete</code> transitions (up to 10 objects)</td></tr></tbody></table></div></div>\n<p>More detailed information about the <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">transitions</code> array can be found in the <a href=\"platform-protocol-reference-document\" target=\"\" title=\"\">document section</a>.</p>\n<h2 class=\"heading heading-2 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"identity-create\"></div><div class=\"heading-text\"><div id=\"section-identity-create\" class=\"heading-anchor_backwardsCompatibility\"></div>Identity Create</div><a aria-label=\"Skip link to Identity Create\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#identity-create\"></a></h2>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<div class=\"rdmd-table\"><div class=\"rdmd-table-inner\"><table><thead><tr><th>Field</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>assetLockProof</td><td>array of bytes</td><td>Lock <a href=\"https://docs.dash.org/projects/core/en/stable/docs/resources/glossary.html#outpoint\" target=\"\" title=\"\">outpoint</a> from the layer 1 locking transaction (36 bytes)</td></tr><tr><td>publicKeys</td><td>array of keys</td><td><a href=\"platform-protocol-reference-identity#identity-publickeys\" target=\"\" title=\"\">Public key(s)</a> associated with the identity (maximum number of keys: <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">10</code>)</td></tr></tbody></table></div></div>\n<p>More detailed information about the <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">publicKeys</code> object can be found in the <a href=\"platform-protocol-reference-identity\" target=\"\" title=\"\">identity section</a>.</p>\n<h2 class=\"heading heading-2 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"identity-topup\"></div><div class=\"heading-text\"><div id=\"section-identity-top-up\" class=\"heading-anchor_backwardsCompatibility\"></div>Identity TopUp</div><a aria-label=\"Skip link to Identity TopUp\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#identity-topup\"></a></h2>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<div class=\"rdmd-table\"><div class=\"rdmd-table-inner\"><table><thead><tr><th>Field</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>assetLockProof</td><td>array of bytes</td><td>Lock <a href=\"https://docs.dash.org/projects/core/en/stable/docs/resources/glossary.html#outpoint\" target=\"\" title=\"\">outpoint</a> from the layer 1 locking transaction (36 bytes)</td></tr><tr><td>identityId</td><td>array of bytes</td><td>An <a href=\"platform-protocol-reference-identity#identity-id\" target=\"\" title=\"\">Identity ID</a> for the identity receiving the topup (can be any identity) (32 bytes)</td></tr></tbody></table></div></div>\n<h2 class=\"heading heading-2 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"identity-update\"></div><div class=\"heading-text\"><div id=\"section-identity-update\" class=\"heading-anchor_backwardsCompatibility\"></div>Identity Update</div><a aria-label=\"Skip link to Identity Update\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#identity-update\"></a></h2>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<div class=\"rdmd-table\"><div class=\"rdmd-table-inner\"><table><thead><tr><th>Field</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>identityId</td><td>array of bytes</td><td>The <a href=\"platform-protocol-reference-identity#identity-id\" target=\"\" title=\"\">Identity ID</a> for the identity being updated (32 bytes)</td></tr><tr><td>revision</td><td>integer</td><td>Identity update revision. Used for optimistic concurrency control. Incremented by one with each new update so that the update will fail if the underlying data is modified between reading and writing.</td></tr><tr><td>addPublicKeys</td><td>array of public keys</td><td>(Optional) Array of up to 10 new public keys to add to the identity. Required if adding keys.</td></tr><tr><td>disablePublicKeys</td><td>array of integers</td><td>(Optional) Array of up to 10 existing identity public key ID(s) to disable for the identity. Required if disabling keys.</td></tr><tr><td>publicKeysDisabledAt</td><td>integer</td><td>(Optional) Timestamp when keys were disabled. Required if <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">disablePublicKeys</code> is present.</td></tr></tbody></table></div></div>\n<h1 class=\"heading heading-1 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"state-transition-signing\"></div><div class=\"heading-text\"><div id=\"section-state-transition-signing\" class=\"heading-anchor_backwardsCompatibility\"></div>State Transition Signing</div><a aria-label=\"Skip link to State Transition Signing\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#state-transition-signing\"></a></h1>\n<p>State transitions must be signed by a private key associated with the identity creating the state transition. Since v0.23, each identity must have at least two keys: a primary key (security level <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">0</code>) that is only used when signing identity update state transitions and an additional key (security level <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">2</code>) that is used to sign all other state transitions.</p>\n<p>The process to sign a state transition consists of the following steps:</p>\n<ol>\n<li>Canonical CBOR encode the state transition data - this include all ST fields except the <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">signature</code> and <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">signaturePublicKeyId</code></li>\n<li>Sign the encoded data with a private key associated with the identity creating the state transition</li>\n<li>Set the state transition <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">signature</code> to the value of the signature created in the previous step</li>\n<li>For all state transitions <em>other than identity create or topup</em>, set the state transition<button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">signaturePublicKeyId</code> to the <a href=\"platform-protocol-reference-identity#public-key-id\" target=\"\" title=\"\">public key <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">id</code></a> corresponding to the key used to sign</li>\n</ol>\n<h2 class=\"heading heading-2 header-scroll\" align=\"\"><div class=\"heading-anchor anchor waypoint\" id=\"signature-validation\"></div><div class=\"heading-text\"><div id=\"section-signature-validation\" class=\"heading-anchor_backwardsCompatibility\"></div>Signature Validation</div><a aria-label=\"Skip link to Signature Validation\" class=\"heading-anchor-icon fa fa-anchor\" href=\"#signature-validation\"></a></h2>\n<p>The <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">signature</code> validation (see <a href=\"https://github.com/dashpay/platform/blob/v0.24.5/packages/js-dpp/test/unit/stateTransition/validation/validateStateTransitionIdentitySignatureFactory.spec.js\" target=\"\" title=\"\">js-dpp</a>) verifies that:</p>\n<ol>\n<li>The identity exists</li>\n<li>The identity has a public key</li>\n<li>The identity&#x27;s public key is of type <button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang- theme-light\" data-lang=\"\" name=\"\" tabindex=\"0\">ECDSA</code></li>\n<li>The state transition signature is valid</li>\n</ol>\n<p>The example test output below shows the necessary criteria:</p>\n<div class=\"CodeTabs CodeTabs_initial theme-light\"><div class=\"CodeTabs-toolbar\" role=\"tablist\"><button aria-selected=\"true\" class=\"CodeTabs_active\" role=\"tab\" type=\"button\">Text</button></div><div class=\"CodeTabs-inner\" role=\"tabpanel\"><pre><button aria-label=\"Copy Code\" class=\"rdmd-code-copy fa\"></button><code class=\"rdmd-code lang-text theme-light\" data-lang=\"text\" name=\"\" tabindex=\"0\">validateStateTransitionIdentitySignatureFactory\n  \u2714 should pass properly signed state transition\n  \u2714 should return invalid result if owner id doesn&#x27;t exist\n  \u2714 should return MissingPublicKeyError if the identity doesn&#x27;t have a matching public key\n  \u2714 should return InvalidIdentityPublicKeyTypeError if type is not exist\n  \u2714 should return InvalidStateTransitionSignatureError if signature is invalid\n  Consensus errors\n    \u2714 should return InvalidSignaturePublicKeySecurityLevelConsensusError if InvalidSignaturePublicKeySecurityLevelError was thrown\n    \u2714 should return PublicKeySecurityLevelNotMetConsensusError if PublicKeySecurityLevelNotMetError was thrown\n    \u2714 should return WrongPublicKeyPurposeConsensusError if WrongPublicKeyPurposeError was thrown\n    \u2714 should return PublicKeyIsDisabledConsensusError if PublicKeyIsDisabledError was thrown\n    \u2714 should return InvalidStateTransitionSignatureError if DPPError was thrown\n    \u2714 should throw unknown error\n    \u2714 should not verify signature on dry run\n</code></pre></div></div>"
}